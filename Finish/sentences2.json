{
    "data": [
        {
            "time": "2019-06-18",
            "from_website": "fortinet",
            "title": "Analysis of a New HawkEye Variant",
            "from_url": "https://www.fortinet.com/blog/threat-research/hawkeye-malware-analysis",
            "content": [
                "一种新的Hawkeye变体分析 ",
                "一种新的Hawkeye变体分析 ",
                "Fortiguard Labs最近捕获了一个由网络钓鱼电子邮件传播的恶意软件。 ",
                "在快速分析之后，我发现它是Hawkeye恶意软件的新变种。 ",
                "Hawkeye被称为键盘记录器和窃取恶意软件的应用程序凭据。 ",
                "在过去几年中，我们已经看到它通过电子邮件传播，并携带在MS Word文档，Excel文件，PowerPoint文件和RTF文件中。 ",
                "在此分析中，我将概述这一新变种可以对受害者的系统做些什么。 ",
                "以下是电子邮件内容，伪装为机票确认，询问目标受害者点击链接。 ",
                "它被设计成使受害者从图1所示的链路下载7z文件，其中包含Hawkeye的这个新变种，并在受害者的系统上运行它。 ",
                "不幸的是，在初步分析上，URL不可用，我收到了浏览器中的“404未找到”消息。 ",
                "它原来是一个FTP服务，包含有关此广告系列的多个相关网络文件夹，最多包含相同的恶意软件示例（图2）。 ",
                "下载的7z文件被解压缩后，我们检索了exe文件“票％208399283992air8389494verved37783pdf.exe”，这是Hawkeye的新变种。 ",
                "一旦Hawkeye开始，它就会从Microsoft .NET Framework安装目录中生成暂停的子流程“Regasm.exe” ",
                "这是一个装配登记的工具。 ",
                "同时，Hawkeye将PE文件提取到其内存中，然后将PE文件移动到“Regasm.exe”中。 ",
                "动态提取的PE文件是Hawkeye的主程序。 ",
                "它被称为“hawkeye_regasm”，以区分这些文件在分析中。 ",
                "Hawkeye_regasm在暂停后恢复“Regasm.exe”后开始运行。 ",
                "hawkeye_regasm是一个.NET写入程序，它由confuserex v1.0.0包装以保护自己。 ",
                "这为分析师撰写了一个大挑战，以阅读其代码并分析它。 ",
                "代码实际上完全被混淆，如图3所示。 ",
                "睡觉后10秒钟后，Hawkeye_Regasm开始在受害者的系统上工作。 ",
                "到目前为止，通过分析，它似乎主要执行以下功能： ",
                "3>另外两个子进程来自.NET Framework目录的两个子流程“vbc.exe”。 ",
                "4>将收集的数据从时间发送到电子邮件地址（每10分钟）。 ",
                "Hawkeye_Regasm启动一个线程来执行上述任务，然后每10分钟将其收集的信息发送到其Yandex电子邮件地址。 ",
                "Hawkeye_Regasm使用Windows-Native API设置剪贴板和键盘记录器（例如SetWindowsHokex，SetClipboardViewer等） ",
                "当键盘上的受害者类型以及将数据复制到系统剪贴板时，其本地功能可以记录受害者的行为。 ",
                "图4显示了从其键盘和剪贴板记录器收集的HawKeye_regasm以及从事件发生时的软件标题的信息的示例。 ",
                "收集的剪贴板和键盘数据示例 ",
                "从已保存的凭据存储收集凭据 ",
                "Hawkeye_regasm对Regasm.exe执行类似的任务。 ",
                "它会产生两个暂停的子进程，“vbc.exe”，它与Regasm.exe相同的目录。 ",
                "Hawkeye将两个PE文件动态提取到其内存中，然后将其复制到“VBC.exe”的两个新创建的子进程中。 ",
                "它还修改其ThreadContext数据（它调用API，SetThreadContext），并将其入口点转到传输的PE文件。 ",
                "当“vbc.exe”恢复运行时，可以执行它。 ",
                "恶意软件经常执行伪装自身后面的诀窍是正常过程。 ",
                "两个“vbc.exe”流程从受害者的系统中收集凭据。 ",
                "一个用于收集浏览器的凭据。 ",
                "另一个侧重于电子邮件客户端和IM客户来窃取凭据和配置文件。 ",
                "将两个PE文件注入“vbc.exe”具有相同的代码框架。 ",
                "他们首先调用一个函数来收集凭据并将它们保存在内存中，而第二个，它读取收集的数据，格式化它，并将其从其命令行参数保存到TMP文件中。 ",
                "图5显示了HawKeye调用CreateProcess API以启动两个“VBC.exe”进程之一，其中参数在“当地人”子选项卡中显示。 ",
                "您可以看到“vbc.exe”的完整路径。 ",
                "“/ stext”“c：\\ users \\ ********* \\ appdata \\ local \\ temp \\ tmpbe3d.tmp”“”是传递给它的参数。 ",
                "TMP文件名是随机的，与两个“VBC.EXE”进程不同，临时保存收集的凭据。 ",
                "调用CreateProcess启动“vbc.exe”时打破 ",
                "两个PE文件不是Packer受保护而不是.NET书面程序。 ",
                "第一个“vbs.exe”从受害者的浏览器和系统凭证管理器中收集凭据，以实现IE。 ",
                "在我的分析中，Hawkeye的这种变体侧重于以下浏览器： ",
                "Microsoft Internet Explorer，Google Chrome，Apple Safari，Opera，Mozilla Sunbird，Mozilla Firefox，Mozilla便携式Thunderbird，Mozilla Seamonkey，Yandexbrowser，Vivaldi浏览器等等。 ",
                "图6显示了在浏览器的ASM代码中定义的一些字符串，即HawKeye Malware想要从中收集凭据。 ",
                "然后将收集的凭据从其命令行参数保存到TMP文件中。 ",
                "hawkeye_regasm继续检查此TMP文件，一旦收集凭据，就完成了。 ",
                "Hawkeye_regasm然后将此TMP文件的整个数据读入其内存，立即删除。 ",
                "浏览器在第一个PE文件中定义的信息 ",
                "“vbc.exe”中的第二个PE文件收集在受害者机器上安装的电子邮件和IM软件客户端的配置文件和凭据信息。 ",
                "高通公司eudora，Mozilla Thunderbird，MS Office Outlook，Incredimail，Groupmail，Msnmessenger，雅虎！寻呼机/雅虎！Messenger和Windows邮件。 ",
                "下面是一个示例列表，Hawkeye从我的测试机器上的Chrome浏览器窃取。 ",
                "正如您所看到的，它包括登录URL，浏览器名称，用户名，密码，创建的时间以及所收集信息来自的文件的完整路径。 ",
                "“vbc.exe”将收集的服务器地址信息保存为TMP文件 ",
                "“vbc.exe”中的第二个PE文件不仅收集客户端的登录用户名和密码，还包括配置文件信息，例如验尸服务器地址，收件人服务器端口，协议类型（POP3），SMTP服务器，SMTP端口等。 ",
                "图7显示了当“VBC.EXE”将收集的收件人服务器地址写入其TMP文件时oLlyDBG的屏幕截图。 ",
                "HawKeye_Regasm最终读取相同的TMP文件，然后删除。 ",
                "在我的测试机器上，我只使用一个帐户安装了MS Outlook。 ",
                "收集我的测试帐户和服务器配置文件并放入下面显示的结构中，通常将发送到攻击者的电子邮件框。 ",
                "通过SMTP将收集的数据发送到攻击者 ",
                "好的。 现在让我们回到Hawkeye_Regasm的主要过程，它控制Hawkeye的所有任务，并发送受害者的凭据。 ",
                "在其主程序中，它将Thread.sleep（600000）调用，并在每10分钟收集凭据的同时暂停。 ",
                "也就是说，它将收集的数据报告每10分钟一次攻击者。 ",
                "它首先发送HTTP请求，http://bot.whatismyipaddress.com，要求我的计算机公共IP。 ",
                "这是一种确保受害者的机器能够访问互联网的方法。 ",
                "如果它没有与公共IP回复，则它停止将收集的数据发送到电子邮件框。 ",
                "此外，IP出现在电子邮件主题中，以便识别受害者。 ",
                "攻击者的电子邮件在Yandex.mail中，当通过Yandex SMTP服务器发送收集的数据时，使用其电子邮件帐户和密码。 ",
                "这就是为什么我能够在跟踪主程序的同时获得攻击者的电子邮件凭据。 ",
                "当我调试它时，您可以看到图8中的屏幕截图。 ",
                "将收集的数据发送到攻击者的电子邮件框 ",
                "每十分钟发送数据包，如图9所示，告诉攻击者使用键盘记录器，剪贴板，浏览器凭据和IM以及电子邮件客户端凭据和配置文件从受害者机器中收集的攻击者。 ",
                "将收集的数据发送到攻击者的yandex电子邮件地址通过smtp ",
                "访问攻击者的帐户，我们可以看到攻击者已收获的内容，如图10所示。 ",
                "电子邮件中的原始URL已被FortiGuard Web过滤服务评为“恶意网站”。 ",
                "由FortiGuard AntiVirus服务检测到解压缩的exe文件被检测为“autoit / injector.eah！tr”。 ",
                "了解有关Fortiguard Labs和Fortiguard Security Services产品组合的更多信息。 ",
                "注册我们的每周Fortiguard威胁简介。 ",
                "阅读有关Fortiguard安全评级服务，提供安全审核和最佳实践。 ",
                "掠夺者小偷：新的交货途径 ",
                "欺诈圈子：新的攻击波浪 ",
                "监视麦斯科斯芯片，第一部分：通过MACF监视流程执行 ",
                "版权所有©2022 Fortinet，Inc。保留所有权利 "
            ],
            "sentencesNum": 90,
            "words": [
                "Blog",
                "Categories",
                "Business & Technology",
                "Threat Research",
                "Industry Trends",
                "Partners",
                "Customer Stories",
                "PSIRT Blogs",
                "Business & Technology",
                "Threat Research",
                "Industry Trends",
                "Partners",
                "Customer Stories",
                "PSIRT Blogs",
                "CISO Collective",
                "Threat Research",
                "By",
                "Xiaopeng Zhang",
                "| June 18, 2019",
                "Threat Analysis by FortiGuard Labs",
                "Background",
                "Distribution and Download",
                "Figure 1.",
                "The email content",
                "Browsing to its main page.",
                "Figure 2.",
                "Screenshot of the main page",
                "Start HawkEye",
                "Figure 3.",
                "Obfuscated Entry function of HawkEye_RegAsm",
                "1> Set up clipboard logger",
                "2> Set up keyboard logger",
                "Figure 4.",
                "Figure 5.",
                "Figure 6.",
                "The clients it targets are:",
                "Figure 7.",
                "It writes one line once.",
                "Figure 8.",
                "Figure 9.",
                "Figure 10.",
                "Glancing at an attacker’s harvest",
                "Solutions",
                "Sample SHA256",
                "[TICKET%2083992883992AIR8389494VERVED37783PDF.exe]",
                "3E7AD2A554F89B2A5E52E5C4843111342182DA4409A038CF800570B65A13F875",
                "[Ticketmasterconfirmation3883948383948394.7z]",
                "BBB46F812126FAEB543B02D143EF450887A043185AF98210D8F827924B31CF7A",
                "[TKT8839483993993fligh booking ticket confirmationupdate.7z]",
                "F2B921726D728037F9BA0C63FB6C31F77983C3A6E3938B46C411E80C218A2E84",
                "Tags:",
                "threat research,",
                "phishing,",
                "FortiGuard Labs,",
                "malware",
                "Related Posts",
                "Threat Research",
                "Threat Research",
                "Threat Research",
                "News & Articles",
                "News Releases",
                "News Articles",
                "Trademarks",
                "Security Research",
                "Threat Research",
                "FortiGuard Labs",
                "Threat Map",
                "Threat Briefs",
                "Ransomware",
                "Connect With Us",
                "Blog",
                "Fuse Community",
                "Company",
                "About Us",
                "Why Fortinet",
                "Security Fabric",
                "Exec Mgmt",
                "Careers",
                "Certifications",
                "Events",
                "Industry Awards",
                "Contact Us",
                "(866) 868-3678",
                "Terms of Services",
                "Privacy Policy",
                "| Cookie Settings"
            ],
            "wordsNum": 86,
            "labels": [
                "bad",
                "bad",
                "bad",
                "bad",
                "good",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad"
            ]
        }
    ],
    "info": {
        "sentencesNum": 90,
        "wordsNum": 86,
        "reportsNum": 1
    }
}